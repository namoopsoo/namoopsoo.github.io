<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>michal.piekarczyk.xyz</title><meta name=keywords content><meta name=description content="One particularly killer feature about the ColumnTransformer is that you can apply a specific preprocessor for a subset of the columns, and then set remainder=&#34;passthrough&#34; for the others import numpy as np from sklearn.preprocessing import (MinMaxScaler, OneHotEncoder, LabelEncoder) from sklearn.preprocessing import Binarizer from sklearn.compose import ColumnTransformer from sklearn.pipeline import Pipeline from sklearn import metrics from sklearn.ensemble import RandomForestClassifier from sklearn.datasets import make_classification from sklearn.model_selection import cross_val_score, train_test_split def make_data(): X, y = make_classification(n_samples=1000, n_features=4, n_informative=2, n_redundant=0, random_state=42, shuffle=False, weights=(0."><meta name=author content="Michal Piekarczyk"><link rel=canonical href=https://michal.piekarczyk.xyz/handy/model/pipeline/><link crossorigin=anonymous href=/assets/css/stylesheet.6a98292fb8fa8cf0f3ba4042d4b75515c04267550f3ad49ff6271b5af9562443.css integrity="sha256-apgpL7j6jPDzukBC1LdVFcBCZ1UPOtSf9icbWvlWJEM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://michal.piekarczyk.xyz/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://michal.piekarczyk.xyz/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://michal.piekarczyk.xyz/favicon-32x32.png><link rel=apple-touch-icon href=https://michal.piekarczyk.xyz/apple-touch-icon.png><link rel=mask-icon href=https://michal.piekarczyk.xyz/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-86TSXEXWB5"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-86TSXEXWB5",{anonymize_ip:!1})}</script><meta property="og:title" content><meta property="og:description" content="One particularly killer feature about the ColumnTransformer is that you can apply a specific preprocessor for a subset of the columns, and then set remainder=&#34;passthrough&#34; for the others import numpy as np from sklearn.preprocessing import (MinMaxScaler, OneHotEncoder, LabelEncoder) from sklearn.preprocessing import Binarizer from sklearn.compose import ColumnTransformer from sklearn.pipeline import Pipeline from sklearn import metrics from sklearn.ensemble import RandomForestClassifier from sklearn.datasets import make_classification from sklearn.model_selection import cross_val_score, train_test_split def make_data(): X, y = make_classification(n_samples=1000, n_features=4, n_informative=2, n_redundant=0, random_state=42, shuffle=False, weights=(0."><meta property="og:type" content="article"><meta property="og:url" content="https://michal.piekarczyk.xyz/handy/model/pipeline/"><meta property="article:section" content="handy"><meta property="og:site_name" content="michal.piekarczyk.xyz"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="One particularly killer feature about the ColumnTransformer is that you can apply a specific preprocessor for a subset of the columns, and then set remainder=&#34;passthrough&#34; for the others import numpy as np from sklearn.preprocessing import (MinMaxScaler, OneHotEncoder, LabelEncoder) from sklearn.preprocessing import Binarizer from sklearn.compose import ColumnTransformer from sklearn.pipeline import Pipeline from sklearn import metrics from sklearn.ensemble import RandomForestClassifier from sklearn.datasets import make_classification from sklearn.model_selection import cross_val_score, train_test_split def make_data(): X, y = make_classification(n_samples=1000, n_features=4, n_informative=2, n_redundant=0, random_state=42, shuffle=False, weights=(0."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Handies","item":"https://michal.piekarczyk.xyz/handy/"},{"@type":"ListItem","position":2,"name":"","item":"https://michal.piekarczyk.xyz/handy/model/pipeline/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"","name":"","description":"One particularly killer feature about the ColumnTransformer is that you can apply a specific preprocessor for a subset of the columns, and then set remainder=\u0026quot;passthrough\u0026quot; for the others import numpy as np from sklearn.preprocessing import (MinMaxScaler, OneHotEncoder, LabelEncoder) from sklearn.preprocessing import Binarizer from sklearn.compose import ColumnTransformer from sklearn.pipeline import Pipeline from sklearn import metrics from sklearn.ensemble import RandomForestClassifier from sklearn.datasets import make_classification from sklearn.model_selection import cross_val_score, train_test_split def make_data(): X, y = make_classification(n_samples=1000, n_features=4, n_informative=2, n_redundant=0, random_state=42, shuffle=False, weights=(0.","keywords":[],"articleBody":" One particularly killer feature about the ColumnTransformer is that you can apply a specific preprocessor for a subset of the columns, and then set remainder=\"passthrough\" for the others import numpy as np from sklearn.preprocessing import (MinMaxScaler, OneHotEncoder, LabelEncoder) from sklearn.preprocessing import Binarizer from sklearn.compose import ColumnTransformer from sklearn.pipeline import Pipeline from sklearn import metrics from sklearn.ensemble import RandomForestClassifier from sklearn.datasets import make_classification from sklearn.model_selection import cross_val_score, train_test_split def make_data(): X, y = make_classification(n_samples=1000, n_features=4, n_informative=2, n_redundant=0, random_state=42, shuffle=False, weights=(0.25,), ) # return X, y X_train, X_test, y_train, y_test = train_test_split( X, y, test_size=0.33, random_state=42, ) return X_train, X_test, y_train, y_test # In [90]: Counter(y) # Out[90]: Counter({0: 258, 1: 742}) def forest_one(): preprocessor = ColumnTransformer([ (\"scaler\", MinMaxScaler(), [0, 1]), ], remainder=\"passthrough\") pipeline = Pipeline([ # (\"scale\", MinMaxScaler()), (\"preproc\", preprocessor), ( \"clf\", RandomForestClassifier( max_depth=2, random_state=0, n_estimators=100, # class_weight=\"balanced_subsample\", # \"balanced\", \"balanced_subsample\" or {0: 0.1, 1: 0.9 } weights per class ) ), ]) return pipeline def forest_balanced(): pipeline = Pipeline([ (\"scale\", MinMaxScaler() ), ( \"clf\", RandomForestClassifier( max_depth=2, random_state=0, n_estimators=100, class_weight=\"balanced_subsample\", # \"balanced\", \"balanced_subsample\" or {0: 0.1, 1: 0.9 } weights per class ) ), ]) return pipeline def e2e(X_train, y_train, pipeline): scorers = [\"f1_micro\", \"roc_auc\"] scores = [ [scorer, cross_val_score(pipeline, X_train, y_train, cv=3, scoring=scorer) ] for scorer in scorers ] pipeline.fit(X_train, y_train) return pipeline, scores def holdout_test(X_test, y_test, pipeline): y_preds = pipeline.predict(X_test) f1 = metrics.f1_score(y_test, y_preds, average=\"micro\") y_preds = pipeline.predict_proba(X_test)[:, 1] fpr, tpr, thresholds = metrics.roc_curve(y_test, y_preds, pos_label=1) auc = metrics.auc(fpr, tpr) return {\"f1\": f1, \"auc\": auc} \"\"\" # X = np.array([[-1, 2], [-0.5, 6], [0, 10], [1, 18]]) scaler = MinMaxScaler() print(scaler.fit(X)) print(scaler.data_min_, scaler.data_max_) print(scaler.transform(X)) # X_std = (X - X.min(axis=0)) / (X.max(axis=0) - X.min(axis=0)) \"\"\" \"\"\" X_train, X_test, y_train, y_test = qp.make_data() p1 = qp.forest_one() p2 = qp.forest_balanced() _, scores1 = qp.e2e(X, y, p1) print(\"p1\", scores1) qp.holdout_test(X_test, y_test, p1) _, scores2 = qp.e2e(X, y, p2) print(\"p2\", scores2) qp.holdout_test(X_test, y_test, p2) \"\"\" ","wordCount":"312","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Michal Piekarczyk"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://michal.piekarczyk.xyz/handy/model/pipeline/"},"publisher":{"@type":"Organization","name":"michal.piekarczyk.xyz","logo":{"@type":"ImageObject","url":"https://michal.piekarczyk.xyz/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://michal.piekarczyk.xyz/ accesskey=h title="michal.piekarczyk.xyz (Alt + H)">michal.piekarczyk.xyz</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://michal.piekarczyk.xyz/post/ title=posts><span>posts</span></a></li><li><a href=https://michal.piekarczyk.xyz/project/ title=projects><span>projects</span></a></li><li><a href=https://michal.piekarczyk.xyz/handy/ title=handy><span>handy</span></a></li><li><a href=https://michal.piekarczyk.xyz/tags/ title=tags><span>tags</span></a></li><li><a href=https://michal.piekarczyk.xyz/about/ title=about><span>about</span></a></li><li><a href=https://world.hey.com/michal.piekarczyk title=frivolity><span>frivolity</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://michal.piekarczyk.xyz/>Home</a>&nbsp;»&nbsp;<a href=https://michal.piekarczyk.xyz/handy/>Handies</a></div><h1 class=post-title></h1><div class=post-meta>2 min&nbsp;·&nbsp;312 words&nbsp;·&nbsp;Michal Piekarczyk</div></header><div class=post-content><ul><li>One particularly killer feature about the <code>ColumnTransformer</code> is that you can apply a specific preprocessor for a subset of the columns, and then set <code>remainder="passthrough"</code> for the others</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.preprocessing <span style=color:#f92672>import</span> (MinMaxScaler, OneHotEncoder, LabelEncoder)
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.preprocessing <span style=color:#f92672>import</span> Binarizer
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.compose <span style=color:#f92672>import</span> ColumnTransformer
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.pipeline <span style=color:#f92672>import</span> Pipeline
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn <span style=color:#f92672>import</span> metrics
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.ensemble <span style=color:#f92672>import</span> RandomForestClassifier
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.datasets <span style=color:#f92672>import</span> make_classification
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.model_selection <span style=color:#f92672>import</span> cross_val_score, train_test_split
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>make_data</span>():
</span></span><span style=display:flex><span>    X, y <span style=color:#f92672>=</span> make_classification(n_samples<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span>, n_features<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>                               n_informative<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>, n_redundant<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                               random_state<span style=color:#f92672>=</span><span style=color:#ae81ff>42</span>, shuffle<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>,
</span></span><span style=display:flex><span>                               weights<span style=color:#f92672>=</span>(<span style=color:#ae81ff>0.25</span>,),
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                               )
</span></span><span style=display:flex><span>    <span style=color:#75715e># return X, y</span>
</span></span><span style=display:flex><span>    X_train, X_test, y_train, y_test <span style=color:#f92672>=</span> train_test_split(
</span></span><span style=display:flex><span>        X, y, test_size<span style=color:#f92672>=</span><span style=color:#ae81ff>0.33</span>, random_state<span style=color:#f92672>=</span><span style=color:#ae81ff>42</span>,
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> X_train, X_test, y_train, y_test
</span></span><span style=display:flex><span><span style=color:#75715e># In [90]: Counter(y)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Out[90]: Counter({0: 258, 1: 742})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>forest_one</span>():
</span></span><span style=display:flex><span>    preprocessor <span style=color:#f92672>=</span> ColumnTransformer([
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;scaler&#34;</span>, MinMaxScaler(), [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>]),
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        ],
</span></span><span style=display:flex><span>        remainder<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;passthrough&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    pipeline <span style=color:#f92672>=</span> Pipeline([
</span></span><span style=display:flex><span>        <span style=color:#75715e># (&#34;scale&#34;, MinMaxScaler()),</span>
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;preproc&#34;</span>, preprocessor),
</span></span><span style=display:flex><span>        (
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;clf&#34;</span>,
</span></span><span style=display:flex><span>            RandomForestClassifier(
</span></span><span style=display:flex><span>                max_depth<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>                random_state<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                n_estimators<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span>,
</span></span><span style=display:flex><span>                <span style=color:#75715e># class_weight=&#34;balanced_subsample&#34;, # &#34;balanced&#34;, &#34;balanced_subsample&#34; or {0: 0.1, 1: 0.9 } weights per class </span>
</span></span><span style=display:flex><span>            )
</span></span><span style=display:flex><span>        ),
</span></span><span style=display:flex><span>    ])
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> pipeline
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>forest_balanced</span>():
</span></span><span style=display:flex><span>    pipeline <span style=color:#f92672>=</span> Pipeline([
</span></span><span style=display:flex><span>        (<span style=color:#e6db74>&#34;scale&#34;</span>, MinMaxScaler()
</span></span><span style=display:flex><span>            ),
</span></span><span style=display:flex><span>        (
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;clf&#34;</span>,
</span></span><span style=display:flex><span>            RandomForestClassifier(
</span></span><span style=display:flex><span>                max_depth<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>                random_state<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                n_estimators<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span>,
</span></span><span style=display:flex><span>                class_weight<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;balanced_subsample&#34;</span>, <span style=color:#75715e># &#34;balanced&#34;, &#34;balanced_subsample&#34; or {0: 0.1, 1: 0.9 } weights per class </span>
</span></span><span style=display:flex><span>            )
</span></span><span style=display:flex><span>        ),
</span></span><span style=display:flex><span>    ])
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> pipeline
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>e2e</span>(X_train, y_train, pipeline):
</span></span><span style=display:flex><span>    scorers <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;f1_micro&#34;</span>, <span style=color:#e6db74>&#34;roc_auc&#34;</span>]
</span></span><span style=display:flex><span>    scores <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>            [scorer, 
</span></span><span style=display:flex><span>cross_val_score(pipeline, X_train, y_train, cv<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>            scoring<span style=color:#f92672>=</span>scorer)
</span></span><span style=display:flex><span>                ]
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> scorer <span style=color:#f92672>in</span> scorers
</span></span><span style=display:flex><span>            ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    pipeline<span style=color:#f92672>.</span>fit(X_train, y_train)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> pipeline, scores
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>holdout_test</span>(X_test, y_test, pipeline):
</span></span><span style=display:flex><span>    y_preds <span style=color:#f92672>=</span> pipeline<span style=color:#f92672>.</span>predict(X_test)
</span></span><span style=display:flex><span>    f1 <span style=color:#f92672>=</span> metrics<span style=color:#f92672>.</span>f1_score(y_test, y_preds, average<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;micro&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    y_preds <span style=color:#f92672>=</span> pipeline<span style=color:#f92672>.</span>predict_proba(X_test)[:, <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    fpr, tpr, thresholds <span style=color:#f92672>=</span> metrics<span style=color:#f92672>.</span>roc_curve(y_test, y_preds, pos_label<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    auc <span style=color:#f92672>=</span> metrics<span style=color:#f92672>.</span>auc(fpr, tpr)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {<span style=color:#e6db74>&#34;f1&#34;</span>: f1, <span style=color:#e6db74>&#34;auc&#34;</span>: auc}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74># X = np.array([[-1, 2], [-0.5, 6], [0, 10], [1, 18]])
</span></span></span><span style=display:flex><span><span style=color:#e6db74>scaler = MinMaxScaler()
</span></span></span><span style=display:flex><span><span style=color:#e6db74>print(scaler.fit(X))
</span></span></span><span style=display:flex><span><span style=color:#e6db74>print(scaler.data_min_, scaler.data_max_)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>print(scaler.transform(X))
</span></span></span><span style=display:flex><span><span style=color:#e6db74># X_std = (X - X.min(axis=0)) / (X.max(axis=0) - X.min(axis=0))
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>X_train, X_test, y_train, y_test = qp.make_data()
</span></span></span><span style=display:flex><span><span style=color:#e6db74>p1 = qp.forest_one()
</span></span></span><span style=display:flex><span><span style=color:#e6db74>p2 = qp.forest_balanced()
</span></span></span><span style=display:flex><span><span style=color:#e6db74>_, scores1 = qp.e2e(X, y, p1)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>print(&#34;p1&#34;, scores1)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>qp.holdout_test(X_test, y_test, p1)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>_, scores2 = qp.e2e(X, y, p2)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>print(&#34;p2&#34;, scores2)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>qp.holdout_test(X_test, y_test, p2)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://michal.piekarczyk.xyz/>michal.piekarczyk.xyz</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>