<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>michal.piekarczyk.xyz</title><meta name=keywords content><meta name=description content="concurrent.futures Recently at work I needed to add retry logic to some code that was using the concurrent python library.
I had done some research and I ended up also answering this stack overflow question too in the process.
I am finding concurrent.futures to be pretty nice! Of course joblib is nice too.
Anyway, re-posting my answer below as well.
import concurrent.futures import time import urllib from random import randint from collections import defaultdict URLS = ['http://www."><meta name=author content="Michal Piekarczyk"><link rel=canonical href=https://michal.piekarczyk.xyz/handy/python/concurrent_futures/><link crossorigin=anonymous href=/assets/css/stylesheet.4c73b1b942ee612f2f6a56636bd60cf62223b2cdb42d501875d67bb952acf3c0.css integrity="sha256-THOxuULuYS8valZja9YM9iIjss20LVAYddZ7uVKs88A=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://michal.piekarczyk.xyz/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://michal.piekarczyk.xyz/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://michal.piekarczyk.xyz/favicon-32x32.png><link rel=apple-touch-icon href=https://michal.piekarczyk.xyz/apple-touch-icon.png><link rel=mask-icon href=https://michal.piekarczyk.xyz/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-86TSXEXWB5"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-86TSXEXWB5",{anonymize_ip:!1})}</script><meta property="og:title" content><meta property="og:description" content="concurrent.futures Recently at work I needed to add retry logic to some code that was using the concurrent python library.
I had done some research and I ended up also answering this stack overflow question too in the process.
I am finding concurrent.futures to be pretty nice! Of course joblib is nice too.
Anyway, re-posting my answer below as well.
import concurrent.futures import time import urllib from random import randint from collections import defaultdict URLS = ['http://www."><meta property="og:type" content="article"><meta property="og:url" content="https://michal.piekarczyk.xyz/handy/python/concurrent_futures/"><meta property="article:section" content="handy"><meta property="og:site_name" content="michal.piekarczyk.xyz"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="concurrent.futures Recently at work I needed to add retry logic to some code that was using the concurrent python library.
I had done some research and I ended up also answering this stack overflow question too in the process.
I am finding concurrent.futures to be pretty nice! Of course joblib is nice too.
Anyway, re-posting my answer below as well.
import concurrent.futures import time import urllib from random import randint from collections import defaultdict URLS = ['http://www."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Handies","item":"https://michal.piekarczyk.xyz/handy/"},{"@type":"ListItem","position":2,"name":"","item":"https://michal.piekarczyk.xyz/handy/python/concurrent_futures/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"","name":"","description":"concurrent.futures Recently at work I needed to add retry logic to some code that was using the concurrent python library.\nI had done some research and I ended up also answering this stack overflow question too in the process.\nI am finding concurrent.futures to be pretty nice! Of course joblib is nice too.\nAnyway, re-posting my answer below as well.\nimport concurrent.futures import time import urllib from random import randint from collections import defaultdict URLS = [\u0026#39;http://www.","keywords":[],"articleBody":"concurrent.futures Recently at work I needed to add retry logic to some code that was using the concurrent python library.\nI had done some research and I ended up also answering this stack overflow question too in the process.\nI am finding concurrent.futures to be pretty nice! Of course joblib is nice too.\nAnyway, re-posting my answer below as well.\nimport concurrent.futures import time import urllib from random import randint from collections import defaultdict URLS = ['http://www.foxnews.com/', 'http://www.cnn.com/', 'http://europe.wsj.com/', 'http://www.bbc.co.uk/', 'http://some-made-up-domain.com/'] URLS = [f\"http://fake{i}.com\" for i in range(20)] # Retrieve a single page and report the URL and contents def load_url(url, timeout): if \"fake\" in url: time.sleep(1) x = randint(1, 10) if x \u003c= 5: return {\"timeout\": True, \"error\": \"SimulatedTimeout\", \"url\": url} elif x in [6, 7]: return {\"error\": \"SomeOtherError\", \"url\": url} else: return {\"data\": \"\" + str(randint(1, 999999)) + \"\", \"url\": url} try: with urllib.request.urlopen(url, timeout=timeout) as conn: data = conn.read() return {\"data\": data, \"url\": url} # except urllib.error.URLError as e: except Exception as e: if \"TimeoutError\" in repr(e): return {\"timeout\": True, \"error\": repr(e), \"url\": url} else: return {\"error\": repr(e), \"url\": url} todo = [{\"url\": url} for url in URLS] final_results = [] retry_counts = defaultdict(int) max_retries = 5 with concurrent.futures.ThreadPoolExecutor(max_workers=5) as executor: while True: future_list = [executor.submit(load_url, item[\"url\"], 60) for item in todo] todo = [] for future in concurrent.futures.as_completed(future_list): result = future.result() if result.get(\"data\"): final_results.append({**result, \"retries\": retry_counts[result[\"url\"]]}) elif result.get(\"error\") and not result.get(\"timeout\"): final_results.append({**result, \"retries\": retry_counts[result[\"url\"]]}) elif result.get(\"timeout\") and retry_counts[result[\"url\"]] \u003c max_retries: retry_counts[result[\"url\"]] += 1 todo.append({\"url\": result[\"url\"]}) else: final_results.append({**result, \"reached_max_retries\": True, \"retries\": retry_counts[result[\"url\"]]}) if len(final_results) == len(URLS): print(\"Done!\") break else: print(f\"we are now {len(final_results)} out of {len(URLS)}\") with the output\nwe are now 10 out of 20 we are now 11 out of 20 we are now 16 out of 20 we are now 17 out of 20 we are now 18 out of 20 Done! In [45]: pd.DataFrame.from_records(final_results) Out[45]: error url retries data timeout reached_max_retries 0 SomeOtherError http://fake0.com 0 NaN NaN NaN 1 NaN http://fake2.com 0 \u003chtml\u003e124983\u003c/html\u003e NaN NaN 2 SomeOtherError http://fake3.com 0 NaN NaN NaN 3 NaN http://fake7.com 0 \u003chtml\u003e459880\u003c/html\u003e NaN NaN 4 SomeOtherError http://fake10.com 0 NaN NaN NaN 5 NaN http://fake13.com 0 \u003chtml\u003e598498\u003c/html\u003e NaN NaN 6 NaN http://fake15.com 0 \u003chtml\u003e477976\u003c/html\u003e NaN NaN 7 NaN http://fake16.com 0 \u003chtml\u003e748633\u003c/html\u003e NaN NaN 8 SomeOtherError http://fake17.com 0 NaN NaN NaN 9 NaN http://fake19.com 0 \u003chtml\u003e104853\u003c/html\u003e NaN NaN 10 NaN http://fake9.com 1 \u003chtml\u003e677035\u003c/html\u003e NaN NaN 11 NaN http://fake8.com 2 \u003chtml\u003e249557\u003c/html\u003e NaN NaN 12 NaN http://fake5.com 2 \u003chtml\u003e516063\u003c/html\u003e NaN NaN 13 SomeOtherError http://fake6.com 2 NaN NaN NaN 14 SomeOtherError http://fake11.com 2 NaN NaN NaN 15 NaN http://fake12.com 2 \u003chtml\u003e66441\u003c/html\u003e NaN NaN 16 NaN http://fake1.com 3 \u003chtml\u003e604868\u003c/html\u003e NaN NaN 17 SomeOtherError http://fake18.com 4 NaN NaN NaN 18 SimulatedTimeout http://fake4.com 5 NaN True True 19 SimulatedTimeout http://fake14.com 5 NaN True True ","wordCount":"458","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Michal Piekarczyk"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://michal.piekarczyk.xyz/handy/python/concurrent_futures/"},"publisher":{"@type":"Organization","name":"michal.piekarczyk.xyz","logo":{"@type":"ImageObject","url":"https://michal.piekarczyk.xyz/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://michal.piekarczyk.xyz/ accesskey=h title="michal.piekarczyk.xyz (Alt + H)">michal.piekarczyk.xyz</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://michal.piekarczyk.xyz/post/ title=posts><span>posts</span></a></li><li><a href=https://michal.piekarczyk.xyz/project/ title=projects><span>projects</span></a></li><li><a href=https://michal.piekarczyk.xyz/handy/ title=handy><span>handy</span></a></li><li><a href=https://michal.piekarczyk.xyz/tags/ title=tags><span>tags</span></a></li><li><a href=https://michal.piekarczyk.xyz/about/ title=about><span>about</span></a></li><li><a href=https://world.hey.com/michal.piekarczyk title=frivolity><span>frivolity</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://michal.piekarczyk.xyz/>Home</a>&nbsp;»&nbsp;<a href=https://michal.piekarczyk.xyz/handy/>Handies</a></div><h1 class=post-title></h1><div class=post-meta>3 min&nbsp;·&nbsp;458 words&nbsp;·&nbsp;Michal Piekarczyk</div></header><div class=post-content><h3 id=concurrentfutures>concurrent.futures<a hidden class=anchor aria-hidden=true href=#concurrentfutures>#</a></h3><p>Recently at work I needed to add retry logic to some code that was using the <code>concurrent</code> python library.</p><p>I had done some research and I ended up also answering <a href=https://stackoverflow.com/questions/55455309/how-to-re-execute-function-in-threadpoolexecutor-in-case-of-error/72672692#72672692>this</a> stack overflow question too in the process.</p><p>I am finding <code>concurrent.futures</code> to be pretty nice! Of course <code>joblib</code> is nice too.</p><p>Anyway, re-posting my answer below as well.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> concurrent.futures
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> urllib
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> random <span style=color:#f92672>import</span> randint
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> collections <span style=color:#f92672>import</span> defaultdict
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>URLS <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;http://www.foxnews.com/&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;http://www.cnn.com/&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;http://europe.wsj.com/&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;http://www.bbc.co.uk/&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;http://some-made-up-domain.com/&#39;</span>]
</span></span><span style=display:flex><span>URLS <span style=color:#f92672>=</span> [<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;http://fake</span><span style=color:#e6db74>{</span>i<span style=color:#e6db74>}</span><span style=color:#e6db74>.com&#34;</span> <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>20</span>)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Retrieve a single page and report the URL and contents</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>load_url</span>(url, timeout):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#34;fake&#34;</span> <span style=color:#f92672>in</span> url:
</span></span><span style=display:flex><span>        time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        x <span style=color:#f92672>=</span> randint(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> x <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>5</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> {<span style=color:#e6db74>&#34;timeout&#34;</span>: <span style=color:#66d9ef>True</span>, <span style=color:#e6db74>&#34;error&#34;</span>: <span style=color:#e6db74>&#34;SimulatedTimeout&#34;</span>, <span style=color:#e6db74>&#34;url&#34;</span>: url}
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> x <span style=color:#f92672>in</span> [<span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>7</span>]:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> {<span style=color:#e6db74>&#34;error&#34;</span>: <span style=color:#e6db74>&#34;SomeOtherError&#34;</span>, <span style=color:#e6db74>&#34;url&#34;</span>: url}
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> {<span style=color:#e6db74>&#34;data&#34;</span>: <span style=color:#e6db74>&#34;&lt;html&gt;&#34;</span> <span style=color:#f92672>+</span> str(randint(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>999999</span>)) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;&lt;/html&gt;&#34;</span>, <span style=color:#e6db74>&#34;url&#34;</span>: url}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>with</span> urllib<span style=color:#f92672>.</span>request<span style=color:#f92672>.</span>urlopen(url, timeout<span style=color:#f92672>=</span>timeout) <span style=color:#66d9ef>as</span> conn:
</span></span><span style=display:flex><span>            data <span style=color:#f92672>=</span> conn<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> {<span style=color:#e6db74>&#34;data&#34;</span>: data, <span style=color:#e6db74>&#34;url&#34;</span>: url}
</span></span><span style=display:flex><span>    <span style=color:#75715e># except urllib.error.URLError as e:</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#34;TimeoutError&#34;</span> <span style=color:#f92672>in</span> repr(e):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> {<span style=color:#e6db74>&#34;timeout&#34;</span>: <span style=color:#66d9ef>True</span>, <span style=color:#e6db74>&#34;error&#34;</span>: repr(e), <span style=color:#e6db74>&#34;url&#34;</span>: url}
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> {<span style=color:#e6db74>&#34;error&#34;</span>: repr(e), <span style=color:#e6db74>&#34;url&#34;</span>: url}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>todo <span style=color:#f92672>=</span> [{<span style=color:#e6db74>&#34;url&#34;</span>: url} <span style=color:#66d9ef>for</span> url <span style=color:#f92672>in</span> URLS]
</span></span><span style=display:flex><span>final_results <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>retry_counts <span style=color:#f92672>=</span> defaultdict(int)
</span></span><span style=display:flex><span>max_retries <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> concurrent<span style=color:#f92672>.</span>futures<span style=color:#f92672>.</span>ThreadPoolExecutor(max_workers<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>) <span style=color:#66d9ef>as</span> executor:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        future_list <span style=color:#f92672>=</span> [executor<span style=color:#f92672>.</span>submit(load_url, item[<span style=color:#e6db74>&#34;url&#34;</span>], <span style=color:#ae81ff>60</span>) <span style=color:#66d9ef>for</span> item <span style=color:#f92672>in</span> todo]
</span></span><span style=display:flex><span>        todo <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> future <span style=color:#f92672>in</span> concurrent<span style=color:#f92672>.</span>futures<span style=color:#f92672>.</span>as_completed(future_list):
</span></span><span style=display:flex><span>            result <span style=color:#f92672>=</span> future<span style=color:#f92672>.</span>result()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> result<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;data&#34;</span>):
</span></span><span style=display:flex><span>                final_results<span style=color:#f92672>.</span>append({<span style=color:#f92672>**</span>result, <span style=color:#e6db74>&#34;retries&#34;</span>: retry_counts[result[<span style=color:#e6db74>&#34;url&#34;</span>]]})
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> result<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;error&#34;</span>) <span style=color:#f92672>and</span> <span style=color:#f92672>not</span> result<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;timeout&#34;</span>):
</span></span><span style=display:flex><span>                final_results<span style=color:#f92672>.</span>append({<span style=color:#f92672>**</span>result, <span style=color:#e6db74>&#34;retries&#34;</span>: retry_counts[result[<span style=color:#e6db74>&#34;url&#34;</span>]]})
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> result<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;timeout&#34;</span>) <span style=color:#f92672>and</span> retry_counts[result[<span style=color:#e6db74>&#34;url&#34;</span>]] <span style=color:#f92672>&lt;</span> max_retries:
</span></span><span style=display:flex><span>                retry_counts[result[<span style=color:#e6db74>&#34;url&#34;</span>]] <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                todo<span style=color:#f92672>.</span>append({<span style=color:#e6db74>&#34;url&#34;</span>: result[<span style=color:#e6db74>&#34;url&#34;</span>]})
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                final_results<span style=color:#f92672>.</span>append({<span style=color:#f92672>**</span>result, <span style=color:#e6db74>&#34;reached_max_retries&#34;</span>: <span style=color:#66d9ef>True</span>, <span style=color:#e6db74>&#34;retries&#34;</span>: retry_counts[result[<span style=color:#e6db74>&#34;url&#34;</span>]]})
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> len(final_results) <span style=color:#f92672>==</span> len(URLS):
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Done!&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;we are now </span><span style=color:#e6db74>{</span>len(final_results)<span style=color:#e6db74>}</span><span style=color:#e6db74> out of </span><span style=color:#e6db74>{</span>len(URLS)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><p>with the output</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>we are now <span style=color:#ae81ff>10</span> out of <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>we are now <span style=color:#ae81ff>11</span> out of <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>we are now <span style=color:#ae81ff>16</span> out of <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>we are now <span style=color:#ae81ff>17</span> out of <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>we are now <span style=color:#ae81ff>18</span> out of <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>Done<span style=color:#960050;background-color:#1e0010>!</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>45</span>]: pd<span style=color:#f92672>.</span>DataFrame<span style=color:#f92672>.</span>from_records(final_results)
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>45</span>]: 
</span></span><span style=display:flex><span>               error                url  retries                 data timeout reached_max_retries
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>     SomeOtherError   http:<span style=color:#f92672>//</span>fake0<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>0</span>                  NaN     NaN                 NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>                NaN   http:<span style=color:#f92672>//</span>fake2<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>0</span>  <span style=color:#f92672>&lt;</span>html<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>124983</span><span style=color:#f92672>&lt;/</span>html<span style=color:#f92672>&gt;</span>     NaN                 NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>     SomeOtherError   http:<span style=color:#f92672>//</span>fake3<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>0</span>                  NaN     NaN                 NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span>                NaN   http:<span style=color:#f92672>//</span>fake7<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>0</span>  <span style=color:#f92672>&lt;</span>html<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>459880</span><span style=color:#f92672>&lt;/</span>html<span style=color:#f92672>&gt;</span>     NaN                 NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span>     SomeOtherError  http:<span style=color:#f92672>//</span>fake10<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>0</span>                  NaN     NaN                 NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>5</span>                NaN  http:<span style=color:#f92672>//</span>fake13<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>0</span>  <span style=color:#f92672>&lt;</span>html<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>598498</span><span style=color:#f92672>&lt;/</span>html<span style=color:#f92672>&gt;</span>     NaN                 NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>6</span>                NaN  http:<span style=color:#f92672>//</span>fake15<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>0</span>  <span style=color:#f92672>&lt;</span>html<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>477976</span><span style=color:#f92672>&lt;/</span>html<span style=color:#f92672>&gt;</span>     NaN                 NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>7</span>                NaN  http:<span style=color:#f92672>//</span>fake16<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>0</span>  <span style=color:#f92672>&lt;</span>html<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>748633</span><span style=color:#f92672>&lt;/</span>html<span style=color:#f92672>&gt;</span>     NaN                 NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>8</span>     SomeOtherError  http:<span style=color:#f92672>//</span>fake17<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>0</span>                  NaN     NaN                 NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>9</span>                NaN  http:<span style=color:#f92672>//</span>fake19<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>0</span>  <span style=color:#f92672>&lt;</span>html<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>104853</span><span style=color:#f92672>&lt;/</span>html<span style=color:#f92672>&gt;</span>     NaN                 NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>10</span>               NaN   http:<span style=color:#f92672>//</span>fake9<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>1</span>  <span style=color:#f92672>&lt;</span>html<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>677035</span><span style=color:#f92672>&lt;/</span>html<span style=color:#f92672>&gt;</span>     NaN                 NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>11</span>               NaN   http:<span style=color:#f92672>//</span>fake8<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>2</span>  <span style=color:#f92672>&lt;</span>html<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>249557</span><span style=color:#f92672>&lt;/</span>html<span style=color:#f92672>&gt;</span>     NaN                 NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>12</span>               NaN   http:<span style=color:#f92672>//</span>fake5<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>2</span>  <span style=color:#f92672>&lt;</span>html<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>516063</span><span style=color:#f92672>&lt;/</span>html<span style=color:#f92672>&gt;</span>     NaN                 NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>13</span>    SomeOtherError   http:<span style=color:#f92672>//</span>fake6<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>2</span>                  NaN     NaN                 NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>14</span>    SomeOtherError  http:<span style=color:#f92672>//</span>fake11<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>2</span>                  NaN     NaN                 NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>15</span>               NaN  http:<span style=color:#f92672>//</span>fake12<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>2</span>   <span style=color:#f92672>&lt;</span>html<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>66441</span><span style=color:#f92672>&lt;/</span>html<span style=color:#f92672>&gt;</span>     NaN                 NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>16</span>               NaN   http:<span style=color:#f92672>//</span>fake1<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>3</span>  <span style=color:#f92672>&lt;</span>html<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>604868</span><span style=color:#f92672>&lt;/</span>html<span style=color:#f92672>&gt;</span>     NaN                 NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>17</span>    SomeOtherError  http:<span style=color:#f92672>//</span>fake18<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>4</span>                  NaN     NaN                 NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>18</span>  SimulatedTimeout   http:<span style=color:#f92672>//</span>fake4<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>5</span>                  NaN    <span style=color:#66d9ef>True</span>                <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>19</span>  SimulatedTimeout  http:<span style=color:#f92672>//</span>fake14<span style=color:#f92672>.</span>com        <span style=color:#ae81ff>5</span>                  NaN    <span style=color:#66d9ef>True</span>                <span style=color:#66d9ef>True</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://michal.piekarczyk.xyz/>michal.piekarczyk.xyz</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>