<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Keras Hello WOrld | michal.piekarczyk.xyz</title><meta name=keywords content><meta name=description content="Here I&rsquo;m doing one of the Keras hello world micro projects, involving classification of tiny 28x28 wardrobe images. This was really fun. ( Here&rsquo;s the original home for the python notebook). One really fun part of this was that at the end I hand drew my own clothing samples, paired them down using the python PIL library and threw them against the classifier. Surprisingly, the mini model performed really well. That&rsquo;s some generalizability!"><meta name=author content="Michal Piekarczyk"><link rel=canonical href=https://michal.piekarczyk.xyz/post/2019-05-13--keras-hello-world-fashion/><link crossorigin=anonymous href=/assets/css/stylesheet.dd867d536fb6202811c1ee15fa181ef8945826662b49d3016ac91365a2621d58.css integrity="sha256-3YZ9U2+2ICgRwe4V+hge+JRYJmYrSdMBaskTZaJiHVg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://michal.piekarczyk.xyz/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://michal.piekarczyk.xyz/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://michal.piekarczyk.xyz/favicon-32x32.png><link rel=apple-touch-icon href=https://michal.piekarczyk.xyz/apple-touch-icon.png><link rel=mask-icon href=https://michal.piekarczyk.xyz/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-74MK08REDT"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-74MK08REDT",{anonymize_ip:!1})}</script><meta property="og:title" content="Keras Hello WOrld"><meta property="og:description" content="Here I&rsquo;m doing one of the Keras hello world micro projects, involving classification of tiny 28x28 wardrobe images. This was really fun. ( Here&rsquo;s the original home for the python notebook). One really fun part of this was that at the end I hand drew my own clothing samples, paired them down using the python PIL library and threw them against the classifier. Surprisingly, the mini model performed really well. That&rsquo;s some generalizability!"><meta property="og:type" content="article"><meta property="og:url" content="https://michal.piekarczyk.xyz/post/2019-05-13--keras-hello-world-fashion/"><meta property="article:section" content="post"><meta property="article:published_time" content="2019-05-13T00:00:00+00:00"><meta property="article:modified_time" content="2019-05-13T00:00:00+00:00"><meta property="og:site_name" content="michal.piekarczyk.xyz"><meta name=twitter:card content="summary"><meta name=twitter:title content="Keras Hello WOrld"><meta name=twitter:description content="Here I&rsquo;m doing one of the Keras hello world micro projects, involving classification of tiny 28x28 wardrobe images. This was really fun. ( Here&rsquo;s the original home for the python notebook). One really fun part of this was that at the end I hand drew my own clothing samples, paired them down using the python PIL library and threw them against the classifier. Surprisingly, the mini model performed really well. That&rsquo;s some generalizability!"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://michal.piekarczyk.xyz/post/"},{"@type":"ListItem","position":2,"name":"Keras Hello WOrld","item":"https://michal.piekarczyk.xyz/post/2019-05-13--keras-hello-world-fashion/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Keras Hello WOrld","name":"Keras Hello WOrld","description":"Here I\u0026rsquo;m doing one of the Keras hello world micro projects, involving classification of tiny 28x28 wardrobe images. This was really fun. ( Here\u0026rsquo;s the original home for the python notebook). One really fun part of this was that at the end I hand drew my own clothing samples, paired them down using the python PIL library and threw them against the classifier. Surprisingly, the mini model performed really well. That\u0026rsquo;s some generalizability!","keywords":[],"articleBody":"Here I’m doing one of the Keras hello world micro projects, involving classification of tiny 28x28 wardrobe images. This was really fun. ( Here’s the original home for the python notebook). One really fun part of this was that at the end I hand drew my own clothing samples, paired them down using the python PIL library and threw them against the classifier. Surprisingly, the mini model performed really well. That’s some generalizability!\nAlso this was a really nice expansion of my existing matplotlib knowledge. The grid plotting protips here were a great addition to my repertoire.\nfrom __future__ import absolute_import, division, print_function, unicode_literals # TensorFlow and tf.keras import tensorflow as tf from tensorflow import keras # Helper libraries import numpy as np import matplotlib.pyplot as plt print(tf.__version__) 1.13.1 fashion_mnist = keras.datasets.fashion_mnist (train_images, train_labels), (test_images, test_labels) = fashion_mnist.load_data() Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-labels-idx1-ubyte.gz 32768/29515 [=================================] - 0s 0us/step Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-images-idx3-ubyte.gz 26427392/26421880 [==============================] - 2s 0us/step Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-labels-idx1-ubyte.gz 8192/5148 [===============================================] - 0s 0us/step Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-images-idx3-ubyte.gz 4423680/4422102 [==============================] - 0s 0us/step class_names = ['T-shirt/top', 'Trouser', 'Pullover', 'Dress', 'Coat', 'Sandal', 'Shirt', 'Sneaker', 'Bag', 'Ankle boot'] plt.figure() plt.imshow(train_images[3]) plt.colorbar() plt.grid(False) plt.show() # Hmm so this `cmap=plt.cm.binary` kwarg displays grayscale instead of that strange purple to yellow scale. plt.figure() plt.imshow(train_images[3]/255.0, cmap=plt.cm.binary) plt.colorbar() plt.grid(False) plt.show() # This is almost like the output of a TSA luggage xray scanner plt.figure(figsize=(10,10)) for i in range(25): plt.subplot(5,5,i+1) plt.xticks([]) plt.yticks([]) plt.grid(False) plt.imshow(train_images[i]) # , cmap=plt.cm.binary plt.xlabel(class_names[train_labels[i]]) plt.show() train_images_scaled = train_images / 255.0 test_images_scaled = test_images / 255.0 model = keras.Sequential([ keras.layers.Flatten(input_shape=(28, 28)), keras.layers.Dense(128, activation=tf.nn.relu), keras.layers.Dense(10, activation=tf.nn.softmax) ]) WARNING:tensorflow:From /usr/local/miniconda3/envs/pandars3/lib/python3.7/site-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version. Instructions for updating: Colocations handled automatically by placer. model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['accuracy']) # Looking at the use of the non-scaled data first. # Wow that looks like terrible accuracy. model.fit(train_images, train_labels, epochs=5) Epoch 1/5 60000/60000 [==============================] - 4s 70us/sample - loss: 14.5146 - acc: 0.0995 Epoch 2/5 60000/60000 [==============================] - 4s 66us/sample - loss: 13.7328 - acc: 0.1479 Epoch 3/5 60000/60000 [==============================] - 4s 66us/sample - loss: 13.0450 - acc: 0.1906 Epoch 4/5 60000/60000 [==============================] - 4s 66us/sample - loss: 13.0474 - acc: 0.1905 Epoch 5/5 60000/60000 [==============================] - 4s 68us/sample - loss: 12.9979 - acc: 0.1936 # Yea if that is out of 1.0 then this 0.1917 is pretty low test_loss, test_acc = model.evaluate(test_images, test_labels) print('Test accuracy:', test_acc) 10000/10000 [==============================] - 0s 26us/sample - loss: 13.0283 - acc: 0.1917 Test accuracy: 0.1917 # Try on that scaled data now .. # Okay this looks better. more like the result in the tutorial. model.fit(train_images_scaled, train_labels, epochs=5) Epoch 1/5 60000/60000 [==============================] - 4s 68us/sample - loss: 0.5902 - acc: 0.8182 Epoch 2/5 60000/60000 [==============================] - 4s 66us/sample - loss: 0.3900 - acc: 0.8622 Epoch 3/5 60000/60000 [==============================] - 4s 67us/sample - loss: 0.3526 - acc: 0.8739 Epoch 4/5 60000/60000 [==============================] - 4s 66us/sample - loss: 0.3319 - acc: 0.8788 Epoch 5/5 60000/60000 [==============================] - 4s 66us/sample - loss: 0.3141 - acc: 0.8858 model.input_shape, model.output_shape ((None, 28, 28), (None, 10)) model.weights [","wordCount":"1975","inLanguage":"en","datePublished":"2019-05-13T00:00:00Z","dateModified":"2019-05-13T00:00:00Z","author":{"@type":"Person","name":"Michal Piekarczyk"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://michal.piekarczyk.xyz/post/2019-05-13--keras-hello-world-fashion/"},"publisher":{"@type":"Organization","name":"michal.piekarczyk.xyz","logo":{"@type":"ImageObject","url":"https://michal.piekarczyk.xyz/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://michal.piekarczyk.xyz/ accesskey=h title="michal.piekarczyk.xyz (Alt + H)">michal.piekarczyk.xyz</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://michal.piekarczyk.xyz/post/ title=posts><span>posts</span></a></li><li><a href=https://michal.piekarczyk.xyz/project/ title=projects><span>projects</span></a></li><li><a href=https://michal.piekarczyk.xyz/handy/ title=handy><span>handy</span></a></li><li><a href=https://michal.piekarczyk.xyz/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://michal.piekarczyk.xyz/about/ title=about><span>about</span></a></li><li><a href=https://world.hey.com/michal.piekarczyk title=frivolity><span>frivolity</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://michal.piekarczyk.xyz/>Home</a>&nbsp;»&nbsp;<a href=https://michal.piekarczyk.xyz/post/>Posts</a></div><h1 class=post-title>Keras Hello WOrld</h1><div class=post-meta><span title='2019-05-13 00:00:00 +0000 UTC'>131313-13-1312</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp;1975 words&nbsp;·&nbsp;Michal Piekarczyk</div></header><div class=post-content><p>Here I&rsquo;m doing one of the Keras hello world micro projects, involving classification of tiny <code>28x28</code> wardrobe images. This was really fun. ( <a href=https://github.com/namoopsoo/aviation-pilot-physiology-hmm/blob/master/notes/2019-05-13--keras-hello-world-fashion.ipynb>Here&rsquo;s the original home</a> for the python notebook). One really fun part of this was that at the end I hand drew my own clothing samples, paired them down using the python <code>PIL</code> library and threw them against the classifier. Surprisingly, the mini model performed really well. That&rsquo;s some generalizability!</p><p>Also this was a really nice expansion of my existing <code>matplotlib</code> knowledge. The grid plotting protips here were a great addition to my repertoire.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> __future__ <span style=color:#f92672>import</span> absolute_import, division, print_function, unicode_literals
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># TensorFlow and tf.keras</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> tensorflow <span style=color:#66d9ef>as</span> tf
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> tensorflow <span style=color:#f92672>import</span> keras
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Helper libraries</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(tf<span style=color:#f92672>.</span>__version__)
</span></span></code></pre></div><pre><code>1.13.1
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fashion_mnist <span style=color:#f92672>=</span> keras<span style=color:#f92672>.</span>datasets<span style=color:#f92672>.</span>fashion_mnist
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(train_images, train_labels), (test_images, test_labels) <span style=color:#f92672>=</span> fashion_mnist<span style=color:#f92672>.</span>load_data()
</span></span></code></pre></div><pre><code>Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-labels-idx1-ubyte.gz
32768/29515 [=================================] - 0s 0us/step
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-images-idx3-ubyte.gz
26427392/26421880 [==============================] - 2s 0us/step
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-labels-idx1-ubyte.gz
8192/5148 [===============================================] - 0s 0us/step
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-images-idx3-ubyte.gz
4423680/4422102 [==============================] - 0s 0us/step
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>class_names <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;T-shirt/top&#39;</span>, <span style=color:#e6db74>&#39;Trouser&#39;</span>, <span style=color:#e6db74>&#39;Pullover&#39;</span>, <span style=color:#e6db74>&#39;Dress&#39;</span>, <span style=color:#e6db74>&#39;Coat&#39;</span>,
</span></span><span style=display:flex><span>               <span style=color:#e6db74>&#39;Sandal&#39;</span>, <span style=color:#e6db74>&#39;Shirt&#39;</span>, <span style=color:#e6db74>&#39;Sneaker&#39;</span>, <span style=color:#e6db74>&#39;Bag&#39;</span>, <span style=color:#e6db74>&#39;Ankle boot&#39;</span>]
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure()
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>imshow(train_images[<span style=color:#ae81ff>3</span>])
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>colorbar()
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Hmm so this `cmap=plt.cm.binary` kwarg displays grayscale instead of that strange purple to yellow scale.</span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure()
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>imshow(train_images[<span style=color:#ae81ff>3</span>]<span style=color:#f92672>/</span><span style=color:#ae81ff>255.0</span>, cmap<span style=color:#f92672>=</span>plt<span style=color:#f92672>.</span>cm<span style=color:#f92672>.</span>binary)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>colorbar()
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># This is almost like the output of a TSA luggage xray scanner </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>10</span>))
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>25</span>):
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>subplot(<span style=color:#ae81ff>5</span>,<span style=color:#ae81ff>5</span>,i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>xticks([])
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>yticks([])
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>imshow(train_images[i]) <span style=color:#75715e># , cmap=plt.cm.binary</span>
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>xlabel(class_names[train_labels[i]])
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>train_images_scaled <span style=color:#f92672>=</span> train_images <span style=color:#f92672>/</span> <span style=color:#ae81ff>255.0</span>
</span></span><span style=display:flex><span>test_images_scaled <span style=color:#f92672>=</span> test_images <span style=color:#f92672>/</span> <span style=color:#ae81ff>255.0</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>model <span style=color:#f92672>=</span> keras<span style=color:#f92672>.</span>Sequential([
</span></span><span style=display:flex><span>    keras<span style=color:#f92672>.</span>layers<span style=color:#f92672>.</span>Flatten(input_shape<span style=color:#f92672>=</span>(<span style=color:#ae81ff>28</span>, <span style=color:#ae81ff>28</span>)),
</span></span><span style=display:flex><span>    keras<span style=color:#f92672>.</span>layers<span style=color:#f92672>.</span>Dense(<span style=color:#ae81ff>128</span>, activation<span style=color:#f92672>=</span>tf<span style=color:#f92672>.</span>nn<span style=color:#f92672>.</span>relu),
</span></span><span style=display:flex><span>    keras<span style=color:#f92672>.</span>layers<span style=color:#f92672>.</span>Dense(<span style=color:#ae81ff>10</span>, activation<span style=color:#f92672>=</span>tf<span style=color:#f92672>.</span>nn<span style=color:#f92672>.</span>softmax)
</span></span><span style=display:flex><span>])
</span></span></code></pre></div><pre><code>WARNING:tensorflow:From /usr/local/miniconda3/envs/pandars3/lib/python3.7/site-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>model<span style=color:#f92672>.</span>compile(optimizer<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;adam&#39;</span>, 
</span></span><span style=display:flex><span>              loss<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;sparse_categorical_crossentropy&#39;</span>,
</span></span><span style=display:flex><span>              metrics<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;accuracy&#39;</span>])
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Looking at the use of the non-scaled data first.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Wow that looks like terrible accuracy.</span>
</span></span><span style=display:flex><span>model<span style=color:#f92672>.</span>fit(train_images, train_labels, epochs<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>)
</span></span></code></pre></div><pre><code>Epoch 1/5
60000/60000 [==============================] - 4s 70us/sample - loss: 14.5146 - acc: 0.0995
Epoch 2/5
60000/60000 [==============================] - 4s 66us/sample - loss: 13.7328 - acc: 0.1479
Epoch 3/5
60000/60000 [==============================] - 4s 66us/sample - loss: 13.0450 - acc: 0.1906
Epoch 4/5
60000/60000 [==============================] - 4s 66us/sample - loss: 13.0474 - acc: 0.1905
Epoch 5/5
60000/60000 [==============================] - 4s 68us/sample - loss: 12.9979 - acc: 0.1936





&lt;tensorflow.python.keras.callbacks.History at 0x139540978&gt;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Yea if that is out of 1.0 then this 0.1917 is pretty low</span>
</span></span><span style=display:flex><span>test_loss, test_acc <span style=color:#f92672>=</span> model<span style=color:#f92672>.</span>evaluate(test_images, test_labels)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;Test accuracy:&#39;</span>, test_acc)
</span></span></code></pre></div><pre><code>10000/10000 [==============================] - 0s 26us/sample - loss: 13.0283 - acc: 0.1917
Test accuracy: 0.1917
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Try on that scaled data now ..</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Okay this looks better. more like the result in the tutorial.</span>
</span></span><span style=display:flex><span>model<span style=color:#f92672>.</span>fit(train_images_scaled, train_labels, epochs<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>)
</span></span></code></pre></div><pre><code>Epoch 1/5
60000/60000 [==============================] - 4s 68us/sample - loss: 0.5902 - acc: 0.8182
Epoch 2/5
60000/60000 [==============================] - 4s 66us/sample - loss: 0.3900 - acc: 0.8622
Epoch 3/5
60000/60000 [==============================] - 4s 67us/sample - loss: 0.3526 - acc: 0.8739
Epoch 4/5
60000/60000 [==============================] - 4s 66us/sample - loss: 0.3319 - acc: 0.8788
Epoch 5/5
60000/60000 [==============================] - 4s 66us/sample - loss: 0.3141 - acc: 0.8858





&lt;tensorflow.python.keras.callbacks.History at 0x1424e8fd0&gt;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>model<span style=color:#f92672>.</span>input_shape, model<span style=color:#f92672>.</span>output_shape
</span></span></code></pre></div><pre><code>((None, 28, 28), (None, 10))
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>model<span style=color:#f92672>.</span>weights
</span></span></code></pre></div><pre><code>[&lt;tf.Variable 'dense/kernel:0' shape=(784, 128) dtype=float32&gt;,
 &lt;tf.Variable 'dense/bias:0' shape=(128,) dtype=float32&gt;,
 &lt;tf.Variable 'dense_1/kernel:0' shape=(128, 10) dtype=float32&gt;,
 &lt;tf.Variable 'dense_1/bias:0' shape=(10,) dtype=float32&gt;]
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>test_loss, test_acc <span style=color:#f92672>=</span> model<span style=color:#f92672>.</span>evaluate(test_images_scaled, test_labels)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;Test accuracy:&#39;</span>, test_acc)
</span></span></code></pre></div><pre><code>10000/10000 [==============================] - 0s 34us/sample - loss: 0.3489 - acc: 0.8740
Test accuracy: 0.874
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>predictions <span style=color:#f92672>=</span> model<span style=color:#f92672>.</span>predict(test_images_scaled)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>predictions[<span style=color:#ae81ff>0</span>], test_labels[<span style=color:#ae81ff>0</span>]
</span></span></code></pre></div><pre><code>(array([1.3787793e-05, 5.9650089e-09, 1.9482790e-07, 1.8630770e-09,
        3.6141572e-07, 3.6579393e-02, 1.0138750e-05, 1.5758899e-01,
        1.9775856e-04, 8.0560941e-01], dtype=float32), 9)
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>plot_image</span>(i, predictions_array, true_label, img):
</span></span><span style=display:flex><span>  predictions_array, true_label, img <span style=color:#f92672>=</span> predictions_array[i], true_label[i], img[i]
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>xticks([])
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>yticks([])
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>imshow(img, cmap<span style=color:#f92672>=</span>plt<span style=color:#f92672>.</span>cm<span style=color:#f92672>.</span>binary)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  predicted_label <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>argmax(predictions_array)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> predicted_label <span style=color:#f92672>==</span> true_label:
</span></span><span style=display:flex><span>    color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;blue&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>    color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;red&#39;</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>xlabel(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{}</span><span style=color:#e6db74> </span><span style=color:#e6db74>{:2.0f}</span><span style=color:#e6db74>% (</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>)&#34;</span><span style=color:#f92672>.</span>format(class_names[predicted_label],
</span></span><span style=display:flex><span>                                <span style=color:#ae81ff>100</span><span style=color:#f92672>*</span>np<span style=color:#f92672>.</span>max(predictions_array),
</span></span><span style=display:flex><span>                                class_names[true_label]),
</span></span><span style=display:flex><span>                                color<span style=color:#f92672>=</span>color)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>plot_value_array</span>(i, predictions_array, true_label):
</span></span><span style=display:flex><span>  predictions_array, true_label <span style=color:#f92672>=</span> predictions_array[i], true_label[i]
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>xticks([])
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>yticks([])
</span></span><span style=display:flex><span>  thisplot <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>bar(range(<span style=color:#ae81ff>10</span>), predictions_array, color<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#777777&#34;</span>)
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>ylim([<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>]) 
</span></span><span style=display:flex><span>  predicted_label <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>argmax(predictions_array)
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  thisplot[predicted_label]<span style=color:#f92672>.</span>set_color(<span style=color:#e6db74>&#39;red&#39;</span>)
</span></span><span style=display:flex><span>  thisplot[true_label]<span style=color:#f92672>.</span>set_color(<span style=color:#e6db74>&#39;blue&#39;</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>6</span>,<span style=color:#ae81ff>3</span>))
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>subplot(<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>plot_image(i, predictions, test_labels, test_images)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>subplot(<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>plot_value_array(i, predictions,  test_labels)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>thisplot <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>bar(range(<span style=color:#ae81ff>5</span>), [<span style=color:#ae81ff>.1</span>, <span style=color:#ae81ff>.2</span>, <span style=color:#ae81ff>.3</span>, <span style=color:#ae81ff>.4</span>, <span style=color:#ae81ff>.9</span>], color<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#777777&#34;</span>)
</span></span><span style=display:flex><span>thisplot[<span style=color:#ae81ff>2</span>]<span style=color:#f92672>.</span>set_color(<span style=color:#e6db74>&#39;orange&#39;</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Plot the first X test images, their predicted label, and the true label</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Color correct predictions in blue, incorrect predictions in red</span>
</span></span><span style=display:flex><span>num_rows <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>num_cols <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>num_images <span style=color:#f92672>=</span> num_rows<span style=color:#f92672>*</span>num_cols
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>num_cols, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>num_rows))
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(num_images):
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>subplot(num_rows, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>num_cols, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>  plot_image(i, predictions, test_labels, test_images)
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>subplot(num_rows, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>num_cols, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>i<span style=color:#f92672>+</span><span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>  plot_value_array(i, predictions, test_labels)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># For fun, I want to try and run the model on my own hand drawn images.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Raw im</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> IPython.display <span style=color:#66d9ef>as</span> ipd <span style=color:#75715e># import Image</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># These four pngs were created w/ Adobe sketchbook</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Then I manually cropped them with macOS Preview to make sure they are squares.</span>
</span></span><span style=display:flex><span>rawnames <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;2019-05-13 14.29.04.png&#39;</span>,
</span></span><span style=display:flex><span>                 <span style=color:#e6db74>&#39;2019-05-13 14.30.20.png&#39;</span>,
</span></span><span style=display:flex><span>                 <span style=color:#e6db74>&#39;2019-05-13 14.31.18.png&#39;</span>,
</span></span><span style=display:flex><span>                 <span style=color:#e6db74>&#39;2019-05-13 14.32.27.png&#39;</span>]
</span></span><span style=display:flex><span>filenames <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;keras-fashion-helloworld/myimages-originals/&#39;</span> <span style=color:#f92672>+</span> x
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> rawnames
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[ipd<span style=color:#f92672>.</span>display(ipd<span style=color:#f92672>.</span>Image(filename<span style=color:#f92672>=</span>fn))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> fn <span style=color:#f92672>in</span> filenames]
</span></span><span style=display:flex><span><span style=color:#75715e># ipd.Image(filename=&#39;keras-fashion-helloworld/myimages-originals/2019-05-13 14.29.04--8.png&#39;)</span>
</span></span></code></pre></div><pre><code>[None, None, None, None]
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># with the help of PIL, obtained with `pip install Pillow`</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> PIL <span style=color:#f92672>import</span> Image
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>extract_vec</span>(img):
</span></span><span style=display:flex><span>    <span style=color:#75715e># re-scale to 28x28 in place</span>
</span></span><span style=display:flex><span>    img<span style=color:#f92672>.</span>thumbnail((<span style=color:#ae81ff>28</span>, <span style=color:#ae81ff>28</span>), Image<span style=color:#f92672>.</span>ANTIALIAS)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    values <span style=color:#f92672>=</span> list(img<span style=color:#f92672>.</span>getdata())
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    pixels <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([x[<span style=color:#ae81ff>0</span>] <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> values])
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> np<span style=color:#f92672>.</span>resize(pixels, (<span style=color:#ae81ff>28</span>, <span style=color:#ae81ff>28</span>))
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># quick example of first image, </span>
</span></span><span style=display:flex><span>print(extract_vec(Image<span style=color:#f92672>.</span>open(filenames[<span style=color:#ae81ff>0</span>])))
</span></span></code></pre></div><pre><code>[[254 250 240 238 242 255 255 252 247 232 226 226 228 229 228 229 228 234
  244 246 245 247 248 255 255 254 255 255]
 [244 223 195 187 170 143 137 141 139 155 172 171 185 194 190 186 183 189
  121 101 110 113 104 147 205 242 249 255]
 [226 195 148  86  26  13  29  52  65  78  71  89 103 114 115 104  92  74
   61  99 103  99  82  58  67 148 224 248]
 [202 117  52  47  53  61  86  88  91  96  91  84  79  79  75  74  78  71
  111 120 122 129 115  99  94  79 109 218]
 [104  59  84  97  67  56  54  50  65  68  72  82  89  94  93  97 115 109
  125 115  92  94  82  69  70  89  89 112]
 [ 89 139 127  79  58  53  61  48  55  63  52  51  59  63  64  69  79  86
  110 119  91  75  79  71  69  72 110 138]
 [159  77 115 106  76  68  74  57  53  55  40  41  52  58  57  60  65  68
   88 101  97 100  92  84  94  98 107 117]
 [213 149  62 100  97  76  70  58  61  84  80  43  56  67  62  53  60  55
   57  70  94 108 107 112 107 119  90 148]
 [216 198 126  43 102 100  62  69  84  88 102  59  57  68  58  55  64  66
   64  61  88  98 104 137 131  99 115 179]
 [248 226 208 110  61  62  47  55  86  69  55  57  64  67  57  49  67  82
   76  66  87  87  67 106 129 108 169 199]
 [255 254 249 214  51  89 159  94  69  57  43  45  58  53  37  33  44  48
   51  50  68  74 125 158  71 130 212 231]
 [255 255 255 255 212 165 223  91  51  45  42  39  40  39  45  47  37  41
   42  41  58  63 136 235 209 200 236 252]
 [255 255 255 255 255 242 189  69  53  59  52  37  27  35  58  59  47  45
   36  34  55  60 139 237 242 248 252 254]
 [255 255 255 254 254 247 157  61  71  76  60  33  26  27  42  55  58  45
   36  32  55  62 130 245 252 254 254 255]
 [255 255 255 254 255 237 154  67  79  64  46  28  16  18  36  52  48  36
   29  37  58  56 114 240 255 254 255 255]
 [255 255 255 254 255 245 162  67  62  52  40  24  12  11  24  36  33  23
   25  32  52  58 113 232 255 255 255 255]
 [255 255 255 255 255 249 185  70  47  37  33  30  20  12  12  19  17  13
   17  23  50  56 106 227 254 255 255 255]
 [255 255 255 255 255 252 192  77  49  38  33  31  18   9   6  10  12   9
   11  22  56  52  98 219 250 255 255 255]
 [255 255 255 255 255 254 212  86  53  38  38  34  14   5   5   8   7   7
   14  25  59  58  77 209 247 255 255 255]
 [255 255 255 255 254 255 248 119  35  23  24  21  11   5   6  10  10  11
   16  35  72  69  62 205 251 255 255 255]
 [255 255 255 255 255 253 255 155  37  23  10   9   7   6  12  17  14  12
   20  45  73  65  67 205 251 255 255 255]
 [255 255 255 255 255 254 255 155  53  43  25  23  19  17  23  27  19  20
   27  47  76  78  73 208 252 255 255 255]
 [255 255 255 255 254 255 245 152  73  64  33  29  28  31  44  43  33  36
   43  57  78  89  75 216 254 255 255 255]
 [255 255 255 255 255 255 239 155  68  76  41  26  25  45  62  63  49  51
   63  76  92  97  79 211 252 255 255 255]
 [255 255 255 255 255 255 239 159  69  75  55  32  36  57  69  72  64  63
   82  94 114 116  99 223 251 255 255 255]
 [255 255 255 255 255 255 240 165  89 103  71  52  60  74  75  76  80  88
  124 134 134 143 114 233 252 255 255 255]
 [255 255 255 255 255 255 253 184  85 107  82  68  74  93  94  91  93 109
  149 163 137 102  79 239 255 254 255 255]
 [255 255 255 255 255 255 255 235 175 138 106  93  84  81  78  71  71  75
   91 102 125 155 175 255 254 255 255 255]]
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>filenames[<span style=color:#ae81ff>0</span>]
</span></span></code></pre></div><pre><code>'keras-fashion-helloworld/myimages-originals/2019-05-13 14.29.04.png'
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># </span>
</span></span><span style=display:flex><span>my_clothing_vecs <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([extract_vec(Image<span style=color:#f92672>.</span>open(fn)) <span style=color:#66d9ef>for</span> fn <span style=color:#f92672>in</span> filenames])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># and so lets try and display them with matplot lib again like the provided images...</span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>10</span>))
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(my_clothing_vecs)):
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>subplot(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>xticks([])
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>yticks([])
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>imshow(my_clothing_vecs[i]) <span style=color:#75715e># , cmap=plt.cm.binary</span>
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>xlabel(rawnames[i])
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>my_clothing_vecs<span style=color:#f92672>.</span>shape
</span></span></code></pre></div><pre><code>(4, 28, 28)
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Ah crap, this looks inverted compared to what I see in the tutorial. </span>
</span></span><span style=display:flex><span><span style=color:#75715e># Going to attempt to invert that real quick...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>invert255 <span style=color:#f92672>=</span> <span style=color:#66d9ef>lambda</span> x: abs(<span style=color:#ae81ff>255</span> <span style=color:#f92672>-</span> x) 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>invert_many</span>(img_vec):
</span></span><span style=display:flex><span>    input_shape <span style=color:#f92672>=</span> img_vec<span style=color:#f92672>.</span>shape
</span></span><span style=display:flex><span>    length <span style=color:#f92672>=</span> input_shape[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> input_shape[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    invert_pxl <span style=color:#f92672>=</span> <span style=color:#66d9ef>lambda</span> x: abs(<span style=color:#ae81ff>255</span> <span style=color:#f92672>-</span> x) 
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> np<span style=color:#f92672>.</span>resize(
</span></span><span style=display:flex><span>        [invert_pxl(x)
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> np<span style=color:#f92672>.</span>resize(img_vec, (<span style=color:#ae81ff>1</span>, length))],
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>                     input_shape)
</span></span><span style=display:flex><span>    
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># invert them all</span>
</span></span><span style=display:flex><span>clothing_vecs_inverted <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>vectorize(invert255)(my_clothing_vecs)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>my_clothing_vecs<span style=color:#f92672>.</span>shape, clothing_vecs_inverted<span style=color:#f92672>.</span>shape
</span></span></code></pre></div><pre><code>((4, 28, 28), (4, 28, 28))
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Okay cool... now this looks like the other earlier data.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>10</span>))
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(clothing_vecs_inverted)):
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>subplot(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>xticks([])
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>yticks([])
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>imshow(clothing_vecs_inverted[i]) <span style=color:#75715e># , cmap=plt.cm.binary</span>
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>xlabel(rawnames[i])
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Now lets see what the predictions say</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># First the scaling...</span>
</span></span><span style=display:flex><span>my_scaled_and_inverted <span style=color:#f92672>=</span> clothing_vecs_inverted<span style=color:#f92672>/</span><span style=color:#ae81ff>255.0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>newpredictions <span style=color:#f92672>=</span> model<span style=color:#f92672>.</span>predict(my_scaled_and_inverted)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>print(list(enumerate(class_names)))
</span></span></code></pre></div><pre><code>[(0, 'T-shirt/top'), (1, 'Trouser'), (2, 'Pullover'), (3, 'Dress'), (4, 'Coat'), (5, 'Sandal'), (6, 'Shirt'), (7, 'Sneaker'), (8, 'Bag'), (9, 'Ankle boot')]
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>my_test_labels <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>])
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>newpredictions
</span></span></code></pre></div><pre><code>array([[4.26309437e-01, 2.92650770e-06, 1.60550058e-04, 9.47394001e-04,
        1.30431754e-05, 1.05808425e-07, 5.70735812e-01, 5.16380161e-10,
        1.83065375e-03, 7.26391747e-09],
       [2.88550858e-03, 3.26211921e-05, 8.07017728e-04, 7.98632973e-05,
        3.09603085e-04, 7.77611732e-01, 1.04915572e-03, 1.50996149e-01,
        6.37709629e-03, 5.98511957e-02],
       [1.78965013e-02, 8.74079406e-01, 4.85132486e-02, 3.52283381e-03,
        3.91321108e-02, 1.26371131e-04, 1.65334735e-02, 1.32581690e-07,
        1.95919056e-04, 2.40851268e-08],
       [6.74940348e-02, 6.74244831e-04, 7.51323474e-04, 2.22629853e-04,
        3.27958390e-02, 3.78045649e-03, 6.39505684e-01, 7.55926128e-04,
        1.57964438e-01, 9.60554630e-02]], dtype=float32)
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Plot the first X test images, their predicted label, and the true label</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Color correct predictions in blue, incorrect predictions in red</span>
</span></span><span style=display:flex><span>num_rows <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>num_cols <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>num_images <span style=color:#f92672>=</span> num_rows<span style=color:#f92672>*</span>num_cols
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>num_cols, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>num_rows))
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(num_images):
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>subplot(num_rows, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>num_cols, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>  plot_image(i, newpredictions, my_test_labels, my_scaled_and_inverted)
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>subplot(num_rows, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>num_cols, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>i<span style=color:#f92672>+</span><span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>  plot_value_array(i, newpredictions, my_test_labels)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Wow, that looks pretty good. </span>
</span></span><span style=display:flex><span><span style=color:#75715e># - Haha apparently the Tshirt I drew looks a bit more like a &#34;Shirt&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - And my coat looks like a &#34;Shirt&#34; . Of course that was expected. I have no idea how that distinction </span>
</span></span><span style=display:flex><span><span style=color:#75715e>#     is captured by the model</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - And yea, my sneaker looks kind of like a sandal? Okay makes sense. </span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://michal.piekarczyk.xyz/project/2020-04-05-aviation-kaggle-low-level/><span class=title>« Prev</span><br><span>Physiological deep learnings</span></a>
<a class=next href=https://michal.piekarczyk.xyz/post/2019-03-16--ffmpeg-notes/><span class=title>Next »</span><br><span>Using ffmpeg to Merge Videos</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://michal.piekarczyk.xyz/>michal.piekarczyk.xyz</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>