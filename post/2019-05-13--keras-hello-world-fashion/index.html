<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Keras Hello WOrld | My blog</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Here I&rsquo;m doing one of the Keras hello world micro projects, involving classification of tiny 28x28 wardrobe images. This was really fun. ( Here&rsquo;s the original home for the python notebook). One really fun part of this was that at the end I hand drew my own clothing samples, paired them down using the python PIL library and threw them against the classifier. Surprisingly, the mini model performed really well. That&rsquo;s some generalizability!"><meta name=generator content="Hugo 0.103.0"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel=stylesheet href=/ananke/dist/main.css_5c99d70a7725bacd4c701e995b969fea.css><meta property="og:title" content="Keras Hello WOrld"><meta property="og:description" content="Here I&rsquo;m doing one of the Keras hello world micro projects, involving classification of tiny 28x28 wardrobe images. This was really fun. ( Here&rsquo;s the original home for the python notebook). One really fun part of this was that at the end I hand drew my own clothing samples, paired them down using the python PIL library and threw them against the classifier. Surprisingly, the mini model performed really well. That&rsquo;s some generalizability!"><meta property="og:type" content="article"><meta property="og:url" content="https://michal.piekarczyk.xyz/post/2019-05-13--keras-hello-world-fashion/"><meta property="article:section" content="post"><meta property="article:published_time" content="2019-05-13T00:00:00+00:00"><meta property="article:modified_time" content="2019-05-13T00:00:00+00:00"><meta property="og:site_name" content="My blog"><meta itemprop=name content="Keras Hello WOrld"><meta itemprop=description content="Here I&rsquo;m doing one of the Keras hello world micro projects, involving classification of tiny 28x28 wardrobe images. This was really fun. ( Here&rsquo;s the original home for the python notebook). One really fun part of this was that at the end I hand drew my own clothing samples, paired them down using the python PIL library and threw them against the classifier. Surprisingly, the mini model performed really well. That&rsquo;s some generalizability!"><meta itemprop=datePublished content="2019-05-13T00:00:00+00:00"><meta itemprop=dateModified content="2019-05-13T00:00:00+00:00"><meta itemprop=wordCount content="1975"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Keras Hello WOrld"><meta name=twitter:description content="Here I&rsquo;m doing one of the Keras hello world micro projects, involving classification of tiny 28x28 wardrobe images. This was really fun. ( Here&rsquo;s the original home for the python notebook). One really fun part of this was that at the end I hand drew my own clothing samples, paired them down using the python PIL library and threw them against the classifier. Surprisingly, the mini model performed really well. That&rsquo;s some generalizability!"></head><body class="ma0 avenir bg-near-white"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">My blog</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/about/ title="About page">About</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/handy/ title="Handy page">Handy</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/post/ title="Post page">Post</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/project/ title="Side Projects page">Side Projects</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/foo/ title="The Foos page">The Foos</a></li></ul></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POST</aside><div id=sharing class=mt3><a href="https://www.facebook.com/sharer.php?u=https://michal.piekarczyk.xyz/post/2019-05-13--keras-hello-world-fashion/" class="facebook no-underline" aria-label="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a href="https://twitter.com/share?url=https://michal.piekarczyk.xyz/post/2019-05-13--keras-hello-world-fashion/&text=Keras%20Hello%20WOrld" class="twitter no-underline" aria-label="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://michal.piekarczyk.xyz/post/2019-05-13--keras-hello-world-fashion/&title=Keras%20Hello%20WOrld" class="linkedin no-underline" aria-label="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 athelas mt3 mb1">Keras Hello WOrld</h1><time class="f6 mv4 dib tracked" datetime=2019-05-13T00:00:00Z>May 13, 2019</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>Here I&rsquo;m doing one of the Keras hello world micro projects, involving classification of tiny <code>28x28</code> wardrobe images. This was really fun. ( <a href=https://github.com/namoopsoo/aviation-pilot-physiology-hmm/blob/master/notes/2019-05-13--keras-hello-world-fashion.ipynb>Here&rsquo;s the original home</a> for the python notebook). One really fun part of this was that at the end I hand drew my own clothing samples, paired them down using the python <code>PIL</code> library and threw them against the classifier. Surprisingly, the mini model performed really well. That&rsquo;s some generalizability!</p><p>Also this was a really nice expansion of my existing <code>matplotlib</code> knowledge. The grid plotting protips here were a great addition to my repertoire.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> __future__ <span style=color:#f92672>import</span> absolute_import, division, print_function, unicode_literals
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># TensorFlow and tf.keras</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> tensorflow <span style=color:#66d9ef>as</span> tf
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> tensorflow <span style=color:#f92672>import</span> keras
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Helper libraries</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(tf<span style=color:#f92672>.</span>__version__)
</span></span></code></pre></div><pre><code>1.13.1
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fashion_mnist <span style=color:#f92672>=</span> keras<span style=color:#f92672>.</span>datasets<span style=color:#f92672>.</span>fashion_mnist
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(train_images, train_labels), (test_images, test_labels) <span style=color:#f92672>=</span> fashion_mnist<span style=color:#f92672>.</span>load_data()
</span></span></code></pre></div><pre><code>Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-labels-idx1-ubyte.gz
32768/29515 [=================================] - 0s 0us/step
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-images-idx3-ubyte.gz
26427392/26421880 [==============================] - 2s 0us/step
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-labels-idx1-ubyte.gz
8192/5148 [===============================================] - 0s 0us/step
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-images-idx3-ubyte.gz
4423680/4422102 [==============================] - 0s 0us/step
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>class_names <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;T-shirt/top&#39;</span>, <span style=color:#e6db74>&#39;Trouser&#39;</span>, <span style=color:#e6db74>&#39;Pullover&#39;</span>, <span style=color:#e6db74>&#39;Dress&#39;</span>, <span style=color:#e6db74>&#39;Coat&#39;</span>,
</span></span><span style=display:flex><span>               <span style=color:#e6db74>&#39;Sandal&#39;</span>, <span style=color:#e6db74>&#39;Shirt&#39;</span>, <span style=color:#e6db74>&#39;Sneaker&#39;</span>, <span style=color:#e6db74>&#39;Bag&#39;</span>, <span style=color:#e6db74>&#39;Ankle boot&#39;</span>]
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure()
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>imshow(train_images[<span style=color:#ae81ff>3</span>])
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>colorbar()
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><img src=http://my-blog-content.s3.amazonaws.com/2019/05/keras-hello-world-fashion/2019-05-13--keras-hello-world-fashion_3_0.png><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Hmm so this `cmap=plt.cm.binary` kwarg displays grayscale instead of that strange purple to yellow scale.</span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure()
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>imshow(train_images[<span style=color:#ae81ff>3</span>]<span style=color:#f92672>/</span><span style=color:#ae81ff>255.0</span>, cmap<span style=color:#f92672>=</span>plt<span style=color:#f92672>.</span>cm<span style=color:#f92672>.</span>binary)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>colorbar()
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><img src=http://my-blog-content.s3.amazonaws.com/2019/05/keras-hello-world-fashion/2019-05-13--keras-hello-world-fashion_4_0.png><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># This is almost like the output of a TSA luggage xray scanner </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>10</span>))
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>25</span>):
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>subplot(<span style=color:#ae81ff>5</span>,<span style=color:#ae81ff>5</span>,i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>xticks([])
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>yticks([])
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>imshow(train_images[i]) <span style=color:#75715e># , cmap=plt.cm.binary</span>
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>xlabel(class_names[train_labels[i]])
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><img src=http://my-blog-content.s3.amazonaws.com/2019/05/keras-hello-world-fashion/2019-05-13--keras-hello-world-fashion_5_0.png><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>train_images_scaled <span style=color:#f92672>=</span> train_images <span style=color:#f92672>/</span> <span style=color:#ae81ff>255.0</span>
</span></span><span style=display:flex><span>test_images_scaled <span style=color:#f92672>=</span> test_images <span style=color:#f92672>/</span> <span style=color:#ae81ff>255.0</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>model <span style=color:#f92672>=</span> keras<span style=color:#f92672>.</span>Sequential([
</span></span><span style=display:flex><span>    keras<span style=color:#f92672>.</span>layers<span style=color:#f92672>.</span>Flatten(input_shape<span style=color:#f92672>=</span>(<span style=color:#ae81ff>28</span>, <span style=color:#ae81ff>28</span>)),
</span></span><span style=display:flex><span>    keras<span style=color:#f92672>.</span>layers<span style=color:#f92672>.</span>Dense(<span style=color:#ae81ff>128</span>, activation<span style=color:#f92672>=</span>tf<span style=color:#f92672>.</span>nn<span style=color:#f92672>.</span>relu),
</span></span><span style=display:flex><span>    keras<span style=color:#f92672>.</span>layers<span style=color:#f92672>.</span>Dense(<span style=color:#ae81ff>10</span>, activation<span style=color:#f92672>=</span>tf<span style=color:#f92672>.</span>nn<span style=color:#f92672>.</span>softmax)
</span></span><span style=display:flex><span>])
</span></span></code></pre></div><pre><code>WARNING:tensorflow:From /usr/local/miniconda3/envs/pandars3/lib/python3.7/site-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>model<span style=color:#f92672>.</span>compile(optimizer<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;adam&#39;</span>, 
</span></span><span style=display:flex><span>              loss<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;sparse_categorical_crossentropy&#39;</span>,
</span></span><span style=display:flex><span>              metrics<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;accuracy&#39;</span>])
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Looking at the use of the non-scaled data first.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Wow that looks like terrible accuracy.</span>
</span></span><span style=display:flex><span>model<span style=color:#f92672>.</span>fit(train_images, train_labels, epochs<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>)
</span></span></code></pre></div><pre><code>Epoch 1/5
60000/60000 [==============================] - 4s 70us/sample - loss: 14.5146 - acc: 0.0995
Epoch 2/5
60000/60000 [==============================] - 4s 66us/sample - loss: 13.7328 - acc: 0.1479
Epoch 3/5
60000/60000 [==============================] - 4s 66us/sample - loss: 13.0450 - acc: 0.1906
Epoch 4/5
60000/60000 [==============================] - 4s 66us/sample - loss: 13.0474 - acc: 0.1905
Epoch 5/5
60000/60000 [==============================] - 4s 68us/sample - loss: 12.9979 - acc: 0.1936





&lt;tensorflow.python.keras.callbacks.History at 0x139540978&gt;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Yea if that is out of 1.0 then this 0.1917 is pretty low</span>
</span></span><span style=display:flex><span>test_loss, test_acc <span style=color:#f92672>=</span> model<span style=color:#f92672>.</span>evaluate(test_images, test_labels)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;Test accuracy:&#39;</span>, test_acc)
</span></span></code></pre></div><pre><code>10000/10000 [==============================] - 0s 26us/sample - loss: 13.0283 - acc: 0.1917
Test accuracy: 0.1917
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Try on that scaled data now ..</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Okay this looks better. more like the result in the tutorial.</span>
</span></span><span style=display:flex><span>model<span style=color:#f92672>.</span>fit(train_images_scaled, train_labels, epochs<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>)
</span></span></code></pre></div><pre><code>Epoch 1/5
60000/60000 [==============================] - 4s 68us/sample - loss: 0.5902 - acc: 0.8182
Epoch 2/5
60000/60000 [==============================] - 4s 66us/sample - loss: 0.3900 - acc: 0.8622
Epoch 3/5
60000/60000 [==============================] - 4s 67us/sample - loss: 0.3526 - acc: 0.8739
Epoch 4/5
60000/60000 [==============================] - 4s 66us/sample - loss: 0.3319 - acc: 0.8788
Epoch 5/5
60000/60000 [==============================] - 4s 66us/sample - loss: 0.3141 - acc: 0.8858





&lt;tensorflow.python.keras.callbacks.History at 0x1424e8fd0&gt;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>model<span style=color:#f92672>.</span>input_shape, model<span style=color:#f92672>.</span>output_shape
</span></span></code></pre></div><pre><code>((None, 28, 28), (None, 10))
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>model<span style=color:#f92672>.</span>weights
</span></span></code></pre></div><pre><code>[&lt;tf.Variable 'dense/kernel:0' shape=(784, 128) dtype=float32&gt;,
 &lt;tf.Variable 'dense/bias:0' shape=(128,) dtype=float32&gt;,
 &lt;tf.Variable 'dense_1/kernel:0' shape=(128, 10) dtype=float32&gt;,
 &lt;tf.Variable 'dense_1/bias:0' shape=(10,) dtype=float32&gt;]
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>test_loss, test_acc <span style=color:#f92672>=</span> model<span style=color:#f92672>.</span>evaluate(test_images_scaled, test_labels)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;Test accuracy:&#39;</span>, test_acc)
</span></span></code></pre></div><pre><code>10000/10000 [==============================] - 0s 34us/sample - loss: 0.3489 - acc: 0.8740
Test accuracy: 0.874
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>predictions <span style=color:#f92672>=</span> model<span style=color:#f92672>.</span>predict(test_images_scaled)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>predictions[<span style=color:#ae81ff>0</span>], test_labels[<span style=color:#ae81ff>0</span>]
</span></span></code></pre></div><pre><code>(array([1.3787793e-05, 5.9650089e-09, 1.9482790e-07, 1.8630770e-09,
        3.6141572e-07, 3.6579393e-02, 1.0138750e-05, 1.5758899e-01,
        1.9775856e-04, 8.0560941e-01], dtype=float32), 9)
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>plot_image</span>(i, predictions_array, true_label, img):
</span></span><span style=display:flex><span>  predictions_array, true_label, img <span style=color:#f92672>=</span> predictions_array[i], true_label[i], img[i]
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>xticks([])
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>yticks([])
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>imshow(img, cmap<span style=color:#f92672>=</span>plt<span style=color:#f92672>.</span>cm<span style=color:#f92672>.</span>binary)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  predicted_label <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>argmax(predictions_array)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> predicted_label <span style=color:#f92672>==</span> true_label:
</span></span><span style=display:flex><span>    color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;blue&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>    color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;red&#39;</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>xlabel(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{}</span><span style=color:#e6db74> </span><span style=color:#e6db74>{:2.0f}</span><span style=color:#e6db74>% (</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>)&#34;</span><span style=color:#f92672>.</span>format(class_names[predicted_label],
</span></span><span style=display:flex><span>                                <span style=color:#ae81ff>100</span><span style=color:#f92672>*</span>np<span style=color:#f92672>.</span>max(predictions_array),
</span></span><span style=display:flex><span>                                class_names[true_label]),
</span></span><span style=display:flex><span>                                color<span style=color:#f92672>=</span>color)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>plot_value_array</span>(i, predictions_array, true_label):
</span></span><span style=display:flex><span>  predictions_array, true_label <span style=color:#f92672>=</span> predictions_array[i], true_label[i]
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>xticks([])
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>yticks([])
</span></span><span style=display:flex><span>  thisplot <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>bar(range(<span style=color:#ae81ff>10</span>), predictions_array, color<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#777777&#34;</span>)
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>ylim([<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>]) 
</span></span><span style=display:flex><span>  predicted_label <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>argmax(predictions_array)
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  thisplot[predicted_label]<span style=color:#f92672>.</span>set_color(<span style=color:#e6db74>&#39;red&#39;</span>)
</span></span><span style=display:flex><span>  thisplot[true_label]<span style=color:#f92672>.</span>set_color(<span style=color:#e6db74>&#39;blue&#39;</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>6</span>,<span style=color:#ae81ff>3</span>))
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>subplot(<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>plot_image(i, predictions, test_labels, test_images)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>subplot(<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>plot_value_array(i, predictions,  test_labels)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><img src=http://my-blog-content.s3.amazonaws.com/2019/05/keras-hello-world-fashion/2019-05-13--keras-hello-world-fashion_18_0.png><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>thisplot <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>bar(range(<span style=color:#ae81ff>5</span>), [<span style=color:#ae81ff>.1</span>, <span style=color:#ae81ff>.2</span>, <span style=color:#ae81ff>.3</span>, <span style=color:#ae81ff>.4</span>, <span style=color:#ae81ff>.9</span>], color<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#777777&#34;</span>)
</span></span><span style=display:flex><span>thisplot[<span style=color:#ae81ff>2</span>]<span style=color:#f92672>.</span>set_color(<span style=color:#e6db74>&#39;orange&#39;</span>)
</span></span></code></pre></div><img src=http://my-blog-content.s3.amazonaws.com/2019/05/keras-hello-world-fashion/2019-05-13--keras-hello-world-fashion_19_0.png><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Plot the first X test images, their predicted label, and the true label</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Color correct predictions in blue, incorrect predictions in red</span>
</span></span><span style=display:flex><span>num_rows <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>num_cols <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>num_images <span style=color:#f92672>=</span> num_rows<span style=color:#f92672>*</span>num_cols
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>num_cols, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>num_rows))
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(num_images):
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>subplot(num_rows, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>num_cols, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>  plot_image(i, predictions, test_labels, test_images)
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>subplot(num_rows, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>num_cols, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>i<span style=color:#f92672>+</span><span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>  plot_value_array(i, predictions, test_labels)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><img src=http://my-blog-content.s3.amazonaws.com/2019/05/keras-hello-world-fashion/2019-05-13--keras-hello-world-fashion_20_0.png><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># For fun, I want to try and run the model on my own hand drawn images.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Raw im</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> IPython.display <span style=color:#66d9ef>as</span> ipd <span style=color:#75715e># import Image</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># These four pngs were created w/ Adobe sketchbook</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Then I manually cropped them with macOS Preview to make sure they are squares.</span>
</span></span><span style=display:flex><span>rawnames <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;2019-05-13 14.29.04.png&#39;</span>,
</span></span><span style=display:flex><span>                 <span style=color:#e6db74>&#39;2019-05-13 14.30.20.png&#39;</span>,
</span></span><span style=display:flex><span>                 <span style=color:#e6db74>&#39;2019-05-13 14.31.18.png&#39;</span>,
</span></span><span style=display:flex><span>                 <span style=color:#e6db74>&#39;2019-05-13 14.32.27.png&#39;</span>]
</span></span><span style=display:flex><span>filenames <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;keras-fashion-helloworld/myimages-originals/&#39;</span> <span style=color:#f92672>+</span> x
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> rawnames
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[ipd<span style=color:#f92672>.</span>display(ipd<span style=color:#f92672>.</span>Image(filename<span style=color:#f92672>=</span>fn))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> fn <span style=color:#f92672>in</span> filenames]
</span></span><span style=display:flex><span><span style=color:#75715e># ipd.Image(filename=&#39;keras-fashion-helloworld/myimages-originals/2019-05-13 14.29.04--8.png&#39;)</span>
</span></span></code></pre></div><img src=http://my-blog-content.s3.amazonaws.com/2019/05/keras-hello-world-fashion/2019-05-13--keras-hello-world-fashion_22_0.png width=10%>
<img src=http://my-blog-content.s3.amazonaws.com/2019/05/keras-hello-world-fashion/2019-05-13--keras-hello-world-fashion_22_1.png width=10%>
<img src=http://my-blog-content.s3.amazonaws.com/2019/05/keras-hello-world-fashion/2019-05-13--keras-hello-world-fashion_22_2.png width=10%>
<img src=http://my-blog-content.s3.amazonaws.com/2019/05/keras-hello-world-fashion/2019-05-13--keras-hello-world-fashion_22_3.png width=10%><pre><code>[None, None, None, None]
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># with the help of PIL, obtained with `pip install Pillow`</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> PIL <span style=color:#f92672>import</span> Image
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>extract_vec</span>(img):
</span></span><span style=display:flex><span>    <span style=color:#75715e># re-scale to 28x28 in place</span>
</span></span><span style=display:flex><span>    img<span style=color:#f92672>.</span>thumbnail((<span style=color:#ae81ff>28</span>, <span style=color:#ae81ff>28</span>), Image<span style=color:#f92672>.</span>ANTIALIAS)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    values <span style=color:#f92672>=</span> list(img<span style=color:#f92672>.</span>getdata())
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    pixels <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([x[<span style=color:#ae81ff>0</span>] <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> values])
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> np<span style=color:#f92672>.</span>resize(pixels, (<span style=color:#ae81ff>28</span>, <span style=color:#ae81ff>28</span>))
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># quick example of first image, </span>
</span></span><span style=display:flex><span>print(extract_vec(Image<span style=color:#f92672>.</span>open(filenames[<span style=color:#ae81ff>0</span>])))
</span></span></code></pre></div><pre><code>[[254 250 240 238 242 255 255 252 247 232 226 226 228 229 228 229 228 234
  244 246 245 247 248 255 255 254 255 255]
 [244 223 195 187 170 143 137 141 139 155 172 171 185 194 190 186 183 189
  121 101 110 113 104 147 205 242 249 255]
 [226 195 148  86  26  13  29  52  65  78  71  89 103 114 115 104  92  74
   61  99 103  99  82  58  67 148 224 248]
 [202 117  52  47  53  61  86  88  91  96  91  84  79  79  75  74  78  71
  111 120 122 129 115  99  94  79 109 218]
 [104  59  84  97  67  56  54  50  65  68  72  82  89  94  93  97 115 109
  125 115  92  94  82  69  70  89  89 112]
 [ 89 139 127  79  58  53  61  48  55  63  52  51  59  63  64  69  79  86
  110 119  91  75  79  71  69  72 110 138]
 [159  77 115 106  76  68  74  57  53  55  40  41  52  58  57  60  65  68
   88 101  97 100  92  84  94  98 107 117]
 [213 149  62 100  97  76  70  58  61  84  80  43  56  67  62  53  60  55
   57  70  94 108 107 112 107 119  90 148]
 [216 198 126  43 102 100  62  69  84  88 102  59  57  68  58  55  64  66
   64  61  88  98 104 137 131  99 115 179]
 [248 226 208 110  61  62  47  55  86  69  55  57  64  67  57  49  67  82
   76  66  87  87  67 106 129 108 169 199]
 [255 254 249 214  51  89 159  94  69  57  43  45  58  53  37  33  44  48
   51  50  68  74 125 158  71 130 212 231]
 [255 255 255 255 212 165 223  91  51  45  42  39  40  39  45  47  37  41
   42  41  58  63 136 235 209 200 236 252]
 [255 255 255 255 255 242 189  69  53  59  52  37  27  35  58  59  47  45
   36  34  55  60 139 237 242 248 252 254]
 [255 255 255 254 254 247 157  61  71  76  60  33  26  27  42  55  58  45
   36  32  55  62 130 245 252 254 254 255]
 [255 255 255 254 255 237 154  67  79  64  46  28  16  18  36  52  48  36
   29  37  58  56 114 240 255 254 255 255]
 [255 255 255 254 255 245 162  67  62  52  40  24  12  11  24  36  33  23
   25  32  52  58 113 232 255 255 255 255]
 [255 255 255 255 255 249 185  70  47  37  33  30  20  12  12  19  17  13
   17  23  50  56 106 227 254 255 255 255]
 [255 255 255 255 255 252 192  77  49  38  33  31  18   9   6  10  12   9
   11  22  56  52  98 219 250 255 255 255]
 [255 255 255 255 255 254 212  86  53  38  38  34  14   5   5   8   7   7
   14  25  59  58  77 209 247 255 255 255]
 [255 255 255 255 254 255 248 119  35  23  24  21  11   5   6  10  10  11
   16  35  72  69  62 205 251 255 255 255]
 [255 255 255 255 255 253 255 155  37  23  10   9   7   6  12  17  14  12
   20  45  73  65  67 205 251 255 255 255]
 [255 255 255 255 255 254 255 155  53  43  25  23  19  17  23  27  19  20
   27  47  76  78  73 208 252 255 255 255]
 [255 255 255 255 254 255 245 152  73  64  33  29  28  31  44  43  33  36
   43  57  78  89  75 216 254 255 255 255]
 [255 255 255 255 255 255 239 155  68  76  41  26  25  45  62  63  49  51
   63  76  92  97  79 211 252 255 255 255]
 [255 255 255 255 255 255 239 159  69  75  55  32  36  57  69  72  64  63
   82  94 114 116  99 223 251 255 255 255]
 [255 255 255 255 255 255 240 165  89 103  71  52  60  74  75  76  80  88
  124 134 134 143 114 233 252 255 255 255]
 [255 255 255 255 255 255 253 184  85 107  82  68  74  93  94  91  93 109
  149 163 137 102  79 239 255 254 255 255]
 [255 255 255 255 255 255 255 235 175 138 106  93  84  81  78  71  71  75
   91 102 125 155 175 255 254 255 255 255]]
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>filenames[<span style=color:#ae81ff>0</span>]
</span></span></code></pre></div><pre><code>'keras-fashion-helloworld/myimages-originals/2019-05-13 14.29.04.png'
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># </span>
</span></span><span style=display:flex><span>my_clothing_vecs <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([extract_vec(Image<span style=color:#f92672>.</span>open(fn)) <span style=color:#66d9ef>for</span> fn <span style=color:#f92672>in</span> filenames])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># and so lets try and display them with matplot lib again like the provided images...</span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>10</span>))
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(my_clothing_vecs)):
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>subplot(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>xticks([])
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>yticks([])
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>imshow(my_clothing_vecs[i]) <span style=color:#75715e># , cmap=plt.cm.binary</span>
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>xlabel(rawnames[i])
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><img src=http://my-blog-content.s3.amazonaws.com/2019/05/keras-hello-world-fashion/2019-05-13--keras-hello-world-fashion_26_0.png><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>my_clothing_vecs<span style=color:#f92672>.</span>shape
</span></span></code></pre></div><pre><code>(4, 28, 28)
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Ah crap, this looks inverted compared to what I see in the tutorial. </span>
</span></span><span style=display:flex><span><span style=color:#75715e># Going to attempt to invert that real quick...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>invert255 <span style=color:#f92672>=</span> <span style=color:#66d9ef>lambda</span> x: abs(<span style=color:#ae81ff>255</span> <span style=color:#f92672>-</span> x) 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>invert_many</span>(img_vec):
</span></span><span style=display:flex><span>    input_shape <span style=color:#f92672>=</span> img_vec<span style=color:#f92672>.</span>shape
</span></span><span style=display:flex><span>    length <span style=color:#f92672>=</span> input_shape[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> input_shape[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    invert_pxl <span style=color:#f92672>=</span> <span style=color:#66d9ef>lambda</span> x: abs(<span style=color:#ae81ff>255</span> <span style=color:#f92672>-</span> x) 
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> np<span style=color:#f92672>.</span>resize(
</span></span><span style=display:flex><span>        [invert_pxl(x)
</span></span><span style=display:flex><span>         <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> np<span style=color:#f92672>.</span>resize(img_vec, (<span style=color:#ae81ff>1</span>, length))],
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>                     input_shape)
</span></span><span style=display:flex><span>    
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># invert them all</span>
</span></span><span style=display:flex><span>clothing_vecs_inverted <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>vectorize(invert255)(my_clothing_vecs)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>my_clothing_vecs<span style=color:#f92672>.</span>shape, clothing_vecs_inverted<span style=color:#f92672>.</span>shape
</span></span></code></pre></div><pre><code>((4, 28, 28), (4, 28, 28))
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Okay cool... now this looks like the other earlier data.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>10</span>))
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(clothing_vecs_inverted)):
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>subplot(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>xticks([])
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>yticks([])
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>imshow(clothing_vecs_inverted[i]) <span style=color:#75715e># , cmap=plt.cm.binary</span>
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>xlabel(rawnames[i])
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><img src=http://my-blog-content.s3.amazonaws.com/2019/05/keras-hello-world-fashion/2019-05-13--keras-hello-world-fashion_31_0.png><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Now lets see what the predictions say</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># First the scaling...</span>
</span></span><span style=display:flex><span>my_scaled_and_inverted <span style=color:#f92672>=</span> clothing_vecs_inverted<span style=color:#f92672>/</span><span style=color:#ae81ff>255.0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>newpredictions <span style=color:#f92672>=</span> model<span style=color:#f92672>.</span>predict(my_scaled_and_inverted)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>print(list(enumerate(class_names)))
</span></span></code></pre></div><pre><code>[(0, 'T-shirt/top'), (1, 'Trouser'), (2, 'Pullover'), (3, 'Dress'), (4, 'Coat'), (5, 'Sandal'), (6, 'Shirt'), (7, 'Sneaker'), (8, 'Bag'), (9, 'Ankle boot')]
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>my_test_labels <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>])
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>newpredictions
</span></span></code></pre></div><pre><code>array([[4.26309437e-01, 2.92650770e-06, 1.60550058e-04, 9.47394001e-04,
        1.30431754e-05, 1.05808425e-07, 5.70735812e-01, 5.16380161e-10,
        1.83065375e-03, 7.26391747e-09],
       [2.88550858e-03, 3.26211921e-05, 8.07017728e-04, 7.98632973e-05,
        3.09603085e-04, 7.77611732e-01, 1.04915572e-03, 1.50996149e-01,
        6.37709629e-03, 5.98511957e-02],
       [1.78965013e-02, 8.74079406e-01, 4.85132486e-02, 3.52283381e-03,
        3.91321108e-02, 1.26371131e-04, 1.65334735e-02, 1.32581690e-07,
        1.95919056e-04, 2.40851268e-08],
       [6.74940348e-02, 6.74244831e-04, 7.51323474e-04, 2.22629853e-04,
        3.27958390e-02, 3.78045649e-03, 6.39505684e-01, 7.55926128e-04,
        1.57964438e-01, 9.60554630e-02]], dtype=float32)
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Plot the first X test images, their predicted label, and the true label</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Color correct predictions in blue, incorrect predictions in red</span>
</span></span><span style=display:flex><span>num_rows <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>num_cols <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>num_images <span style=color:#f92672>=</span> num_rows<span style=color:#f92672>*</span>num_cols
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>num_cols, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>num_rows))
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(num_images):
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>subplot(num_rows, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>num_cols, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>  plot_image(i, newpredictions, my_test_labels, my_scaled_and_inverted)
</span></span><span style=display:flex><span>  plt<span style=color:#f92672>.</span>subplot(num_rows, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>num_cols, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>i<span style=color:#f92672>+</span><span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>  plot_value_array(i, newpredictions, my_test_labels)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><img src=http://my-blog-content.s3.amazonaws.com/2019/05/keras-hello-world-fashion/2019-05-13--keras-hello-world-fashion_36_0.png><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Wow, that looks pretty good. </span>
</span></span><span style=display:flex><span><span style=color:#75715e># - Haha apparently the Tshirt I drew looks a bit more like a &#34;Shirt&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - And my coat looks like a &#34;Shirt&#34; . Of course that was expected. I have no idea how that distinction </span>
</span></span><span style=display:flex><span><span style=color:#75715e>#     is captured by the model</span>
</span></span><span style=display:flex><span><span style=color:#75715e># - And yea, my sneaker looks kind of like a sandal? Okay makes sense. </span>
</span></span></code></pre></div><ul class=pa0></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://michal.piekarczyk.xyz/>&copy; My blog 2022</a><div></div></div></footer></body></html>