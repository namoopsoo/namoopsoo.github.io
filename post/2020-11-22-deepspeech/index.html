<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Quick test drive this Mozilla/Baidu Deep Speech | michal.piekarczyk.xyz</title><meta name=keywords content><meta name=description content="Summary Ok managed to get DeepSpeech to run, but the output for my voice maybe does not translate to any text that makes sense hahaha. But it was pretty funny to read the interpretation.
My recording was in m4a so I had to change over to wav first ffmpeg is good for m4a to wav conversion but my ffmpeg is having some issues. (deep3) $ ffmpeg dyld: Library not loaded: /usr/local/opt/openssl/lib/libssl."><meta name=author content="Michal Piekarczyk"><link rel=canonical href=https://michal.piekarczyk.xyz/post/2020-11-22-deepspeech/><link crossorigin=anonymous href=/assets/css/stylesheet.4c73b1b942ee612f2f6a56636bd60cf62223b2cdb42d501875d67bb952acf3c0.css integrity="sha256-THOxuULuYS8valZja9YM9iIjss20LVAYddZ7uVKs88A=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://michal.piekarczyk.xyz/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://michal.piekarczyk.xyz/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://michal.piekarczyk.xyz/favicon-32x32.png><link rel=apple-touch-icon href=https://michal.piekarczyk.xyz/apple-touch-icon.png><link rel=mask-icon href=https://michal.piekarczyk.xyz/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-86TSXEXWB5"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-86TSXEXWB5",{anonymize_ip:!1})}</script><meta property="og:title" content="Quick test drive this Mozilla/Baidu Deep Speech"><meta property="og:description" content="Summary Ok managed to get DeepSpeech to run, but the output for my voice maybe does not translate to any text that makes sense hahaha. But it was pretty funny to read the interpretation.
My recording was in m4a so I had to change over to wav first ffmpeg is good for m4a to wav conversion but my ffmpeg is having some issues. (deep3) $ ffmpeg dyld: Library not loaded: /usr/local/opt/openssl/lib/libssl."><meta property="og:type" content="article"><meta property="og:url" content="https://michal.piekarczyk.xyz/post/2020-11-22-deepspeech/"><meta property="article:section" content="post"><meta property="article:published_time" content="2020-11-22T00:00:00+00:00"><meta property="article:modified_time" content="2020-11-22T00:00:00+00:00"><meta property="og:site_name" content="michal.piekarczyk.xyz"><meta name=twitter:card content="summary"><meta name=twitter:title content="Quick test drive this Mozilla/Baidu Deep Speech"><meta name=twitter:description content="Summary Ok managed to get DeepSpeech to run, but the output for my voice maybe does not translate to any text that makes sense hahaha. But it was pretty funny to read the interpretation.
My recording was in m4a so I had to change over to wav first ffmpeg is good for m4a to wav conversion but my ffmpeg is having some issues. (deep3) $ ffmpeg dyld: Library not loaded: /usr/local/opt/openssl/lib/libssl."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://michal.piekarczyk.xyz/post/"},{"@type":"ListItem","position":2,"name":"Quick test drive this Mozilla/Baidu Deep Speech","item":"https://michal.piekarczyk.xyz/post/2020-11-22-deepspeech/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Quick test drive this Mozilla/Baidu Deep Speech","name":"Quick test drive this Mozilla\/Baidu Deep Speech","description":"Summary Ok managed to get DeepSpeech to run, but the output for my voice maybe does not translate to any text that makes sense hahaha. But it was pretty funny to read the interpretation.\nMy recording was in m4a so I had to change over to wav first ffmpeg is good for m4a to wav conversion but my ffmpeg is having some issues. (deep3) $ ffmpeg dyld: Library not loaded: /usr/local/opt/openssl/lib/libssl.","keywords":[],"articleBody":"Summary Ok managed to get DeepSpeech to run, but the output for my voice maybe does not translate to any text that makes sense hahaha. But it was pretty funny to read the interpretation.\nMy recording was in m4a so I had to change over to wav first ffmpeg is good for m4a to wav conversion but my ffmpeg is having some issues. (deep3) $ ffmpeg dyld: Library not loaded: /usr/local/opt/openssl/lib/libssl.1.0.0.dylib Referenced from: /usr/local/bin/ffmpeg Reason: image not found Abort trap: 6 (deep3) $ I ran brew update Then $ brew upgrade ffmpeg ... ==\u003e Upgrading 1 outdated package: ffmpeg 4.1.1 -\u003e 4.3.1_4 ==\u003e Upgrading ffmpeg 4.1.1 -\u003e 4.3.1_4 ... That worked but I saw this at the end , so I did that ... Error: Xcode alone is not sufficient on Mojave. Install the Command Line Tools: xcode-select --install Still getting.. $ ffmpeg dyld: Library not loaded: /usr/local/opt/openssl/lib/libssl.1.0.0.dylib Referenced from: /usr/local/bin/ffmpeg Reason: image not found Abort trap: 6 ok thank the ages, this stackoverflow helped a lot !! $ brew switch openssl 1.0.2s Error: openssl does not have a version \"1.0.2s\" in the Cellar. openssl's installed versions: 1.0.2q $ brew switch openssl 1.0.2q Cleaning /usr/local/Cellar/openssl/1.0.2q Opt link created for /usr/local/Cellar/openssl/1.0.2q $ ffmpeg ffmpeg version 4.1.1 Copyright (c) 2000-2019 the FFmpeg developers built with Apple LLVM version 10.0.0 (clang-1000.11.45.5) ... These instructions are pretty clear to get setup w/ deepspeech Starting page and the readthedocs I created a separate environment for this with conda create -n deep3 and source activate deep3 # Install DeepSpeech pip install deepspeech # Download pre-trained English model files curl -LO https://github.com/mozilla/DeepSpeech/releases/download/v0.9.1/deepspeech-0.9.1-models.pbmm curl -LO https://github.com/mozilla/DeepSpeech/releases/download/v0.9.1/deepspeech-0.9.1-models.scorer # Download example audio files curl -LO https://github.com/mozilla/DeepSpeech/releases/download/v0.9.1/audio-0.9.1.tar.gz tar xvf audio-0.9.1.tar.gz # Transcribe an audio file deepspeech --model deepspeech-0.9.1-models.pbmm --scorer deepspeech-0.9.1-models.scorer --audio audio/2830-3980-0043.wav Loading model from file deepspeech-0.9.1-models.pbmm TensorFlow: v2.3.0-6-g23ad988fcd DeepSpeech: v0.9.1-0-gab8bd3e1 Loaded model in 0.0486s. Loading scorer from files deepspeech-0.9.1-models.scorer Loaded scorer in 0.00625s. Running inference. experience proves this Inference took 5.095s for 1.975s audio file. That mini sample worked fine.. “experience proves this” is 100% accurate according to my ears at least. I Read Some tips on the conversion Ok cool according to here I can use ffmpeg to convert from m4a to wav with just ffmpeg -i blah.m4a blah.wav But I tried deepspeech on my wav file deepspeech --model deepspeech-0.9.1-models.pbmm --scorer deepspeech-0.9.1-models.scorer --audio blah.wav Loading model from file deepspeech-0.9.1-models.pbmm TensorFlow: v2.3.0-6-g23ad988fcd DeepSpeech: v0.9.1-0-gab8bd3e1 Loaded model in 0.0648s. Loading scorer from files deepspeech-0.9.1-models.scorer Loaded scorer in 0.00534s. Warning: original sample rate (24000) is different than 16000hz. Resampling might produce erratic speech recognition. Then the sox program for resampling not present… I read Some notes on resampling here and finding that ffmpeg has sox built in now. workdir=/blah/my/workdir infile=${workdir}/2020-11-22-09.54.59.wav outfile=${workdir}/2020-11-22-09.54.59--resampled.wav ffmpeg -i $infile -af aresample=resampler=soxr -ar 16000 $outfile deepspeech --model deepspeech-0.9.1-models.pbmm --scorer deepspeech-0.9.1-models.scorer --audio $outfile Ok hahaha this time after resampling to 16000Hz finally worked, but the output does not match any kind of reality haha. Loading model from file deepspeech-0.9.1-models.pbmm TensorFlow: v2.3.0-6-g23ad988fcd DeepSpeech: v0.9.1-0-gab8bd3e1 Loaded model in 0.0451s. Loading scorer from files deepspeech-0.9.1-models.scorer Loaded scorer in 0.00534s. Running inference. so then listened and even interesting it interesting idea for talking about the habitation main point is a paradise his crimes and the periostracum basically like ours person wrote his book or started this is to other thinking harrison article or are frontiersman like a loathing at the summer sententiam first creation antoinette to mitigate they had had been important role spoke for catering people is catching people attention and then destournier take nineteen and working on the antithetic aeternitate which takes a attakapas Inference took 65.434s for 114.816s audio file. Other notes Maybe strategies like this one ","wordCount":"607","inLanguage":"en","datePublished":"2020-11-22T00:00:00Z","dateModified":"2020-11-22T00:00:00Z","author":{"@type":"Person","name":"Michal Piekarczyk"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://michal.piekarczyk.xyz/post/2020-11-22-deepspeech/"},"publisher":{"@type":"Organization","name":"michal.piekarczyk.xyz","logo":{"@type":"ImageObject","url":"https://michal.piekarczyk.xyz/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://michal.piekarczyk.xyz/ accesskey=h title="michal.piekarczyk.xyz (Alt + H)">michal.piekarczyk.xyz</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://michal.piekarczyk.xyz/post/ title=posts><span>posts</span></a></li><li><a href=https://michal.piekarczyk.xyz/project/ title=projects><span>projects</span></a></li><li><a href=https://michal.piekarczyk.xyz/handy/ title=handy><span>handy</span></a></li><li><a href=https://michal.piekarczyk.xyz/tags/ title=tags><span>tags</span></a></li><li><a href=https://michal.piekarczyk.xyz/about/ title=about><span>about</span></a></li><li><a href=https://world.hey.com/michal.piekarczyk title=frivolity><span>frivolity</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://michal.piekarczyk.xyz/>Home</a>&nbsp;»&nbsp;<a href=https://michal.piekarczyk.xyz/post/>Posts</a></div><h1 class=post-title>Quick test drive this Mozilla/Baidu Deep Speech</h1><div class=post-meta><span title='2020-11-22 00:00:00 +0000 UTC'>222222-22-2212</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;607 words&nbsp;·&nbsp;Michal Piekarczyk</div></header><div class=post-content><h4 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>#</a></h4><p>Ok managed to get <a href=https://github.com/mozilla/DeepSpeech>DeepSpeech</a> to run, but the output for my voice maybe does not translate to any text that makes sense hahaha. But it was pretty funny to read the interpretation.</p><h4 id=my-recording-was-in-m4a-so-i-had-to-change-over-to-wav-first>My recording was in m4a so I had to change over to wav first<a hidden class=anchor aria-hidden=true href=#my-recording-was-in-m4a-so-i-had-to-change-over-to-wav-first>#</a></h4><ul><li>ffmpeg is good for m4a to wav conversion but my <code>ffmpeg</code> is having some issues.</li></ul><pre tabindex=0><code>(deep3) $ ffmpeg
dyld: Library not loaded: /usr/local/opt/openssl/lib/libssl.1.0.0.dylib
  Referenced from: /usr/local/bin/ffmpeg
  Reason: image not found
Abort trap: 6
(deep3) $
</code></pre><ul><li>I ran <code>brew update</code></li><li>Then</li></ul><pre tabindex=0><code>$ brew upgrade ffmpeg
...
==&gt; Upgrading 1 outdated package:
ffmpeg 4.1.1 -&gt; 4.3.1_4
==&gt; Upgrading ffmpeg 4.1.1 -&gt; 4.3.1_4
...
</code></pre><ul><li>That worked but I saw this at the end , so I did that</li></ul><pre tabindex=0><code>...
Error: Xcode alone is not sufficient on Mojave.
Install the Command Line Tools:
  xcode-select --install
</code></pre><ul><li>Still getting..</li></ul><pre tabindex=0><code>$ ffmpeg
dyld: Library not loaded: /usr/local/opt/openssl/lib/libssl.1.0.0.dylib
  Referenced from: /usr/local/bin/ffmpeg
  Reason: image not found
Abort trap: 6
</code></pre><ul><li>ok thank the ages, <a href=https://stackoverflow.com/questions/59006602/dyld-library-not-loaded-usr-local-opt-openssl-lib-libssl-1-0-0-dylib>this stackoverflow</a> helped a lot !!</li></ul><pre tabindex=0><code>$ brew switch openssl 1.0.2s
Error: openssl does not have a version &#34;1.0.2s&#34; in the Cellar.
openssl&#39;s installed versions: 1.0.2q
$ brew switch openssl 1.0.2q
Cleaning /usr/local/Cellar/openssl/1.0.2q
Opt link created for /usr/local/Cellar/openssl/1.0.2q
$ ffmpeg
ffmpeg version 4.1.1 Copyright (c) 2000-2019 the FFmpeg developers
  built with Apple LLVM version 10.0.0 (clang-1000.11.45.5)
...
</code></pre><h4 id=these-instructions-are-pretty-clear-to-get-setup-w-deepspeech>These instructions are pretty clear to get setup w/ deepspeech<a hidden class=anchor aria-hidden=true href=#these-instructions-are-pretty-clear-to-get-setup-w-deepspeech>#</a></h4><ul><li><a href=https://github.com/mozilla/DeepSpeech>Starting page</a> and the <a href="https://deepspeech.readthedocs.io/en/v0.9.1/?badge=latest">readthedocs</a></li><li>I created a separate environment for this with <code>conda create -n deep3</code> and <code>source activate deep3</code></li></ul><pre tabindex=0><code># Install DeepSpeech
pip install deepspeech

# Download pre-trained English model files
curl -LO https://github.com/mozilla/DeepSpeech/releases/download/v0.9.1/deepspeech-0.9.1-models.pbmm
curl -LO https://github.com/mozilla/DeepSpeech/releases/download/v0.9.1/deepspeech-0.9.1-models.scorer

# Download example audio files
curl -LO https://github.com/mozilla/DeepSpeech/releases/download/v0.9.1/audio-0.9.1.tar.gz
tar xvf audio-0.9.1.tar.gz

# Transcribe an audio file
deepspeech --model deepspeech-0.9.1-models.pbmm --scorer deepspeech-0.9.1-models.scorer --audio audio/2830-3980-0043.wav

Loading model from file deepspeech-0.9.1-models.pbmm
TensorFlow: v2.3.0-6-g23ad988fcd
DeepSpeech: v0.9.1-0-gab8bd3e1
Loaded model in 0.0486s.
Loading scorer from files deepspeech-0.9.1-models.scorer
Loaded scorer in 0.00625s.
Running inference.
experience proves this
Inference took 5.095s for 1.975s audio file.
</code></pre><ul><li>That mini sample worked fine.. &ldquo;experience proves this&rdquo; is 100% accurate according to my ears at least.</li></ul><h4 id=i-read-some-tips-on-the-conversion>I Read Some tips on the conversion<a hidden class=anchor aria-hidden=true href=#i-read-some-tips-on-the-conversion>#</a></h4><ul><li>Ok cool according to <a href=https://www.howtoforge.com/tutorial/ffmpeg-audio-conversion/>here</a> I can use <code>ffmpeg</code> to convert from <code>m4a</code> to <code>wav</code> with just <code>ffmpeg -i blah.m4a blah.wav</code></li><li>But I tried <code>deepspeech</code> on my wav file</li></ul><pre tabindex=0><code>deepspeech --model deepspeech-0.9.1-models.pbmm --scorer deepspeech-0.9.1-models.scorer --audio blah.wav

Loading model from file deepspeech-0.9.1-models.pbmm
TensorFlow: v2.3.0-6-g23ad988fcd
DeepSpeech: v0.9.1-0-gab8bd3e1
Loaded model in 0.0648s.
Loading scorer from files deepspeech-0.9.1-models.scorer
Loaded scorer in 0.00534s.
Warning: original sample rate (24000) is different than 16000hz. Resampling might produce erratic speech recognition.
</code></pre><ul><li>Then the <code>sox</code> program for resampling not present&mldr;</li><li>I read Some notes on resampling <a href=https://transcoding.wordpress.com/2011/11/16/careful-with-audio-resampling-using-ffmpeg/>here</a> and finding that <code>ffmpeg</code> has <code>sox</code> built in now.</li></ul><pre tabindex=0><code>workdir=/blah/my/workdir
infile=${workdir}/2020-11-22-09.54.59.wav
outfile=${workdir}/2020-11-22-09.54.59--resampled.wav
ffmpeg -i $infile  -af aresample=resampler=soxr -ar 16000 $outfile
</code></pre><pre tabindex=0><code>deepspeech --model deepspeech-0.9.1-models.pbmm --scorer deepspeech-0.9.1-models.scorer --audio $outfile
</code></pre><ul><li>Ok hahaha this time after resampling to <code>16000Hz</code> finally worked, but the output does not match any kind of reality haha.</li></ul><pre tabindex=0><code>Loading model from file deepspeech-0.9.1-models.pbmm
TensorFlow: v2.3.0-6-g23ad988fcd
DeepSpeech: v0.9.1-0-gab8bd3e1
Loaded model in 0.0451s.
Loading scorer from files deepspeech-0.9.1-models.scorer
Loaded scorer in 0.00534s.
Running inference.
so then listened and even interesting it interesting idea for talking about the habitation main point is a paradise his crimes and the periostracum basically like ours person wrote his book or started this is to other thinking harrison article or are frontiersman like a loathing at the summer sententiam first creation antoinette to mitigate they had had been important role spoke for catering people is catching people attention and then destournier take nineteen and working on the antithetic aeternitate which takes a attakapas
Inference took 65.434s for 114.816s audio file.
</code></pre><h3 id=other-notes>Other notes<a hidden class=anchor aria-hidden=true href=#other-notes>#</a></h3><p>Maybe strategies like <a href=https://medium.com/cod3/convert-speech-from-an-audio-file-to-text-using-google-speech-api-b951f4032a64>this one</a></p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://michal.piekarczyk.xyz/post/2020-12-09-dropbox-api-hmm/><span class=title>« Prev</span><br><span>Easy Blog Posting ("My Noting Book")</span></a>
<a class=next href=https://michal.piekarczyk.xyz/post/2020-11-14-themundanityofexcellencestratificationandolympicswimmers-summary/><span class=title>Next »</span><br><span>Summary of Mundanity of Excellence</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://michal.piekarczyk.xyz/>michal.piekarczyk.xyz</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>