<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Fasting Data Time Series Analysis Notebook | My blog</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="This is a notebook of the day to day activity of a look into three years of fasting data."><meta name=generator content="Hugo 0.85.0"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel=stylesheet href=/ananke/dist/main.css_5c99d70a7725bacd4c701e995b969fea.css><meta property="og:title" content="Fasting Data Time Series Analysis Notebook"><meta property="og:description" content="This is a notebook of the day to day activity of a look into three years of fasting data."><meta property="og:type" content="article"><meta property="og:url" content="https://michal.piekarczyk.xyz/post/2021-06-27-zero-time-series-analysis/"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-06-27T00:00:00+00:00"><meta property="article:modified_time" content="2021-06-27T00:00:00+00:00"><meta property="og:site_name" content="My blog"><meta itemprop=name content="Fasting Data Time Series Analysis Notebook"><meta itemprop=description content="This is a notebook of the day to day activity of a look into three years of fasting data."><meta itemprop=datePublished content="2021-06-27T00:00:00+00:00"><meta itemprop=dateModified content="2021-06-27T00:00:00+00:00"><meta itemprop=wordCount content="1839"><meta itemprop=keywords content="time-series,notebook,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Fasting Data Time Series Analysis Notebook"><meta name=twitter:description content="This is a notebook of the day to day activity of a look into three years of fasting data."></head><body class="ma0 avenir bg-near-white"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">My blog</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/about/ title="About page">About</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/handy/ title="Handy page">Handy</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/post/ title="Post page">Post</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/project/ title="Side Projects page">Side Projects</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/foo/ title="The Foos page">The Foos</a></li></ul></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POST</aside><div id=sharing class=mt3><a href="https://www.facebook.com/sharer.php?u=https://michal.piekarczyk.xyz/post/2021-06-27-zero-time-series-analysis/" class="facebook no-underline" aria-label="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a href="https://twitter.com/share?url=https://michal.piekarczyk.xyz/post/2021-06-27-zero-time-series-analysis/&text=Fasting%20Data%20Time%20Series%20Analysis%20Notebook" class="twitter no-underline" aria-label="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://michal.piekarczyk.xyz/post/2021-06-27-zero-time-series-analysis/&title=Fasting%20Data%20Time%20Series%20Analysis%20Notebook" class="linkedin no-underline" aria-label="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 athelas mt3 mb1">Fasting Data Time Series Analysis Notebook</h1><time class="f6 mv4 dib tracked" datetime=2021-06-27T00:00:00Z>June 27, 2021</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>This is a notebook of the day to day activity of a look into three years of fasting data.</p><h3 id=2021-06-27>2021-06-27</h3><h4 id=initial-thoughts>Initial thoughts</h4><ul><li>I have about 3 years of fasting data now and I would like to see if something interesting can be said about it. And if given some time series data, is it possible to predict the next day. Or at least something about the next day.</li><li>I suspect the data is somewhat cyclical at least with respect to patterns of &ldquo;restraint&rdquo; and &ldquo;indulgence&rdquo; , but also maybe with respect to week and weekend.</li><li>Initially I think I want to use frequency based features, but perhaps afterwards I can compare that with an LSTM approach.</li><li>I also have some calorie data, but it is only for about 3 months or so, and maybe I can use that somehow too later.</li><li>Perhaps I can even later on try using exercise data, sleep data if available. And there is of course temperature and weather data.</li></ul><h4 id=next-steps>Next steps</h4><ul><li>Write out some interesting questions I would like to answer.</li><li>What is my feature list so far , as a sort of data dictionary.</li><li>Can do some initial data exploration, with visualizations.</li><li>Build a dataset based on some initial features,</li></ul><h4 id=interesting-questions->Interesting Questions ?</h4><ul><li>Given a sequence of days, is there an interesting target variable, such as the hours fasted, which can be predicted of the next day or even the next few days or next week?</li><li>A core qualitative question is, whether a period of restraint (more fasting) is followed by a period of less restraint (less fasting)?</li><li>And maybe an extension of the above is whether fasting appears to be cyclical and how would you even measure this?</li><li>How does the number of prior days of activity improve the accuracy of the prediction of the next day?</li></ul><h4 id=feature-list-initial>Feature list initial</h4><ul><li>most recent fast started before midnight</li><li>most recent fast ended before 20:00</li><li>most recent fast more than 18 hours</li><li>most recent fast more than 16 hours</li><li>most recent fast more than 14 hours</li><li>last two fasts, average start time before midnight</li><li>last two fasts, average end time before 20:00</li><li>last two fasts, average more than 18 hours</li><li>last two fasts, average more than 16 hours</li><li>last two fasts, max is more than 18 hours</li><li>last two fasts, min is more than 18 hours</li><li>last two fasts, m in is more than 16 hours</li></ul><h4 id=next>Next</h4><ul><li>Yea next I would like to start building out a dataset of these features</li><li>And would be cool to visualize some of these features too, get some summary stats on them.</li></ul><h3 id=2021-06-28>2021-06-28</h3><h4 id=build-dataset>build dataset&mldr;</h4><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> os
<span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
workdir <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#34;WORKDIR&#34;</span>)
datadir <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#34;DATADIR&#34;</span>)

loc <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>datadir<span style=color:#e6db74>}</span><span style=color:#e6db74>/2021-06-26-zero-fast.csv&#34;</span>
df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(loc)



In [<span style=color:#ae81ff>3</span>]: df<span style=color:#f92672>.</span>shape                                                                
Out[<span style=color:#ae81ff>3</span>]: (<span style=color:#ae81ff>1109</span>, <span style=color:#ae81ff>5</span>)

In [<span style=color:#ae81ff>4</span>]: df<span style=color:#f92672>.</span>iloc[:<span style=color:#ae81ff>4</span>]                                                             
Out[<span style=color:#ae81ff>4</span>]:
      Date  Start    End  Hours  Night Eating
<span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>26</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>57</span>    NaN    NaN           NaN
<span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>25</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>17</span>   <span style=color:#ae81ff>17.0</span>           NaN
<span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>24</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>50</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>39</span>   <span style=color:#ae81ff>16.0</span>           NaN
<span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>23</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>  <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>18.0</span>           NaN
</code></pre></div><ul><li>Probably the simples question, is what is a unit of fasting? A fast can start and end on two different dates or it can start and end on the same day.</li><li>A Fast can also span multiple days and it can also happen while traveling, resulting in different time zones messing with the data.</li><li>However this dataset doesn&rsquo;t appear to have time zones, so I wonder if it kind of simplifies that.</li><li>Simplest I think is to ignore the first row for example,</li></ul><pre><code>      Date  Start    End  Hours  Night Eating
0  6/26/21  01:57    NaN    NaN           NaN

</code></pre><ul><li>Since this fast is on-going. So a fast unit has a start and an end.</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>In [<span style=color:#ae81ff>6</span>]:  df[df<span style=color:#f92672>.</span>Hours<span style=color:#f92672>.</span>isnull()]<span style=color:#f92672>.</span>shape, df<span style=color:#f92672>.</span>shape                                  
Out[<span style=color:#ae81ff>6</span>]: ((<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>5</span>), (<span style=color:#ae81ff>1109</span>, <span style=color:#ae81ff>5</span>))
</code></pre></div><ul><li>Ok per above only the latest fast would be null then.</li></ul><h4 id=next-1>Next</h4><ul><li>Start writing that dataset</li><li>write a fast id perhaps as the &ldquo;start-date-start-time&rdquo; which would be unique, and has to have defined end of course.</li><li>And figure out what does that &ldquo;Night Eating&rdquo; column mean.</li><li>names for the features I started writing out.</li></ul><h3 id=2021-06-30>2021-06-30</h3><h4 id=quick-notes>quick notes</h4><ul><li><p>Also realized that the time between fasts can be a feature too.</p></li><li><p>For each &ldquo;row&rdquo;, we can basically say the &ldquo;End time&rdquo; is a separator between what happened before a fasting event, which can be used to create the &ldquo;X&rdquo; or independent variables and what happens after is the &ldquo;Y&rdquo; or dependent variables.</p></li><li><p>So for each row, if using pandas for example, we want a way to take perhaps 4 or more rows surrounding it and that would be used to create the features.</p></li><li><p>Perhaps this feels like a job for <a href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.window.rolling.Rolling.apply.html#pandas.core.window.rolling.Rolling.apply>rolling window</a> , <a href=https://towardsdatascience.com/dont-miss-out-on-rolling-window-functions-in-pandas-850b817131db>interesting article</a></p></li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#75715e># most recent fast started before midnight</span>


</code></pre></div><h4 id=updated-feature-list>updated feature list</h4><h4 id=feature-list-initial-1>Feature list initial</h4><ul><li>most recent fast started before midnight</li><li>most recent fast ended before 20:00</li><li>most recent fast more than 18 hours</li><li>most recent fast more than 16 hours</li><li>most recent fast more than 14 hours</li><li>last two fasts, average start time before midnight</li><li>last two fasts, both start time before midnight</li><li>last two fasts, average end time before 20:00</li><li>last two fasts, average more than 18 hours</li><li>last two fasts, average more than 16 hours</li><li>last two fasts, max is more than 18 hours</li><li>last two fasts, min is more than 18 hours</li><li>last two fasts, m in is more than 16 hours</li><li>last two feeding windows, average less than 4 hours</li></ul><h3 id=2021-07-07>2021-07-07</h3><h4 id=tried-this-rolling-calc>tried this rolling calc</h4><ul><li>Looks good just need to calibrate the direction.</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>df[<span style=color:#e6db74>&#39;RollingHoursMean2Fasts&#39;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;Hours&#39;</span>]<span style=color:#f92672>.</span>rolling(<span style=color:#ae81ff>2</span>)<span style=color:#f92672>.</span>mean()

In [<span style=color:#ae81ff>8</span>]: df<span style=color:#f92672>.</span>iloc[:<span style=color:#ae81ff>10</span>]                                                                  
Out[<span style=color:#ae81ff>8</span>]:
      Date  Start    End  Hours  Night Eating  RollingHoursMean2Fasts
<span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>26</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>57</span>    NaN    NaN           NaN                     NaN
<span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>25</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>17</span>   <span style=color:#ae81ff>17.0</span>           NaN                     NaN
<span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>24</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>50</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>39</span>   <span style=color:#ae81ff>16.0</span>           NaN                    <span style=color:#ae81ff>16.5</span>
<span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>23</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>  <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>18.0</span>           NaN                    <span style=color:#ae81ff>17.0</span>
<span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>22</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>06</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>52</span>   <span style=color:#ae81ff>17.0</span>           NaN                    <span style=color:#ae81ff>17.5</span>
<span style=color:#ae81ff>5</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>46</span>  <span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>55</span>   <span style=color:#ae81ff>19.0</span>           NaN                    <span style=color:#ae81ff>18.0</span>
<span style=color:#ae81ff>6</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>20</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>04</span>:<span style=color:#ae81ff>39</span>  <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>28</span>    <span style=color:#ae81ff>8.0</span>           NaN                    <span style=color:#ae81ff>13.5</span>
<span style=color:#ae81ff>7</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>19</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>02</span>:<span style=color:#ae81ff>37</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>15.0</span>           NaN                    <span style=color:#ae81ff>11.5</span>
<span style=color:#ae81ff>8</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>18</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>41</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>41</span>   <span style=color:#ae81ff>17.0</span>           NaN                    <span style=color:#ae81ff>16.0</span>
<span style=color:#ae81ff>9</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>17</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>  <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>38</span>   <span style=color:#ae81ff>20.0</span>           NaN                    <span style=color:#ae81ff>18.5</span>
</code></pre></div><h3 id=2021-07-09>2021-07-09</h3><ul><li>Add index too&mldr;</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> datetime
df[<span style=color:#e6db74>&#39;StartDt&#39;</span>] <span style=color:#f92672>=</span>  df<span style=color:#f92672>.</span>apply(<span style=color:#66d9ef>lambda</span> x: datetime<span style=color:#f92672>.</span>datetime(int(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;20</span><span style=color:#e6db74>{</span>x<span style=color:#f92672>.</span>Date<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;/&#39;</span>)[<span style=color:#ae81ff>2</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>),
                                                      int(x<span style=color:#f92672>.</span>Date<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;/&#34;</span>)[<span style=color:#ae81ff>0</span>]),
                                                      int(x<span style=color:#f92672>.</span>Date<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;/&#34;</span>)[<span style=color:#ae81ff>1</span>]),
                                                      int(x<span style=color:#f92672>.</span>Start<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;:&#34;</span>)[<span style=color:#ae81ff>0</span>]),
                                                      int(x<span style=color:#f92672>.</span>Start<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;:&#34;</span>)[<span style=color:#ae81ff>1</span>])
                                                      ), axis<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)
df[<span style=color:#e6db74>&#39;id&#39;</span>] <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>apply(<span style=color:#66d9ef>lambda</span> x: x<span style=color:#f92672>.</span>StartDt<span style=color:#f92672>.</span>strftime(<span style=color:#e6db74>&#34;%Y-%m-</span><span style=color:#e6db74>%d</span><span style=color:#e6db74>T%H%M&#34;</span>), axis<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)

In [<span style=color:#ae81ff>21</span>]: df<span style=color:#f92672>.</span>iloc[:<span style=color:#ae81ff>10</span>]                                                                                                                 
Out[<span style=color:#ae81ff>21</span>]:
      Date  Start    End  Hours  Night Eating  RollingHoursMean2Fasts             StartDt               id
<span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>26</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>57</span>    NaN    NaN           NaN                     NaN <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>26</span> <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>57</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>26</span>T0157
<span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>25</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>17</span>   <span style=color:#ae81ff>17.0</span>           NaN                     NaN <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>25</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>25</span>T0014
<span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>24</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>50</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>39</span>   <span style=color:#ae81ff>16.0</span>           NaN                    <span style=color:#ae81ff>16.5</span> <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>50</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span>T0150
<span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>23</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>  <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>18.0</span>           NaN                    <span style=color:#ae81ff>17.0</span> <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>23</span> <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>23</span>T0102
<span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>22</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>06</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>52</span>   <span style=color:#ae81ff>17.0</span>           NaN                    <span style=color:#ae81ff>17.5</span> <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>22</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>06</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>22</span>T0006
<span style=color:#ae81ff>5</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>46</span>  <span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>55</span>   <span style=color:#ae81ff>19.0</span>           NaN                    <span style=color:#ae81ff>18.0</span> <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>21</span> <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>46</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>21</span>T0146
<span style=color:#ae81ff>6</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>20</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>04</span>:<span style=color:#ae81ff>39</span>  <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>28</span>    <span style=color:#ae81ff>8.0</span>           NaN                    <span style=color:#ae81ff>13.5</span> <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>20</span> <span style=color:#ae81ff>04</span>:<span style=color:#ae81ff>39</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>20</span>T0439
<span style=color:#ae81ff>7</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>19</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>02</span>:<span style=color:#ae81ff>37</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>15.0</span>           NaN                    <span style=color:#ae81ff>11.5</span> <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>19</span> <span style=color:#ae81ff>02</span>:<span style=color:#ae81ff>37</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>19</span>T0237
<span style=color:#ae81ff>8</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>18</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>41</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>41</span>   <span style=color:#ae81ff>17.0</span>           NaN                    <span style=color:#ae81ff>16.0</span> <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>18</span> <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>41</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>18</span>T0141
<span style=color:#ae81ff>9</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>17</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>  <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>38</span>   <span style=color:#ae81ff>20.0</span>           NaN                    <span style=color:#ae81ff>18.5</span> <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>17</span> <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>17</span>T0102
</code></pre></div><ul><li>Looking at above, I see that <code>RollingHoursMean2Fasts</code> for <code>2021-06-24T0150</code> is <code>16.5 = mean([17, 16])</code> , so the rows it is taking into account should be current row and next not current row and last</li></ul><h4 id=next-2>Next</h4><ul><li>Make <code>RollingHoursMean2Fasts</code> be for current and previous fast , not current and future fast haha since cannot know the future!</li></ul><h3 id=2021-07-10>2021-07-10</h3><h4 id=how-to-update-the-rolling-window-to-reflect-the-last-2-fasts>how to update the rolling window to reflect the last 2 fasts</h4><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
df[<span style=color:#e6db74>&#39;foo&#39;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;Hours&#39;</span>]<span style=color:#f92672>.</span>shift(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)
df[<span style=color:#e6db74>&#39;RollingHoursMean2Fasts&#39;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;Hours&#39;</span>]<span style=color:#f92672>.</span>shift(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>.</span>rolling(<span style=color:#ae81ff>2</span>)<span style=color:#f92672>.</span>mean()
</code></pre></div><ul><li>Nice, per the below, this is perfect.</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>In [<span style=color:#ae81ff>33</span>]: cols <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;id&#39;</span>, <span style=color:#e6db74>&#39;Date&#39;</span>, <span style=color:#e6db74>&#39;Start&#39;</span>, <span style=color:#e6db74>&#39;End&#39;</span>, <span style=color:#e6db74>&#39;Hours&#39;</span>, <span style=color:#e6db74>&#39;RollingHoursMean2Fasts&#39;</span>, <span style=color:#e6db74>&#39;foo&#39;</span>]
    <span style=color:#f92672>...</span>: df[cols]<span style=color:#f92672>.</span>iloc[:<span style=color:#ae81ff>10</span>]                                                                                                           
Out[<span style=color:#ae81ff>33</span>]:
                id     Date  Start    End  Hours  RollingHoursMean2Fasts   foo
<span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>26</span>T0157  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>26</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>57</span>    NaN    NaN                     NaN  <span style=color:#ae81ff>17.0</span>
<span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>25</span>T0014  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>25</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>17</span>   <span style=color:#ae81ff>17.0</span>                    <span style=color:#ae81ff>16.5</span>  <span style=color:#ae81ff>16.0</span>
<span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span>T0150  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>24</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>50</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>39</span>   <span style=color:#ae81ff>16.0</span>                    <span style=color:#ae81ff>17.0</span>  <span style=color:#ae81ff>18.0</span>
<span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>23</span>T0102  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>23</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>  <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>18.0</span>                    <span style=color:#ae81ff>17.5</span>  <span style=color:#ae81ff>17.0</span>
<span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>22</span>T0006  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>22</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>06</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>52</span>   <span style=color:#ae81ff>17.0</span>                    <span style=color:#ae81ff>18.0</span>  <span style=color:#ae81ff>19.0</span>
<span style=color:#ae81ff>5</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>21</span>T0146  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>46</span>  <span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>55</span>   <span style=color:#ae81ff>19.0</span>                    <span style=color:#ae81ff>13.5</span>   <span style=color:#ae81ff>8.0</span>
<span style=color:#ae81ff>6</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>20</span>T0439  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>20</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>04</span>:<span style=color:#ae81ff>39</span>  <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>28</span>    <span style=color:#ae81ff>8.0</span>                    <span style=color:#ae81ff>11.5</span>  <span style=color:#ae81ff>15.0</span>
<span style=color:#ae81ff>7</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>19</span>T0237  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>19</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>02</span>:<span style=color:#ae81ff>37</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>15.0</span>                    <span style=color:#ae81ff>16.0</span>  <span style=color:#ae81ff>17.0</span>
<span style=color:#ae81ff>8</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>18</span>T0141  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>18</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>41</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>41</span>   <span style=color:#ae81ff>17.0</span>                    <span style=color:#ae81ff>18.5</span>  <span style=color:#ae81ff>20.0</span>
<span style=color:#ae81ff>9</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>17</span>T0102  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>17</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>  <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>38</span>   <span style=color:#ae81ff>20.0</span>                    <span style=color:#ae81ff>18.5</span>  <span style=color:#ae81ff>17.0</span>
</code></pre></div><h4 id=ok-going-to-add-two-more-features-like-this>Ok, going to add two more features like this</h4><ul><li>last two fasts, both start time before midnight, &ldquo;LastTwoFastsStartedBeforeMidnight&rdquo;</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>func</span>(x):
    <span style=color:#66d9ef>pass</span>
    <span style=color:#f92672>import</span> ipdb; ipdb<span style=color:#f92672>.</span>set_trace()
    <span style=color:#66d9ef>return</span> all([<span style=color:#ae81ff>18</span> <span style=color:#f92672>&lt;=</span> int(a<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;:&#34;</span>)[<span style=color:#ae81ff>0</span>]) <span style=color:#f92672>&lt;=</span><span style=color:#ae81ff>23</span> <span style=color:#66d9ef>for</span> a <span style=color:#f92672>in</span> x])

df[<span style=color:#e6db74>&#34;LastTwoFastsStartedBeforeMidnight&#34;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;Start&#39;</span>]<span style=color:#f92672>.</span>shift(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>.</span>rolling(<span style=color:#ae81ff>2</span>)<span style=color:#f92672>.</span>apply(func)


</code></pre></div><ul><li>I encountered <code>DataError: No numeric types to aggregate</code> and deeper in there I also stumbled on</li></ul><pre><code>ValueError: could not convert string to float: '00:14'
</code></pre><ul><li>So got to convert first to a numerical..</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>func</span>(data):
    <span style=color:#66d9ef>return</span> all([<span style=color:#ae81ff>18</span> <span style=color:#f92672>&lt;=</span> x <span style=color:#f92672>&lt;=</span><span style=color:#ae81ff>23</span> <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> data])

df[<span style=color:#e6db74>&#34;StartHour&#34;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#34;Start&#34;</span>]<span style=color:#f92672>.</span>map(<span style=color:#66d9ef>lambda</span> x: int(x<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;:&#34;</span>)[<span style=color:#ae81ff>0</span>]))

df[<span style=color:#e6db74>&#34;LastTwoFastsStartedBeforeMidnight&#34;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;StartHour&#39;</span>]<span style=color:#f92672>.</span>shift(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>.</span>rolling(<span style=color:#ae81ff>2</span>)<span style=color:#f92672>.</span>apply(func)

</code></pre></div><ul><li>Ok I think that worked ..</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>In [<span style=color:#ae81ff>57</span>]: df<span style=color:#f92672>.</span>LastTwoFastsStartedBeforeMidnight<span style=color:#f92672>.</span>value_counts()                                                                          
Out[<span style=color:#ae81ff>57</span>]:
<span style=color:#ae81ff>0.0</span>    <span style=color:#ae81ff>907</span>
<span style=color:#ae81ff>1.0</span>    <span style=color:#ae81ff>200</span>
Name: LastTwoFastsStartedBeforeMidnight, dtype: int64

In [<span style=color:#ae81ff>60</span>]: cols <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;id&#39;</span>, <span style=color:#e6db74>&#39;Date&#39;</span>, <span style=color:#e6db74>&#39;Start&#39;</span>, <span style=color:#e6db74>&#39;End&#39;</span>, <span style=color:#e6db74>&#39;Hours&#39;</span>, <span style=color:#e6db74>&#39;LastTwoFastsStartedBeforeMidnight&#39;</span>,]
    <span style=color:#f92672>...</span>: df[cols]<span style=color:#f92672>.</span>iloc[<span style=color:#ae81ff>35</span>:<span style=color:#ae81ff>45</span>]                                                                                                         
Out[<span style=color:#ae81ff>60</span>]:
                 id     Date  Start    End  Hours  LastTwoFastsStartedBeforeMidnight
<span style=color:#ae81ff>35</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>21</span>T2341  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>23</span>:<span style=color:#ae81ff>41</span>  <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>02</span>   <span style=color:#ae81ff>21.0</span>                                <span style=color:#ae81ff>0.0</span>
<span style=color:#ae81ff>36</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>21</span>T0026  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>26</span>  <span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>31</span>   <span style=color:#ae81ff>20.0</span>                                <span style=color:#ae81ff>0.0</span>
<span style=color:#ae81ff>37</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>20</span>T0101  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>20</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>01</span>  <span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>57</span>   <span style=color:#ae81ff>19.0</span>                                <span style=color:#ae81ff>0.0</span>
<span style=color:#ae81ff>38</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>19</span>T0008  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>19</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>08</span>  <span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>29</span>   <span style=color:#ae81ff>20.0</span>                                <span style=color:#ae81ff>0.0</span>
<span style=color:#ae81ff>39</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>17</span>T2324  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>17</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>23</span>:<span style=color:#ae81ff>24</span>  <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>38</span>   <span style=color:#ae81ff>22.0</span>                                <span style=color:#ae81ff>1.0</span>
<span style=color:#ae81ff>40</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>16</span>T2300  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>16</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>23</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>21.0</span>                                <span style=color:#ae81ff>1.0</span>
<span style=color:#ae81ff>41</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>15</span>T2358  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>15</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>23</span>:<span style=color:#ae81ff>58</span>  <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>06</span>   <span style=color:#ae81ff>14.0</span>                                <span style=color:#ae81ff>0.0</span>
<span style=color:#ae81ff>42</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>15</span>T0110  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>15</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>10</span>  <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>42</span>   <span style=color:#ae81ff>20.0</span>                                <span style=color:#ae81ff>0.0</span>
<span style=color:#ae81ff>43</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>14</span>T0049  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>14</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>49</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>53</span>   <span style=color:#ae81ff>17.0</span>                                <span style=color:#ae81ff>0.0</span>
<span style=color:#ae81ff>44</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>13</span>T0015  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>13</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>15</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>26</span>   <span style=color:#ae81ff>17.0</span>                                <span style=color:#ae81ff>0.0</span>
</code></pre></div><h4 id=next-3>Next</h4><ul><li>Ok at this point I should start throwing stuff into version control so creating these features and visualizing/analyzing them can be more deterministic/reproducible.</li><li>And then I can try visualizing / understanding some features and see how predictive they are w.r.t. &ldquo;does past behavior determine future behavior such as the length of the next fast&rdquo;.</li></ul><h3 id=2021-07-11>2021-07-11</h3><h4 id=ok-started-things-off-in-a-new-repo>ok started things off in a new repo</h4><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> os
<span style=color:#f92672>import</span> core.dataset <span style=color:#66d9ef>as</span> cd

<span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
workdir <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#34;WORKDIR&#34;</span>)
datadir <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#34;DATADIR&#34;</span>)

loc <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>datadir<span style=color:#e6db74>}</span><span style=color:#e6db74>/2021-06-26-zero-fast.csv&#34;</span>
df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(loc)

datasetdf <span style=color:#f92672>=</span> cd<span style=color:#f92672>.</span>build_dataset(df)

In [<span style=color:#ae81ff>11</span>]: datasetdf<span style=color:#f92672>.</span>iloc[:<span style=color:#ae81ff>10</span>]                                                                                                          
Out[<span style=color:#ae81ff>11</span>]:
      Date  Start    End  Hours  <span style=color:#f92672>...</span>               id StartHour LastTwoFastsStartedBeforeMidnight  RollingHoursMean2Fasts
<span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>26</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>57</span>    NaN    NaN  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>26</span>T0157         <span style=color:#ae81ff>1</span>                               NaN                     NaN
<span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>25</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>17</span>   <span style=color:#ae81ff>17.0</span>  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>25</span>T0014         <span style=color:#ae81ff>0</span>                               <span style=color:#ae81ff>0.0</span>                    <span style=color:#ae81ff>16.5</span>
<span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>24</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>50</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>39</span>   <span style=color:#ae81ff>16.0</span>  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span>T0150         <span style=color:#ae81ff>1</span>                               <span style=color:#ae81ff>0.0</span>                    <span style=color:#ae81ff>17.0</span>
<span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>23</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>  <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>18.0</span>  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>23</span>T0102         <span style=color:#ae81ff>1</span>                               <span style=color:#ae81ff>0.0</span>                    <span style=color:#ae81ff>17.5</span>
<span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>22</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>06</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>52</span>   <span style=color:#ae81ff>17.0</span>  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>22</span>T0006         <span style=color:#ae81ff>0</span>                               <span style=color:#ae81ff>0.0</span>                    <span style=color:#ae81ff>18.0</span>
<span style=color:#ae81ff>5</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>46</span>  <span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>55</span>   <span style=color:#ae81ff>19.0</span>  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>21</span>T0146         <span style=color:#ae81ff>1</span>                               <span style=color:#ae81ff>0.0</span>                    <span style=color:#ae81ff>13.5</span>
<span style=color:#ae81ff>6</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>20</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>04</span>:<span style=color:#ae81ff>39</span>  <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>28</span>    <span style=color:#ae81ff>8.0</span>  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>20</span>T0439         <span style=color:#ae81ff>4</span>                               <span style=color:#ae81ff>0.0</span>                    <span style=color:#ae81ff>11.5</span>
<span style=color:#ae81ff>7</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>19</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>02</span>:<span style=color:#ae81ff>37</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>15.0</span>  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>19</span>T0237         <span style=color:#ae81ff>2</span>                               <span style=color:#ae81ff>0.0</span>                    <span style=color:#ae81ff>16.0</span>
<span style=color:#ae81ff>8</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>18</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>41</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>41</span>   <span style=color:#ae81ff>17.0</span>  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>18</span>T0141         <span style=color:#ae81ff>1</span>                               <span style=color:#ae81ff>0.0</span>                    <span style=color:#ae81ff>18.5</span>
<span style=color:#ae81ff>9</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>17</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>  <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>38</span>   <span style=color:#ae81ff>20.0</span>  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>17</span>T0102         <span style=color:#ae81ff>1</span>                               <span style=color:#ae81ff>0.0</span>                    <span style=color:#ae81ff>18.5</span>

[<span style=color:#ae81ff>10</span> rows x <span style=color:#ae81ff>10</span> columns]

In [<span style=color:#ae81ff>12</span>]: datasetdf<span style=color:#f92672>.</span>iloc[<span style=color:#ae81ff>0</span>]                                                                                                            
Out[<span style=color:#ae81ff>12</span>]:
Date                                             <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>26</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>
Start                                              <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>57</span>
End                                                  NaN
Hours                                                NaN
Night Eating                                         NaN
StartDt                              <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>26</span> <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>57</span>:<span style=color:#ae81ff>00</span>
id                                       <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>26</span>T0157
StartHour                                              <span style=color:#ae81ff>1</span>
LastTwoFastsStartedBeforeMidnight                    NaN
RollingHoursMean2Fasts                               NaN
Name: <span style=color:#ae81ff>0</span>, dtype: object

</code></pre></div><h4 id=look-at-rollinghoursmean2fasts-briefly>look at RollingHoursMean2Fasts briefly</h4><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt

<span style=color:#f92672>import</span> pylab
<span style=color:#f92672>import</span> date_utils <span style=color:#66d9ef>as</span> du

col <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;RollingHoursMean2Fasts&#34;</span>
loc <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>workdir<span style=color:#e6db74>}</span><span style=color:#e6db74>/</span><span style=color:#e6db74>{</span>du<span style=color:#f92672>.</span>utc_ts()<span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>{</span>col<span style=color:#e6db74>}</span><span style=color:#e6db74>.png&#34;</span>
<span style=color:#66d9ef>with</span> plt<span style=color:#f92672>.</span>style<span style=color:#f92672>.</span>context(<span style=color:#e6db74>&#39;fivethirtyeight&#39;</span>):
    plt<span style=color:#f92672>.</span>plot(datasetdf[col]<span style=color:#f92672>.</span>tolist())
    plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{</span>col<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
    pylab<span style=color:#f92672>.</span>savefig(loc, bbox_inches<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;tight&#39;</span>)
    pylab<span style=color:#f92672>.</span>close()

</code></pre></div><img src=https://s3.amazonaws.com/my-blog-content/2021-06-27-zero-time-series-analysis/2021-07-11T173459-RollingHoursMean2Fasts.png width=50%><h4 id=next-4>Next</h4><ul><li>I think the main next thing to do is to create a &ldquo;y&rdquo; dependent variable for this dataset, which can for example be something like &ldquo;hours fasted in next fast&rdquo; or &ldquo;hours until next fast&rdquo; or &ldquo;proportion of hours fasted in next 7 days&rdquo;.</li><li>And with a dependent variable I can then see how predictive these features are, as a first iteration with only the twofeatures so far.</li><li>And I can continue to add other features too.</li></ul><ul class=pa0><li class=list><a href=/tags/time-series class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">time-series</a></li><li class=list><a href=/tags/notebook class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">notebook</a></li></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://michal.piekarczyk.xyz/>&copy; My blog 2021</a><div></div></div></footer></body></html>