<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Fasting Data Time Series Analysis Notebook | michal.piekarczyk.xyz</title><meta name=keywords content="time-series,notebook"><meta name=description content="This is a notebook of the day to day activity of a look into three years of fasting data."><meta name=author content="Michal Piekarczyk"><link rel=canonical href=https://michal.piekarczyk.xyz/post/2021-06-27-zero-time-series-analysis/><link crossorigin=anonymous href=/assets/css/stylesheet.6a98292fb8fa8cf0f3ba4042d4b75515c04267550f3ad49ff6271b5af9562443.css integrity="sha256-apgpL7j6jPDzukBC1LdVFcBCZ1UPOtSf9icbWvlWJEM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://michal.piekarczyk.xyz/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://michal.piekarczyk.xyz/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://michal.piekarczyk.xyz/favicon-32x32.png><link rel=apple-touch-icon href=https://michal.piekarczyk.xyz/apple-touch-icon.png><link rel=mask-icon href=https://michal.piekarczyk.xyz/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-86TSXEXWB5"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-86TSXEXWB5",{anonymize_ip:!1})}</script><meta property="og:title" content="Fasting Data Time Series Analysis Notebook"><meta property="og:description" content="This is a notebook of the day to day activity of a look into three years of fasting data."><meta property="og:type" content="article"><meta property="og:url" content="https://michal.piekarczyk.xyz/post/2021-06-27-zero-time-series-analysis/"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-06-27T00:00:00+00:00"><meta property="article:modified_time" content="2021-06-27T00:00:00+00:00"><meta property="og:site_name" content="michal.piekarczyk.xyz"><meta name=twitter:card content="summary"><meta name=twitter:title content="Fasting Data Time Series Analysis Notebook"><meta name=twitter:description content="This is a notebook of the day to day activity of a look into three years of fasting data."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://michal.piekarczyk.xyz/post/"},{"@type":"ListItem","position":2,"name":"Fasting Data Time Series Analysis Notebook","item":"https://michal.piekarczyk.xyz/post/2021-06-27-zero-time-series-analysis/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Fasting Data Time Series Analysis Notebook","name":"Fasting Data Time Series Analysis Notebook","description":"This is a notebook of the day to day activity of a look into three years of fasting data.","keywords":["time-series","notebook"],"articleBody":"This is a notebook of the day to day activity of a look into three years of fasting data.\n2021-06-27 Initial thoughts I have about 3 years of fasting data now and I would like to see if something interesting can be said about it. And if given some time series data, is it possible to predict the next day. Or at least something about the next day. I suspect the data is somewhat cyclical at least with respect to patterns of “restraint” and “indulgence” , but also maybe with respect to week and weekend. Initially I think I want to use frequency based features, but perhaps afterwards I can compare that with an LSTM approach. I also have some calorie data, but it is only for about 3 months or so, and maybe I can use that somehow too later. Perhaps I can even later on try using exercise data, sleep data if available. And there is of course temperature and weather data. Next steps Write out some interesting questions I would like to answer. What is my feature list so far , as a sort of data dictionary. Can do some initial data exploration, with visualizations. Build a dataset based on some initial features, Interesting Questions ? Given a sequence of days, is there an interesting target variable, such as the hours fasted, which can be predicted of the next day or even the next few days or next week? A core qualitative question is, whether a period of restraint (more fasting) is followed by a period of less restraint (less fasting)? And maybe an extension of the above is whether fasting appears to be cyclical and how would you even measure this? How does the number of prior days of activity improve the accuracy of the prediction of the next day? Feature list initial most recent fast started before midnight most recent fast ended before 20:00 most recent fast more than 18 hours most recent fast more than 16 hours most recent fast more than 14 hours last two fasts, average start time before midnight last two fasts, average end time before 20:00 last two fasts, average more than 18 hours last two fasts, average more than 16 hours last two fasts, max is more than 18 hours last two fasts, min is more than 18 hours last two fasts, m in is more than 16 hours Next Yea next I would like to start building out a dataset of these features And would be cool to visualize some of these features too, get some summary stats on them. 2021-06-28 build dataset… import os import pandas as pd workdir = os.getenv(\"WORKDIR\") datadir = os.getenv(\"DATADIR\") loc = f\"{datadir}/2021-06-26-zero-fast.csv\" df = pd.read_csv(loc) In [3]: df.shape Out[3]: (1109, 5) In [4]: df.iloc[:4] Out[4]: Date Start End Hours Night Eating 0 6/26/21 01:57 NaN NaN NaN 1 6/25/21 00:14 17:17 17.0 NaN 2 6/24/21 01:50 18:39 16.0 NaN 3 6/23/21 01:02 19:21 18.0 NaN Probably the simples question, is what is a unit of fasting? A fast can start and end on two different dates or it can start and end on the same day. A Fast can also span multiple days and it can also happen while traveling, resulting in different time zones messing with the data. However this dataset doesn’t appear to have time zones, so I wonder if it kind of simplifies that. Simplest I think is to ignore the first row for example, Date Start End Hours Night Eating 0 6/26/21 01:57 NaN NaN NaN Since this fast is on-going. So a fast unit has a start and an end. In [6]: df[df.Hours.isnull()].shape, df.shape Out[6]: ((1, 5), (1109, 5)) Ok per above only the latest fast would be null then. Next Start writing that dataset write a fast id perhaps as the “start-date-start-time” which would be unique, and has to have defined end of course. And figure out what does that “Night Eating” column mean. names for the features I started writing out. 2021-06-30 quick notes Also realized that the time between fasts can be a feature too.\nFor each “row”, we can basically say the “End time” is a separator between what happened before a fasting event, which can be used to create the “X” or independent variables and what happens after is the “Y” or dependent variables.\nSo for each row, if using pandas for example, we want a way to take perhaps 4 or more rows surrounding it and that would be used to create the features.\nPerhaps this feels like a job for rolling window , interesting article\n# most recent fast started before midnight updated feature list Feature list initial most recent fast started before midnight most recent fast ended before 20:00 most recent fast more than 18 hours most recent fast more than 16 hours most recent fast more than 14 hours last two fasts, average start time before midnight last two fasts, both start time before midnight last two fasts, average end time before 20:00 last two fasts, average more than 18 hours last two fasts, average more than 16 hours last two fasts, max is more than 18 hours last two fasts, min is more than 18 hours last two fasts, m in is more than 16 hours last two feeding windows, average less than 4 hours 2021-07-07 tried this rolling calc Looks good just need to calibrate the direction. df['RollingHoursMean2Fasts'] = df['Hours'].rolling(2).mean() In [8]: df.iloc[:10] Out[8]: Date Start End Hours Night Eating RollingHoursMean2Fasts 0 6/26/21 01:57 NaN NaN NaN NaN 1 6/25/21 00:14 17:17 17.0 NaN NaN 2 6/24/21 01:50 18:39 16.0 NaN 16.5 3 6/23/21 01:02 19:21 18.0 NaN 17.0 4 6/22/21 00:06 17:52 17.0 NaN 17.5 5 6/21/21 01:46 20:55 19.0 NaN 18.0 6 6/20/21 04:39 13:28 8.0 NaN 13.5 7 6/19/21 02:37 18:21 15.0 NaN 11.5 8 6/18/21 01:41 18:41 17.0 NaN 16.0 9 6/17/21 01:02 21:38 20.0 NaN 18.5 2021-07-09 Add index too… import datetime df['StartDt'] = df.apply(lambda x: datetime.datetime(int(f\"20{x.Date.split('/')[2]}\"), int(x.Date.split(\"/\")[0]), int(x.Date.split(\"/\")[1]), int(x.Start.split(\":\")[0]), int(x.Start.split(\":\")[1]) ), axis=1) df['id'] = df.apply(lambda x: x.StartDt.strftime(\"%Y-%m-%dT%H%M\"), axis=1) In [21]: df.iloc[:10] Out[21]: Date Start End Hours Night Eating RollingHoursMean2Fasts StartDt id 0 6/26/21 01:57 NaN NaN NaN NaN 2021-06-26 01:57:00 2021-06-26T0157 1 6/25/21 00:14 17:17 17.0 NaN NaN 2021-06-25 00:14:00 2021-06-25T0014 2 6/24/21 01:50 18:39 16.0 NaN 16.5 2021-06-24 01:50:00 2021-06-24T0150 3 6/23/21 01:02 19:21 18.0 NaN 17.0 2021-06-23 01:02:00 2021-06-23T0102 4 6/22/21 00:06 17:52 17.0 NaN 17.5 2021-06-22 00:06:00 2021-06-22T0006 5 6/21/21 01:46 20:55 19.0 NaN 18.0 2021-06-21 01:46:00 2021-06-21T0146 6 6/20/21 04:39 13:28 8.0 NaN 13.5 2021-06-20 04:39:00 2021-06-20T0439 7 6/19/21 02:37 18:21 15.0 NaN 11.5 2021-06-19 02:37:00 2021-06-19T0237 8 6/18/21 01:41 18:41 17.0 NaN 16.0 2021-06-18 01:41:00 2021-06-18T0141 9 6/17/21 01:02 21:38 20.0 NaN 18.5 2021-06-17 01:02:00 2021-06-17T0102 Looking at above, I see that RollingHoursMean2Fasts for 2021-06-24T0150 is 16.5 = mean([17, 16]) , so the rows it is taking into account should be current row and next not current row and last Next Make RollingHoursMean2Fasts be for current and previous fast , not current and future fast haha since cannot know the future! 2021-07-10 how to update the rolling window to reflect the last 2 fasts df['foo'] = df['Hours'].shift(-1) df['RollingHoursMean2Fasts'] = df['Hours'].shift(-1).rolling(2).mean() Nice, per the below, this is perfect. In [33]: cols = ['id', 'Date', 'Start', 'End', 'Hours', 'RollingHoursMean2Fasts', 'foo'] ...: df[cols].iloc[:10] Out[33]: id Date Start End Hours RollingHoursMean2Fasts foo 0 2021-06-26T0157 6/26/21 01:57 NaN NaN NaN 17.0 1 2021-06-25T0014 6/25/21 00:14 17:17 17.0 16.5 16.0 2 2021-06-24T0150 6/24/21 01:50 18:39 16.0 17.0 18.0 3 2021-06-23T0102 6/23/21 01:02 19:21 18.0 17.5 17.0 4 2021-06-22T0006 6/22/21 00:06 17:52 17.0 18.0 19.0 5 2021-06-21T0146 6/21/21 01:46 20:55 19.0 13.5 8.0 6 2021-06-20T0439 6/20/21 04:39 13:28 8.0 11.5 15.0 7 2021-06-19T0237 6/19/21 02:37 18:21 15.0 16.0 17.0 8 2021-06-18T0141 6/18/21 01:41 18:41 17.0 18.5 20.0 9 2021-06-17T0102 6/17/21 01:02 21:38 20.0 18.5 17.0 Ok, going to add two more features like this last two fasts, both start time before midnight, “LastTwoFastsStartedBeforeMidnight” def func(x): pass import ipdb; ipdb.set_trace() return all([18 \u003c= int(a.split(\":\")[0]) \u003c=23 for a in x]) df[\"LastTwoFastsStartedBeforeMidnight\"] = df['Start'].shift(-1).rolling(2).apply(func) I encountered DataError: No numeric types to aggregate and deeper in there I also stumbled on ValueError: could not convert string to float: '00:14' So got to convert first to a numerical.. def func(data): return all([18 \u003c= x \u003c=23 for x in data]) df[\"StartHour\"] = df[\"Start\"].map(lambda x: int(x.split(\":\")[0])) df[\"LastTwoFastsStartedBeforeMidnight\"] = df['StartHour'].shift(-1).rolling(2).apply(func) Ok I think that worked .. In [57]: df.LastTwoFastsStartedBeforeMidnight.value_counts() Out[57]: 0.0 907 1.0 200 Name: LastTwoFastsStartedBeforeMidnight, dtype: int64 In [60]: cols = ['id', 'Date', 'Start', 'End', 'Hours', 'LastTwoFastsStartedBeforeMidnight',] ...: df[cols].iloc[35:45] Out[60]: id Date Start End Hours LastTwoFastsStartedBeforeMidnight 35 2021-05-21T2341 5/21/21 23:41 21:02 21.0 0.0 36 2021-05-21T0026 5/21/21 00:26 20:31 20.0 0.0 37 2021-05-20T0101 5/20/21 01:01 20:57 19.0 0.0 38 2021-05-19T0008 5/19/21 00:08 20:29 20.0 0.0 39 2021-05-17T2324 5/17/21 23:24 21:38 22.0 1.0 40 2021-05-16T2300 5/16/21 23:00 20:21 21.0 1.0 41 2021-05-15T2358 5/15/21 23:58 14:06 14.0 0.0 42 2021-05-15T0110 5/15/21 01:10 21:42 20.0 0.0 43 2021-05-14T0049 5/14/21 00:49 17:53 17.0 0.0 44 2021-05-13T0015 5/13/21 00:15 17:26 17.0 0.0 Next Ok at this point I should start throwing stuff into version control so creating these features and visualizing/analyzing them can be more deterministic/reproducible. And then I can try visualizing / understanding some features and see how predictive they are w.r.t. “does past behavior determine future behavior such as the length of the next fast”. 2021-07-11 ok started things off in a new repo New repo here , https://github.com/namoopsoo/fasting-analyze import os import core.dataset as cd import pandas as pd workdir = os.getenv(\"WORKDIR\") datadir = os.getenv(\"DATADIR\") loc = f\"{datadir}/2021-06-26-zero-fast.csv\" df = pd.read_csv(loc) datasetdf = cd.build_dataset(df) In [11]: datasetdf.iloc[:10] Out[11]: Date Start End Hours ... id StartHour LastTwoFastsStartedBeforeMidnight RollingHoursMean2Fasts 0 6/26/21 01:57 NaN NaN ... 2021-06-26T0157 1 NaN NaN 1 6/25/21 00:14 17:17 17.0 ... 2021-06-25T0014 0 0.0 16.5 2 6/24/21 01:50 18:39 16.0 ... 2021-06-24T0150 1 0.0 17.0 3 6/23/21 01:02 19:21 18.0 ... 2021-06-23T0102 1 0.0 17.5 4 6/22/21 00:06 17:52 17.0 ... 2021-06-22T0006 0 0.0 18.0 5 6/21/21 01:46 20:55 19.0 ... 2021-06-21T0146 1 0.0 13.5 6 6/20/21 04:39 13:28 8.0 ... 2021-06-20T0439 4 0.0 11.5 7 6/19/21 02:37 18:21 15.0 ... 2021-06-19T0237 2 0.0 16.0 8 6/18/21 01:41 18:41 17.0 ... 2021-06-18T0141 1 0.0 18.5 9 6/17/21 01:02 21:38 20.0 ... 2021-06-17T0102 1 0.0 18.5 [10 rows x 10 columns] In [12]: datasetdf.iloc[0] Out[12]: Date 6/26/21 Start 01:57 End NaN Hours NaN Night Eating NaN StartDt 2021-06-26 01:57:00 id 2021-06-26T0157 StartHour 1 LastTwoFastsStartedBeforeMidnight NaN RollingHoursMean2Fasts NaN Name: 0, dtype: object look at RollingHoursMean2Fasts briefly import matplotlib.pyplot as plt import pylab import date_utils as du col = \"RollingHoursMean2Fasts\" loc = f\"{workdir}/{du.utc_ts()}-{col}.png\" with plt.style.context('fivethirtyeight'): plt.plot(datasetdf[col].tolist()) plt.title(f'{col}') pylab.savefig(loc, bbox_inches='tight') pylab.close() Next I think the main next thing to do is to create a “y” dependent variable for this dataset, which can for example be something like “hours fasted in next fast” or “hours until next fast” or “proportion of hours fasted in next 7 days”. And with a dependent variable I can then see how predictive these features are, as a first iteration with only the twofeatures so far. And I can continue to add other features too. ","wordCount":"1844","inLanguage":"en","datePublished":"2021-06-27T00:00:00Z","dateModified":"2021-06-27T00:00:00Z","author":{"@type":"Person","name":"Michal Piekarczyk"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://michal.piekarczyk.xyz/post/2021-06-27-zero-time-series-analysis/"},"publisher":{"@type":"Organization","name":"michal.piekarczyk.xyz","logo":{"@type":"ImageObject","url":"https://michal.piekarczyk.xyz/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://michal.piekarczyk.xyz/ accesskey=h title="michal.piekarczyk.xyz (Alt + H)">michal.piekarczyk.xyz</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://michal.piekarczyk.xyz/post/ title=posts><span>posts</span></a></li><li><a href=https://michal.piekarczyk.xyz/project/ title=projects><span>projects</span></a></li><li><a href=https://michal.piekarczyk.xyz/handy/ title=handy><span>handy</span></a></li><li><a href=https://michal.piekarczyk.xyz/tags/ title=tags><span>tags</span></a></li><li><a href=https://michal.piekarczyk.xyz/about/ title=about><span>about</span></a></li><li><a href=https://world.hey.com/michal.piekarczyk title=frivolity><span>frivolity</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://michal.piekarczyk.xyz/>Home</a>&nbsp;»&nbsp;<a href=https://michal.piekarczyk.xyz/post/>Posts</a></div><h1 class=post-title>Fasting Data Time Series Analysis Notebook</h1><div class=post-meta><span title='2021-06-27 00:00:00 +0000 UTC'>272727-27-2712</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;1844 words&nbsp;·&nbsp;Michal Piekarczyk</div></header><div class=post-content><p>This is a notebook of the day to day activity of a look into three years of fasting data.</p><h3 id=2021-06-27>2021-06-27<a hidden class=anchor aria-hidden=true href=#2021-06-27>#</a></h3><h4 id=initial-thoughts>Initial thoughts<a hidden class=anchor aria-hidden=true href=#initial-thoughts>#</a></h4><ul><li>I have about 3 years of fasting data now and I would like to see if something interesting can be said about it. And if given some time series data, is it possible to predict the next day. Or at least something about the next day.</li><li>I suspect the data is somewhat cyclical at least with respect to patterns of &ldquo;restraint&rdquo; and &ldquo;indulgence&rdquo; , but also maybe with respect to week and weekend.</li><li>Initially I think I want to use frequency based features, but perhaps afterwards I can compare that with an LSTM approach.</li><li>I also have some calorie data, but it is only for about 3 months or so, and maybe I can use that somehow too later.</li><li>Perhaps I can even later on try using exercise data, sleep data if available. And there is of course temperature and weather data.</li></ul><h4 id=next-steps>Next steps<a hidden class=anchor aria-hidden=true href=#next-steps>#</a></h4><ul><li>Write out some interesting questions I would like to answer.</li><li>What is my feature list so far , as a sort of data dictionary.</li><li>Can do some initial data exploration, with visualizations.</li><li>Build a dataset based on some initial features,</li></ul><h4 id=interesting-questions->Interesting Questions ?<a hidden class=anchor aria-hidden=true href=#interesting-questions->#</a></h4><ul><li>Given a sequence of days, is there an interesting target variable, such as the hours fasted, which can be predicted of the next day or even the next few days or next week?</li><li>A core qualitative question is, whether a period of restraint (more fasting) is followed by a period of less restraint (less fasting)?</li><li>And maybe an extension of the above is whether fasting appears to be cyclical and how would you even measure this?</li><li>How does the number of prior days of activity improve the accuracy of the prediction of the next day?</li></ul><h4 id=feature-list-initial>Feature list initial<a hidden class=anchor aria-hidden=true href=#feature-list-initial>#</a></h4><ul><li>most recent fast started before midnight</li><li>most recent fast ended before 20:00</li><li>most recent fast more than 18 hours</li><li>most recent fast more than 16 hours</li><li>most recent fast more than 14 hours</li><li>last two fasts, average start time before midnight</li><li>last two fasts, average end time before 20:00</li><li>last two fasts, average more than 18 hours</li><li>last two fasts, average more than 16 hours</li><li>last two fasts, max is more than 18 hours</li><li>last two fasts, min is more than 18 hours</li><li>last two fasts, m in is more than 16 hours</li></ul><h4 id=next>Next<a hidden class=anchor aria-hidden=true href=#next>#</a></h4><ul><li>Yea next I would like to start building out a dataset of these features</li><li>And would be cool to visualize some of these features too, get some summary stats on them.</li></ul><h3 id=2021-06-28>2021-06-28<a hidden class=anchor aria-hidden=true href=#2021-06-28>#</a></h3><h4 id=build-dataset>build dataset&mldr;<a hidden class=anchor aria-hidden=true href=#build-dataset>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span>workdir <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#34;WORKDIR&#34;</span>)
</span></span><span style=display:flex><span>datadir <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#34;DATADIR&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>loc <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>datadir<span style=color:#e6db74>}</span><span style=color:#e6db74>/2021-06-26-zero-fast.csv&#34;</span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(loc)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>3</span>]: df<span style=color:#f92672>.</span>shape                                                                
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>3</span>]: (<span style=color:#ae81ff>1109</span>, <span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>4</span>]: df<span style=color:#f92672>.</span>iloc[:<span style=color:#ae81ff>4</span>]                                                             
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>4</span>]:
</span></span><span style=display:flex><span>      Date  Start    End  Hours  Night Eating
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>26</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>57</span>    NaN    NaN           NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>25</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>17</span>   <span style=color:#ae81ff>17.0</span>           NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>24</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>50</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>39</span>   <span style=color:#ae81ff>16.0</span>           NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>23</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>  <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>18.0</span>           NaN
</span></span></code></pre></div><ul><li>Probably the simples question, is what is a unit of fasting? A fast can start and end on two different dates or it can start and end on the same day.</li><li>A Fast can also span multiple days and it can also happen while traveling, resulting in different time zones messing with the data.</li><li>However this dataset doesn&rsquo;t appear to have time zones, so I wonder if it kind of simplifies that.</li><li>Simplest I think is to ignore the first row for example,</li></ul><pre tabindex=0><code>      Date  Start    End  Hours  Night Eating
0  6/26/21  01:57    NaN    NaN           NaN
</code></pre><ul><li>Since this fast is on-going. So a fast unit has a start and an end.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>6</span>]:  df[df<span style=color:#f92672>.</span>Hours<span style=color:#f92672>.</span>isnull()]<span style=color:#f92672>.</span>shape, df<span style=color:#f92672>.</span>shape                                  
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>6</span>]: ((<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>5</span>), (<span style=color:#ae81ff>1109</span>, <span style=color:#ae81ff>5</span>))
</span></span></code></pre></div><ul><li>Ok per above only the latest fast would be null then.</li></ul><h4 id=next-1>Next<a hidden class=anchor aria-hidden=true href=#next-1>#</a></h4><ul><li>Start writing that dataset</li><li>write a fast id perhaps as the &ldquo;start-date-start-time&rdquo; which would be unique, and has to have defined end of course.</li><li>And figure out what does that &ldquo;Night Eating&rdquo; column mean.</li><li>names for the features I started writing out.</li></ul><h3 id=2021-06-30>2021-06-30<a hidden class=anchor aria-hidden=true href=#2021-06-30>#</a></h3><h4 id=quick-notes>quick notes<a hidden class=anchor aria-hidden=true href=#quick-notes>#</a></h4><ul><li><p>Also realized that the time between fasts can be a feature too.</p></li><li><p>For each &ldquo;row&rdquo;, we can basically say the &ldquo;End time&rdquo; is a separator between what happened before a fasting event, which can be used to create the &ldquo;X&rdquo; or independent variables and what happens after is the &ldquo;Y&rdquo; or dependent variables.</p></li><li><p>So for each row, if using pandas for example, we want a way to take perhaps 4 or more rows surrounding it and that would be used to create the features.</p></li><li><p>Perhaps this feels like a job for <a href=https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.window.rolling.Rolling.apply.html#pandas.core.window.rolling.Rolling.apply>rolling window</a> , <a href=https://towardsdatascience.com/dont-miss-out-on-rolling-window-functions-in-pandas-850b817131db>interesting article</a></p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># most recent fast started before midnight</span>
</span></span></code></pre></div><h4 id=updated-feature-list>updated feature list<a hidden class=anchor aria-hidden=true href=#updated-feature-list>#</a></h4><h4 id=feature-list-initial-1>Feature list initial<a hidden class=anchor aria-hidden=true href=#feature-list-initial-1>#</a></h4><ul><li>most recent fast started before midnight</li><li>most recent fast ended before 20:00</li><li>most recent fast more than 18 hours</li><li>most recent fast more than 16 hours</li><li>most recent fast more than 14 hours</li><li>last two fasts, average start time before midnight</li><li>last two fasts, both start time before midnight</li><li>last two fasts, average end time before 20:00</li><li>last two fasts, average more than 18 hours</li><li>last two fasts, average more than 16 hours</li><li>last two fasts, max is more than 18 hours</li><li>last two fasts, min is more than 18 hours</li><li>last two fasts, m in is more than 16 hours</li><li>last two feeding windows, average less than 4 hours</li></ul><h3 id=2021-07-07>2021-07-07<a hidden class=anchor aria-hidden=true href=#2021-07-07>#</a></h3><h4 id=tried-this-rolling-calc>tried this rolling calc<a hidden class=anchor aria-hidden=true href=#tried-this-rolling-calc>#</a></h4><ul><li>Looks good just need to calibrate the direction.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df[<span style=color:#e6db74>&#39;RollingHoursMean2Fasts&#39;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;Hours&#39;</span>]<span style=color:#f92672>.</span>rolling(<span style=color:#ae81ff>2</span>)<span style=color:#f92672>.</span>mean()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>8</span>]: df<span style=color:#f92672>.</span>iloc[:<span style=color:#ae81ff>10</span>]                                                                  
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>8</span>]:
</span></span><span style=display:flex><span>      Date  Start    End  Hours  Night Eating  RollingHoursMean2Fasts
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>26</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>57</span>    NaN    NaN           NaN                     NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>25</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>17</span>   <span style=color:#ae81ff>17.0</span>           NaN                     NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>24</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>50</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>39</span>   <span style=color:#ae81ff>16.0</span>           NaN                    <span style=color:#ae81ff>16.5</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>23</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>  <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>18.0</span>           NaN                    <span style=color:#ae81ff>17.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>22</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>06</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>52</span>   <span style=color:#ae81ff>17.0</span>           NaN                    <span style=color:#ae81ff>17.5</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>5</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>46</span>  <span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>55</span>   <span style=color:#ae81ff>19.0</span>           NaN                    <span style=color:#ae81ff>18.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>6</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>20</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>04</span>:<span style=color:#ae81ff>39</span>  <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>28</span>    <span style=color:#ae81ff>8.0</span>           NaN                    <span style=color:#ae81ff>13.5</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>7</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>19</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>02</span>:<span style=color:#ae81ff>37</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>15.0</span>           NaN                    <span style=color:#ae81ff>11.5</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>8</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>18</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>41</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>41</span>   <span style=color:#ae81ff>17.0</span>           NaN                    <span style=color:#ae81ff>16.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>9</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>17</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>  <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>38</span>   <span style=color:#ae81ff>20.0</span>           NaN                    <span style=color:#ae81ff>18.5</span>
</span></span></code></pre></div><h3 id=2021-07-09>2021-07-09<a hidden class=anchor aria-hidden=true href=#2021-07-09>#</a></h3><ul><li>Add index too&mldr;</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> datetime
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;StartDt&#39;</span>] <span style=color:#f92672>=</span>  df<span style=color:#f92672>.</span>apply(<span style=color:#66d9ef>lambda</span> x: datetime<span style=color:#f92672>.</span>datetime(int(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;20</span><span style=color:#e6db74>{</span>x<span style=color:#f92672>.</span>Date<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;/&#39;</span>)[<span style=color:#ae81ff>2</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>),
</span></span><span style=display:flex><span>                                                      int(x<span style=color:#f92672>.</span>Date<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;/&#34;</span>)[<span style=color:#ae81ff>0</span>]),
</span></span><span style=display:flex><span>                                                      int(x<span style=color:#f92672>.</span>Date<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;/&#34;</span>)[<span style=color:#ae81ff>1</span>]),
</span></span><span style=display:flex><span>                                                      int(x<span style=color:#f92672>.</span>Start<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;:&#34;</span>)[<span style=color:#ae81ff>0</span>]),
</span></span><span style=display:flex><span>                                                      int(x<span style=color:#f92672>.</span>Start<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;:&#34;</span>)[<span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>                                                      ), axis<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;id&#39;</span>] <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>apply(<span style=color:#66d9ef>lambda</span> x: x<span style=color:#f92672>.</span>StartDt<span style=color:#f92672>.</span>strftime(<span style=color:#e6db74>&#34;%Y-%m-</span><span style=color:#e6db74>%d</span><span style=color:#e6db74>T%H%M&#34;</span>), axis<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>21</span>]: df<span style=color:#f92672>.</span>iloc[:<span style=color:#ae81ff>10</span>]                                                                                                                 
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>21</span>]:
</span></span><span style=display:flex><span>      Date  Start    End  Hours  Night Eating  RollingHoursMean2Fasts             StartDt               id
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>26</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>57</span>    NaN    NaN           NaN                     NaN <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>26</span> <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>57</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>26</span>T0157
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>25</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>17</span>   <span style=color:#ae81ff>17.0</span>           NaN                     NaN <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>25</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>25</span>T0014
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>24</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>50</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>39</span>   <span style=color:#ae81ff>16.0</span>           NaN                    <span style=color:#ae81ff>16.5</span> <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>50</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span>T0150
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>23</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>  <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>18.0</span>           NaN                    <span style=color:#ae81ff>17.0</span> <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>23</span> <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>23</span>T0102
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>22</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>06</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>52</span>   <span style=color:#ae81ff>17.0</span>           NaN                    <span style=color:#ae81ff>17.5</span> <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>22</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>06</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>22</span>T0006
</span></span><span style=display:flex><span><span style=color:#ae81ff>5</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>46</span>  <span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>55</span>   <span style=color:#ae81ff>19.0</span>           NaN                    <span style=color:#ae81ff>18.0</span> <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>21</span> <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>46</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>21</span>T0146
</span></span><span style=display:flex><span><span style=color:#ae81ff>6</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>20</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>04</span>:<span style=color:#ae81ff>39</span>  <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>28</span>    <span style=color:#ae81ff>8.0</span>           NaN                    <span style=color:#ae81ff>13.5</span> <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>20</span> <span style=color:#ae81ff>04</span>:<span style=color:#ae81ff>39</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>20</span>T0439
</span></span><span style=display:flex><span><span style=color:#ae81ff>7</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>19</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>02</span>:<span style=color:#ae81ff>37</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>15.0</span>           NaN                    <span style=color:#ae81ff>11.5</span> <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>19</span> <span style=color:#ae81ff>02</span>:<span style=color:#ae81ff>37</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>19</span>T0237
</span></span><span style=display:flex><span><span style=color:#ae81ff>8</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>18</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>41</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>41</span>   <span style=color:#ae81ff>17.0</span>           NaN                    <span style=color:#ae81ff>16.0</span> <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>18</span> <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>41</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>18</span>T0141
</span></span><span style=display:flex><span><span style=color:#ae81ff>9</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>17</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>  <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>38</span>   <span style=color:#ae81ff>20.0</span>           NaN                    <span style=color:#ae81ff>18.5</span> <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>17</span> <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>17</span>T0102
</span></span></code></pre></div><ul><li>Looking at above, I see that <code>RollingHoursMean2Fasts</code> for <code>2021-06-24T0150</code> is <code>16.5 = mean([17, 16])</code> , so the rows it is taking into account should be current row and next not current row and last</li></ul><h4 id=next-2>Next<a hidden class=anchor aria-hidden=true href=#next-2>#</a></h4><ul><li>Make <code>RollingHoursMean2Fasts</code> be for current and previous fast , not current and future fast haha since cannot know the future!</li></ul><h3 id=2021-07-10>2021-07-10<a hidden class=anchor aria-hidden=true href=#2021-07-10>#</a></h3><h4 id=how-to-update-the-rolling-window-to-reflect-the-last-2-fasts>how to update the rolling window to reflect the last 2 fasts<a hidden class=anchor aria-hidden=true href=#how-to-update-the-rolling-window-to-reflect-the-last-2-fasts>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;foo&#39;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;Hours&#39;</span>]<span style=color:#f92672>.</span>shift(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;RollingHoursMean2Fasts&#39;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;Hours&#39;</span>]<span style=color:#f92672>.</span>shift(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>.</span>rolling(<span style=color:#ae81ff>2</span>)<span style=color:#f92672>.</span>mean()
</span></span></code></pre></div><ul><li>Nice, per the below, this is perfect.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>33</span>]: cols <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;id&#39;</span>, <span style=color:#e6db74>&#39;Date&#39;</span>, <span style=color:#e6db74>&#39;Start&#39;</span>, <span style=color:#e6db74>&#39;End&#39;</span>, <span style=color:#e6db74>&#39;Hours&#39;</span>, <span style=color:#e6db74>&#39;RollingHoursMean2Fasts&#39;</span>, <span style=color:#e6db74>&#39;foo&#39;</span>]
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>: df[cols]<span style=color:#f92672>.</span>iloc[:<span style=color:#ae81ff>10</span>]                                                                                                           
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>33</span>]:
</span></span><span style=display:flex><span>                id     Date  Start    End  Hours  RollingHoursMean2Fasts   foo
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>26</span>T0157  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>26</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>57</span>    NaN    NaN                     NaN  <span style=color:#ae81ff>17.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>25</span>T0014  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>25</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>17</span>   <span style=color:#ae81ff>17.0</span>                    <span style=color:#ae81ff>16.5</span>  <span style=color:#ae81ff>16.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span>T0150  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>24</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>50</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>39</span>   <span style=color:#ae81ff>16.0</span>                    <span style=color:#ae81ff>17.0</span>  <span style=color:#ae81ff>18.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>23</span>T0102  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>23</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>  <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>18.0</span>                    <span style=color:#ae81ff>17.5</span>  <span style=color:#ae81ff>17.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>22</span>T0006  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>22</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>06</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>52</span>   <span style=color:#ae81ff>17.0</span>                    <span style=color:#ae81ff>18.0</span>  <span style=color:#ae81ff>19.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>5</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>21</span>T0146  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>46</span>  <span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>55</span>   <span style=color:#ae81ff>19.0</span>                    <span style=color:#ae81ff>13.5</span>   <span style=color:#ae81ff>8.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>6</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>20</span>T0439  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>20</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>04</span>:<span style=color:#ae81ff>39</span>  <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>28</span>    <span style=color:#ae81ff>8.0</span>                    <span style=color:#ae81ff>11.5</span>  <span style=color:#ae81ff>15.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>7</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>19</span>T0237  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>19</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>02</span>:<span style=color:#ae81ff>37</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>15.0</span>                    <span style=color:#ae81ff>16.0</span>  <span style=color:#ae81ff>17.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>8</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>18</span>T0141  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>18</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>41</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>41</span>   <span style=color:#ae81ff>17.0</span>                    <span style=color:#ae81ff>18.5</span>  <span style=color:#ae81ff>20.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>9</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>17</span>T0102  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>17</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>  <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>38</span>   <span style=color:#ae81ff>20.0</span>                    <span style=color:#ae81ff>18.5</span>  <span style=color:#ae81ff>17.0</span>
</span></span></code></pre></div><h4 id=ok-going-to-add-two-more-features-like-this>Ok, going to add two more features like this<a hidden class=anchor aria-hidden=true href=#ok-going-to-add-two-more-features-like-this>#</a></h4><ul><li>last two fasts, both start time before midnight, &ldquo;LastTwoFastsStartedBeforeMidnight&rdquo;</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>func</span>(x):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pass</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>import</span> ipdb; ipdb<span style=color:#f92672>.</span>set_trace()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> all([<span style=color:#ae81ff>18</span> <span style=color:#f92672>&lt;=</span> int(a<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;:&#34;</span>)[<span style=color:#ae81ff>0</span>]) <span style=color:#f92672>&lt;=</span><span style=color:#ae81ff>23</span> <span style=color:#66d9ef>for</span> a <span style=color:#f92672>in</span> x])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#34;LastTwoFastsStartedBeforeMidnight&#34;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;Start&#39;</span>]<span style=color:#f92672>.</span>shift(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>.</span>rolling(<span style=color:#ae81ff>2</span>)<span style=color:#f92672>.</span>apply(func)
</span></span></code></pre></div><ul><li>I encountered <code>DataError: No numeric types to aggregate</code> and deeper in there I also stumbled on</li></ul><pre tabindex=0><code>ValueError: could not convert string to float: &#39;00:14&#39;
</code></pre><ul><li>So got to convert first to a numerical..</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>func</span>(data):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> all([<span style=color:#ae81ff>18</span> <span style=color:#f92672>&lt;=</span> x <span style=color:#f92672>&lt;=</span><span style=color:#ae81ff>23</span> <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> data])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#34;StartHour&#34;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#34;Start&#34;</span>]<span style=color:#f92672>.</span>map(<span style=color:#66d9ef>lambda</span> x: int(x<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;:&#34;</span>)[<span style=color:#ae81ff>0</span>]))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#34;LastTwoFastsStartedBeforeMidnight&#34;</span>] <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;StartHour&#39;</span>]<span style=color:#f92672>.</span>shift(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>.</span>rolling(<span style=color:#ae81ff>2</span>)<span style=color:#f92672>.</span>apply(func)
</span></span></code></pre></div><ul><li>Ok I think that worked ..</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>57</span>]: df<span style=color:#f92672>.</span>LastTwoFastsStartedBeforeMidnight<span style=color:#f92672>.</span>value_counts()                                                                          
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>57</span>]:
</span></span><span style=display:flex><span><span style=color:#ae81ff>0.0</span>    <span style=color:#ae81ff>907</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1.0</span>    <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span>Name: LastTwoFastsStartedBeforeMidnight, dtype: int64
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>60</span>]: cols <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;id&#39;</span>, <span style=color:#e6db74>&#39;Date&#39;</span>, <span style=color:#e6db74>&#39;Start&#39;</span>, <span style=color:#e6db74>&#39;End&#39;</span>, <span style=color:#e6db74>&#39;Hours&#39;</span>, <span style=color:#e6db74>&#39;LastTwoFastsStartedBeforeMidnight&#39;</span>,]
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>: df[cols]<span style=color:#f92672>.</span>iloc[<span style=color:#ae81ff>35</span>:<span style=color:#ae81ff>45</span>]                                                                                                         
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>60</span>]:
</span></span><span style=display:flex><span>                 id     Date  Start    End  Hours  LastTwoFastsStartedBeforeMidnight
</span></span><span style=display:flex><span><span style=color:#ae81ff>35</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>21</span>T2341  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>23</span>:<span style=color:#ae81ff>41</span>  <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>02</span>   <span style=color:#ae81ff>21.0</span>                                <span style=color:#ae81ff>0.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>36</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>21</span>T0026  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>26</span>  <span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>31</span>   <span style=color:#ae81ff>20.0</span>                                <span style=color:#ae81ff>0.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>37</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>20</span>T0101  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>20</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>01</span>  <span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>57</span>   <span style=color:#ae81ff>19.0</span>                                <span style=color:#ae81ff>0.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>38</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>19</span>T0008  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>19</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>08</span>  <span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>29</span>   <span style=color:#ae81ff>20.0</span>                                <span style=color:#ae81ff>0.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>39</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>17</span>T2324  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>17</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>23</span>:<span style=color:#ae81ff>24</span>  <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>38</span>   <span style=color:#ae81ff>22.0</span>                                <span style=color:#ae81ff>1.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>40</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>16</span>T2300  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>16</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>23</span>:<span style=color:#ae81ff>00</span>  <span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>21.0</span>                                <span style=color:#ae81ff>1.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>41</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>15</span>T2358  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>15</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>23</span>:<span style=color:#ae81ff>58</span>  <span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>06</span>   <span style=color:#ae81ff>14.0</span>                                <span style=color:#ae81ff>0.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>42</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>15</span>T0110  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>15</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>10</span>  <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>42</span>   <span style=color:#ae81ff>20.0</span>                                <span style=color:#ae81ff>0.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>43</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>14</span>T0049  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>14</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>49</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>53</span>   <span style=color:#ae81ff>17.0</span>                                <span style=color:#ae81ff>0.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>44</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>13</span>T0015  <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>13</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>15</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>26</span>   <span style=color:#ae81ff>17.0</span>                                <span style=color:#ae81ff>0.0</span>
</span></span></code></pre></div><h4 id=next-3>Next<a hidden class=anchor aria-hidden=true href=#next-3>#</a></h4><ul><li>Ok at this point I should start throwing stuff into version control so creating these features and visualizing/analyzing them can be more deterministic/reproducible.</li><li>And then I can try visualizing / understanding some features and see how predictive they are w.r.t. &ldquo;does past behavior determine future behavior such as the length of the next fast&rdquo;.</li></ul><h3 id=2021-07-11>2021-07-11<a hidden class=anchor aria-hidden=true href=#2021-07-11>#</a></h3><h4 id=ok-started-things-off-in-a-new-repo>ok started things off in a new repo<a hidden class=anchor aria-hidden=true href=#ok-started-things-off-in-a-new-repo>#</a></h4><ul><li>New repo here , <a href=https://github.com/namoopsoo/fasting-analyze>https://github.com/namoopsoo/fasting-analyze</a></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> core.dataset <span style=color:#66d9ef>as</span> cd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span>workdir <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#34;WORKDIR&#34;</span>)
</span></span><span style=display:flex><span>datadir <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#34;DATADIR&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>loc <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>datadir<span style=color:#e6db74>}</span><span style=color:#e6db74>/2021-06-26-zero-fast.csv&#34;</span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(loc)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>datasetdf <span style=color:#f92672>=</span> cd<span style=color:#f92672>.</span>build_dataset(df)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>11</span>]: datasetdf<span style=color:#f92672>.</span>iloc[:<span style=color:#ae81ff>10</span>]                                                                                                          
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>11</span>]:
</span></span><span style=display:flex><span>      Date  Start    End  Hours  <span style=color:#f92672>...</span>               id StartHour LastTwoFastsStartedBeforeMidnight  RollingHoursMean2Fasts
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>26</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>57</span>    NaN    NaN  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>26</span>T0157         <span style=color:#ae81ff>1</span>                               NaN                     NaN
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>25</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>17</span>   <span style=color:#ae81ff>17.0</span>  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>25</span>T0014         <span style=color:#ae81ff>0</span>                               <span style=color:#ae81ff>0.0</span>                    <span style=color:#ae81ff>16.5</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>24</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>50</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>39</span>   <span style=color:#ae81ff>16.0</span>  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span>T0150         <span style=color:#ae81ff>1</span>                               <span style=color:#ae81ff>0.0</span>                    <span style=color:#ae81ff>17.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>23</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>  <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>18.0</span>  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>23</span>T0102         <span style=color:#ae81ff>1</span>                               <span style=color:#ae81ff>0.0</span>                    <span style=color:#ae81ff>17.5</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>22</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>06</span>  <span style=color:#ae81ff>17</span>:<span style=color:#ae81ff>52</span>   <span style=color:#ae81ff>17.0</span>  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>22</span>T0006         <span style=color:#ae81ff>0</span>                               <span style=color:#ae81ff>0.0</span>                    <span style=color:#ae81ff>18.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>5</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>46</span>  <span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>55</span>   <span style=color:#ae81ff>19.0</span>  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>21</span>T0146         <span style=color:#ae81ff>1</span>                               <span style=color:#ae81ff>0.0</span>                    <span style=color:#ae81ff>13.5</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>6</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>20</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>04</span>:<span style=color:#ae81ff>39</span>  <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>28</span>    <span style=color:#ae81ff>8.0</span>  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>20</span>T0439         <span style=color:#ae81ff>4</span>                               <span style=color:#ae81ff>0.0</span>                    <span style=color:#ae81ff>11.5</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>7</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>19</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>02</span>:<span style=color:#ae81ff>37</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>21</span>   <span style=color:#ae81ff>15.0</span>  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>19</span>T0237         <span style=color:#ae81ff>2</span>                               <span style=color:#ae81ff>0.0</span>                    <span style=color:#ae81ff>16.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>8</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>18</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>41</span>  <span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>41</span>   <span style=color:#ae81ff>17.0</span>  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>18</span>T0141         <span style=color:#ae81ff>1</span>                               <span style=color:#ae81ff>0.0</span>                    <span style=color:#ae81ff>18.5</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>9</span>  <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>17</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>02</span>  <span style=color:#ae81ff>21</span>:<span style=color:#ae81ff>38</span>   <span style=color:#ae81ff>20.0</span>  <span style=color:#f92672>...</span>  <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>17</span>T0102         <span style=color:#ae81ff>1</span>                               <span style=color:#ae81ff>0.0</span>                    <span style=color:#ae81ff>18.5</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>10</span> rows x <span style=color:#ae81ff>10</span> columns]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>12</span>]: datasetdf<span style=color:#f92672>.</span>iloc[<span style=color:#ae81ff>0</span>]                                                                                                            
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>12</span>]:
</span></span><span style=display:flex><span>Date                                             <span style=color:#ae81ff>6</span><span style=color:#f92672>/</span><span style=color:#ae81ff>26</span><span style=color:#f92672>/</span><span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Start                                              <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>57</span>
</span></span><span style=display:flex><span>End                                                  NaN
</span></span><span style=display:flex><span>Hours                                                NaN
</span></span><span style=display:flex><span>Night Eating                                         NaN
</span></span><span style=display:flex><span>StartDt                              <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>26</span> <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>57</span>:<span style=color:#ae81ff>00</span>
</span></span><span style=display:flex><span>id                                       <span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>06</span><span style=color:#f92672>-</span><span style=color:#ae81ff>26</span>T0157
</span></span><span style=display:flex><span>StartHour                                              <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>LastTwoFastsStartedBeforeMidnight                    NaN
</span></span><span style=display:flex><span>RollingHoursMean2Fasts                               NaN
</span></span><span style=display:flex><span>Name: <span style=color:#ae81ff>0</span>, dtype: object
</span></span></code></pre></div><h4 id=look-at-rollinghoursmean2fasts-briefly>look at RollingHoursMean2Fasts briefly<a hidden class=anchor aria-hidden=true href=#look-at-rollinghoursmean2fasts-briefly>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pylab
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> date_utils <span style=color:#66d9ef>as</span> du
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>col <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;RollingHoursMean2Fasts&#34;</span>
</span></span><span style=display:flex><span>loc <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>workdir<span style=color:#e6db74>}</span><span style=color:#e6db74>/</span><span style=color:#e6db74>{</span>du<span style=color:#f92672>.</span>utc_ts()<span style=color:#e6db74>}</span><span style=color:#e6db74>-</span><span style=color:#e6db74>{</span>col<span style=color:#e6db74>}</span><span style=color:#e6db74>.png&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> plt<span style=color:#f92672>.</span>style<span style=color:#f92672>.</span>context(<span style=color:#e6db74>&#39;fivethirtyeight&#39;</span>):
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>plot(datasetdf[col]<span style=color:#f92672>.</span>tolist())
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{</span>col<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>    pylab<span style=color:#f92672>.</span>savefig(loc, bbox_inches<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;tight&#39;</span>)
</span></span><span style=display:flex><span>    pylab<span style=color:#f92672>.</span>close()
</span></span></code></pre></div><h4 id=next-4>Next<a hidden class=anchor aria-hidden=true href=#next-4>#</a></h4><ul><li>I think the main next thing to do is to create a &ldquo;y&rdquo; dependent variable for this dataset, which can for example be something like &ldquo;hours fasted in next fast&rdquo; or &ldquo;hours until next fast&rdquo; or &ldquo;proportion of hours fasted in next 7 days&rdquo;.</li><li>And with a dependent variable I can then see how predictive these features are, as a first iteration with only the twofeatures so far.</li><li>And I can continue to add other features too.</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://michal.piekarczyk.xyz/tags/time-series/>time-series</a></li><li><a href=https://michal.piekarczyk.xyz/tags/notebook/>notebook</a></li></ul><nav class=paginav><a class=prev href=https://michal.piekarczyk.xyz/post/2021-08-22/><span class=title>« Prev</span><br><span>Mini NLP Detour Part I</span></a>
<a class=next href=https://michal.piekarczyk.xyz/post/2021-05-07-covid-vaccine-2-temps/><span class=title>Next »</span><br><span>Covid Vaccine 2 Temperatures</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://michal.piekarczyk.xyz/>michal.piekarczyk.xyz</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>