<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Mini scikit-learn backwards compatibility story | michal.piekarczyk.xyz</title><meta name=keywords content><meta name=description content="hmm blah blah test something #publish-this What So I had a particular need to load a #[[scikit learn sklearn]] model trained with 0.20.4 on Databricks 10.4 and ran into some fun details
I was not initially able to use the Databricks 10.4 pinned version of scikit-learn , 0.24.x because of course there were #backwards-compatibility issues where trying to load the model gave me an error saying that ModuleNotFoundError: No module named 'sklearn."><meta name=author content="Michal Piekarczyk"><link rel=canonical href=https://michal.piekarczyk.xyz/post/2022-07-12-mini-scikit-learn-backwards-compatibility-story/><link crossorigin=anonymous href=/assets/css/stylesheet.dd867d536fb6202811c1ee15fa181ef8945826662b49d3016ac91365a2621d58.css integrity="sha256-3YZ9U2+2ICgRwe4V+hge+JRYJmYrSdMBaskTZaJiHVg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://michal.piekarczyk.xyz/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://michal.piekarczyk.xyz/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://michal.piekarczyk.xyz/favicon-32x32.png><link rel=apple-touch-icon href=https://michal.piekarczyk.xyz/apple-touch-icon.png><link rel=mask-icon href=https://michal.piekarczyk.xyz/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-74MK08REDT"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-74MK08REDT",{anonymize_ip:!1})}</script><meta property="og:title" content="Mini scikit-learn backwards compatibility story"><meta property="og:description" content="hmm blah blah test something #publish-this What So I had a particular need to load a #[[scikit learn sklearn]] model trained with 0.20.4 on Databricks 10.4 and ran into some fun details
I was not initially able to use the Databricks 10.4 pinned version of scikit-learn , 0.24.x because of course there were #backwards-compatibility issues where trying to load the model gave me an error saying that ModuleNotFoundError: No module named 'sklearn."><meta property="og:type" content="article"><meta property="og:url" content="https://michal.piekarczyk.xyz/post/2022-07-12-mini-scikit-learn-backwards-compatibility-story/"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-07-12T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-12T00:00:00+00:00"><meta property="og:site_name" content="michal.piekarczyk.xyz"><meta name=twitter:card content="summary"><meta name=twitter:title content="Mini scikit-learn backwards compatibility story"><meta name=twitter:description content="hmm blah blah test something #publish-this What So I had a particular need to load a #[[scikit learn sklearn]] model trained with 0.20.4 on Databricks 10.4 and ran into some fun details
I was not initially able to use the Databricks 10.4 pinned version of scikit-learn , 0.24.x because of course there were #backwards-compatibility issues where trying to load the model gave me an error saying that ModuleNotFoundError: No module named 'sklearn."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://michal.piekarczyk.xyz/post/"},{"@type":"ListItem","position":2,"name":"Mini scikit-learn backwards compatibility story","item":"https://michal.piekarczyk.xyz/post/2022-07-12-mini-scikit-learn-backwards-compatibility-story/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Mini scikit-learn backwards compatibility story","name":"Mini scikit-learn backwards compatibility story","description":"hmm blah blah test something #publish-this What So I had a particular need to load a #[[scikit learn sklearn]] model trained with 0.20.4 on Databricks 10.4 and ran into some fun details\nI was not initially able to use the Databricks 10.4 pinned version of scikit-learn , 0.24.x because of course there were #backwards-compatibility issues where trying to load the model gave me an error saying that ModuleNotFoundError: No module named 'sklearn.","keywords":[],"articleBody":" hmm blah blah test something #publish-this What So I had a particular need to load a #[[scikit learn sklearn]] model trained with 0.20.4 on Databricks 10.4 and ran into some fun details\nI was not initially able to use the Databricks 10.4 pinned version of scikit-learn , 0.24.x because of course there were #backwards-compatibility issues where trying to load the model gave me an error saying that ModuleNotFoundError: No module named 'sklearn.preprocessing.imputation' was not found basically because I learned that all the Imputers were moved over to sklearn.impute\nI tried also just vetting the assumption that I can simply pip install this earlier version of scikit learn. And turned out that well yes I can. But,\nBut then when I try to import sklearn , oops, that gives a strange error\nand trying to look for using #conda to the rescue , well I looked around on https://anaconda.org and I ended up seeing that there is 0.20.2 from cctbx and then I saw 0.20.3 from cdat-forge so then trying that I basically got\n(pandars310) $ conda install -c cdat-forge scikit-learn=0.20.3 Collecting package metadata (current_repodata.json): done Solving environment: failed with initial frozen solve. Retrying with flexible solve. Solving environment: failed with repodata from current_repodata.json, will retry with next repodata source. Collecting package metadata (repodata.json): done Solving environment: failed with initial frozen solve. Retrying with flexible solve. Solving environment: | Found conflicts! Looking for incompatible packages. This can take several minutes. Press CTRL-C to abort. failed UnsatisfiableError: The following specifications were found to be incompatible with the existing python installation in your environment: Specifications: - scikit-learn=0.20.3 -\u003e python[version='\u003e=2.7,\u003c2.8.0a0|\u003e=3.7,\u003c3.8.0a0|\u003e=3.6,\u003c3.7.0a0'] Your python: python=3.10 If python is on the left-most side of the chain, that's the version you've asked for. When python appears to the right, that indicates that the thing on the left is somehow not available for the python version you are constrained to. Note that conda will not change your python version to a different minor version unless you explicitly specify that. So aha I learned that if I want to use this earlier version of scikit learn then I would need \u003c3.8 basically but Databricks 10.4 has pinned python 3.8 so basically that is a no go and this model just needs to be retrained to be used.\n","wordCount":"377","inLanguage":"en","datePublished":"2022-07-12T00:00:00Z","dateModified":"2022-07-12T00:00:00Z","author":{"@type":"Person","name":"Michal Piekarczyk"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://michal.piekarczyk.xyz/post/2022-07-12-mini-scikit-learn-backwards-compatibility-story/"},"publisher":{"@type":"Organization","name":"michal.piekarczyk.xyz","logo":{"@type":"ImageObject","url":"https://michal.piekarczyk.xyz/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://michal.piekarczyk.xyz/ accesskey=h title="michal.piekarczyk.xyz (Alt + H)">michal.piekarczyk.xyz</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://michal.piekarczyk.xyz/post/ title=posts><span>posts</span></a></li><li><a href=https://michal.piekarczyk.xyz/project/ title=projects><span>projects</span></a></li><li><a href=https://michal.piekarczyk.xyz/handy/ title=handy><span>handy</span></a></li><li><a href=https://michal.piekarczyk.xyz/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://michal.piekarczyk.xyz/about/ title=about><span>about</span></a></li><li><a href=https://world.hey.com/michal.piekarczyk title=frivolity><span>frivolity</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://michal.piekarczyk.xyz/>Home</a>&nbsp;»&nbsp;<a href=https://michal.piekarczyk.xyz/post/>Posts</a></div><h1 class=post-title>Mini scikit-learn backwards compatibility story</h1><div class=post-meta><span title='2022-07-12 00:00:00 +0000 UTC'>121212-12-1212</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;377 words&nbsp;·&nbsp;Michal Piekarczyk</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#what>What</a></li></ul></nav></div></details></div><div class=post-content><ul><li>hmm blah blah<ul><li>test something</li></ul></li><li>#publish-this<ul><li><h2 id=what>What<a hidden class=anchor aria-hidden=true href=#what>#</a></h2></li><li><p>So I had a particular need to load a #[[scikit learn sklearn]] model trained with <code>0.20.4</code> on Databricks 10.4 and ran into some fun details</p></li><li><p>I was not initially able to use the Databricks 10.4 pinned version of scikit-learn , 0.24.x because of course there were #backwards-compatibility issues where trying to load the model gave me an error saying that <code>ModuleNotFoundError: No module named 'sklearn.preprocessing.imputation'</code> was not found basically because I learned that all the Imputers were moved over to <code>sklearn.impute</code></p></li><li><p>I tried also just vetting the assumption that I can simply pip install this earlier version of scikit learn. And turned out that well yes I can. But,</p></li><li><p><img loading=lazy src=https://s3.amazonaws.com/my-blog-content/2022/2022-07-12-Mini-scikit-learn-backwards-compatibility-story/IMG_8096.jpg alt=IMG_8096></p></li><li><p>But then when I try to <code>import sklearn</code> , oops, that gives a strange error</p></li><li><p><img loading=lazy src=https://s3.amazonaws.com/my-blog-content/2022/2022-07-12-Mini-scikit-learn-backwards-compatibility-story/IMG_8095.jpg alt=IMG_8095></p></li><li><p>and trying to look for using #conda to the rescue , well I looked around on <a href=https://anaconda.org>https://anaconda.org</a> and I ended up seeing that there is <code>0.20.2</code> from <code>cctbx</code> and then I saw <code>0.20.3</code> from <code>cdat-forge</code> so then trying that I basically got</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>(pandars310) <span style=color:#960050;background-color:#1e0010>$</span> conda install <span style=color:#f92672>-</span>c cdat<span style=color:#f92672>-</span>forge scikit<span style=color:#f92672>-</span>learn<span style=color:#f92672>=</span><span style=color:#ae81ff>0.20.3</span>
</span></span><span style=display:flex><span>Collecting package metadata (current_repodata<span style=color:#f92672>.</span>json): done
</span></span><span style=display:flex><span>Solving environment: failed <span style=color:#66d9ef>with</span> initial frozen solve<span style=color:#f92672>.</span> Retrying <span style=color:#66d9ef>with</span> flexible solve<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Solving environment: failed <span style=color:#66d9ef>with</span> repodata <span style=color:#f92672>from</span> current_repodata.json, will retry <span style=color:#66d9ef>with</span> next repodata source<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Collecting package metadata (repodata<span style=color:#f92672>.</span>json): done
</span></span><span style=display:flex><span>Solving environment: failed <span style=color:#66d9ef>with</span> initial frozen solve<span style=color:#f92672>.</span> Retrying <span style=color:#66d9ef>with</span> flexible solve<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Solving environment: <span style=color:#f92672>|</span> 
</span></span><span style=display:flex><span>Found conflicts<span style=color:#960050;background-color:#1e0010>!</span> Looking <span style=color:#66d9ef>for</span> incompatible packages<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>This can take several minutes<span style=color:#f92672>.</span>  Press CTRL<span style=color:#f92672>-</span>C to abort<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>failed                                                                                         
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>UnsatisfiableError: The following specifications were found
</span></span><span style=display:flex><span>to be incompatible <span style=color:#66d9ef>with</span> the existing python installation <span style=color:#f92672>in</span> your environment:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Specifications:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>-</span> scikit<span style=color:#f92672>-</span>learn<span style=color:#f92672>=</span><span style=color:#ae81ff>0.20.3</span> <span style=color:#f92672>-&gt;</span> python[version<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&gt;=2.7,&lt;2.8.0a0|&gt;=3.7,&lt;3.8.0a0|&gt;=3.6,&lt;3.7.0a0&#39;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Your python: python<span style=color:#f92672>=</span><span style=color:#ae81ff>3.10</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>If python <span style=color:#f92672>is</span> on the left<span style=color:#f92672>-</span>most side of the chain, that<span style=color:#e6db74>&#39;s the version you&#39;</span>ve asked <span style=color:#66d9ef>for</span><span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>When python appears to the right, that indicates that the thing on the left <span style=color:#f92672>is</span> somehow
</span></span><span style=display:flex><span><span style=color:#f92672>not</span> available <span style=color:#66d9ef>for</span> the python version you are constrained to<span style=color:#f92672>.</span> Note that conda will <span style=color:#f92672>not</span>
</span></span><span style=display:flex><span>change your python version to a different minor version unless you explicitly specify
</span></span><span style=display:flex><span>that<span style=color:#f92672>.</span>
</span></span></code></pre></div></li><li><p>So aha I learned that if I want to use this earlier version of scikit learn then I would need <code>&lt;3.8</code> basically but Databricks 10.4 has pinned <code>python 3.8</code> so basically that is a no go and this model just needs to be retrained to be used.</p></li><li></li></ul></li></ul></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://michal.piekarczyk.xyz/post/2022-08-27-backprop-scratch/><span class=title>« Prev</span><br><span>Backprop and SGD From Scratch Part 3</span></a>
<a class=next href=https://michal.piekarczyk.xyz/post/2022-04-10--markdown-table-test/><span class=title>Next »</span><br><span>Tracck those daily permanents</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://michal.piekarczyk.xyz/>michal.piekarczyk.xyz</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>