<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>logseq publish hugo with python | michal.piekarczyk.xyz</title>
<meta name=keywords content><meta name=description content="public:: true blog-date:: 2023-06-12
briefly Inspired by the super popular #[[schrodinger logseq plugin]], I wrote up something in #python today, to publish to #Hugo like https://github.com/sawhney17/logseq-schrodinger but also with support for block embeds.
In particular, I was also really inspired by [[Bas Grolleman]]&rsquo;s concept here around how to be able to use #interstitial-journaling and be able to nicely coalesce selected sources through their block embeds, into a target logseq concept they all refer to."><meta name=author content="Michal Piekarczyk"><link rel=canonical href=https://michal.piekarczyk.xyz/post/2023-06-12-logseq-publish-hugo-with-python/><link crossorigin=anonymous href=/assets/css/stylesheet.dd867d536fb6202811c1ee15fa181ef8945826662b49d3016ac91365a2621d58.css integrity="sha256-3YZ9U2+2ICgRwe4V+hge+JRYJmYrSdMBaskTZaJiHVg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://michal.piekarczyk.xyz/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://michal.piekarczyk.xyz/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://michal.piekarczyk.xyz/favicon-32x32.png><link rel=apple-touch-icon href=https://michal.piekarczyk.xyz/apple-touch-icon.png><link rel=mask-icon href=https://michal.piekarczyk.xyz/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-74MK08REDT"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-74MK08REDT",{anonymize_ip:!1})}</script><meta property="og:title" content="logseq publish hugo with python"><meta property="og:description" content="public:: true blog-date:: 2023-06-12
briefly Inspired by the super popular #[[schrodinger logseq plugin]], I wrote up something in #python today, to publish to #Hugo like https://github.com/sawhney17/logseq-schrodinger but also with support for block embeds.
In particular, I was also really inspired by [[Bas Grolleman]]&rsquo;s concept here around how to be able to use #interstitial-journaling and be able to nicely coalesce selected sources through their block embeds, into a target logseq concept they all refer to."><meta property="og:type" content="article"><meta property="og:url" content="https://michal.piekarczyk.xyz/post/2023-06-12-logseq-publish-hugo-with-python/"><meta property="article:section" content="post"><meta property="article:published_time" content="2023-06-12T00:00:00+00:00"><meta property="article:modified_time" content="2023-06-12T21:05:34-04:00"><meta property="og:site_name" content="michal.piekarczyk.xyz"><meta name=twitter:card content="summary"><meta name=twitter:title content="logseq publish hugo with python"><meta name=twitter:description content="public:: true blog-date:: 2023-06-12
briefly Inspired by the super popular #[[schrodinger logseq plugin]], I wrote up something in #python today, to publish to #Hugo like https://github.com/sawhney17/logseq-schrodinger but also with support for block embeds.
In particular, I was also really inspired by [[Bas Grolleman]]&rsquo;s concept here around how to be able to use #interstitial-journaling and be able to nicely coalesce selected sources through their block embeds, into a target logseq concept they all refer to."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://michal.piekarczyk.xyz/post/"},{"@type":"ListItem","position":2,"name":"logseq publish hugo with python","item":"https://michal.piekarczyk.xyz/post/2023-06-12-logseq-publish-hugo-with-python/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"logseq publish hugo with python","name":"logseq publish hugo with python","description":"public:: true blog-date:: 2023-06-12\nbriefly Inspired by the super popular #[[schrodinger logseq plugin]], I wrote up something in #python today, to publish to #Hugo like https://github.com/sawhney17/logseq-schrodinger but also with support for block embeds.\nIn particular, I was also really inspired by [[Bas Grolleman]]\u0026rsquo;s concept here around how to be able to use #interstitial-journaling and be able to nicely coalesce selected sources through their block embeds, into a target logseq concept they all refer to.","keywords":[],"articleBody":"public:: true blog-date:: 2023-06-12\nbriefly Inspired by the super popular #[[schrodinger logseq plugin]], I wrote up something in #python today, to publish to #Hugo like https://github.com/sawhney17/logseq-schrodinger but also with support for block embeds.\nIn particular, I was also really inspired by [[Bas Grolleman]]‚Äôs concept here around how to be able to use #interstitial-journaling and be able to nicely coalesce selected sources through their block embeds, into a target logseq concept they all refer to.\nFull code from this blog post By the way, this code is still just at the ‚Äúfirst stab‚Äù / #proof-of-concept stage, but it is here, https://github.com/namoopsoo/logseq_utils\nAnd usage is just below Say you have a page ‚Äúblogpost/2023-06-12-name-of-your-logseq-page‚Äù , where you happen to use embeds like,\n{{embed ((64864e08-de92-4127-9162-8b5b946b021b))}} then to create a markdown file like ‚Äúcontent/post/2023-06-12-name-of-your-logseq-page.md‚Äù , locating it in ‚Äúcontent/post/‚Äù say if that is your Hugo post location, then use,\nfrom pathlib import Path import logseq_utils as lu page = \"blogpost/2023-06-12-name-of-your-logseq-page\" filename = page.split(\"/\")[1] + \".md\" target_dir = \"content/post/\" target_loc = str(Path(target_dir) / filename) print(\"target_loc\", target_loc) # target_loc content/post/2023-06-12-logseq-publish-hugo-with-python.md lu.build_markdown(page, target_loc) The logseq REST API Would have loved to help w/ logseq-schrodinger but Ideally I would love to attempt a pull request on https://github.com/sawhney17/logseq-schrodinger , and I have left the block embed as a feature idea here, but my knowledge of the logseq dev setup , including Clojure Script and react is smaller than my desire to first get something working to help solve my immediate problem hah üòÖ.\nBut the logseq REST API looks great! According to https://docs.logseq.com/#/page/local%20http%20server , and https://plugins-doc.logseq.com , looks like one just needs to add a local API token and then you are basically ready to interact with your logseq using ‚Äú127.0.0.1:12315‚Äù\nIterating Using getPageBlocksTree gave the blocks on a page Like this id:: 6487a8b5-ac96-4a45-aa2a-28bbc7002aa4\ndef get_page_blocks_tree(name, include_children=False): token = os.getenv(\"LOGSEQ_TOKEN\") url = \"http://127.0.0.1:12315/api\" headers = {\"Content-Type\": \"application/json\", \"Authorization\": f\"Bearer {token}\"} payload = { \"method\": \"logseq.Editor.getPageBlocksTree\", \"args\": [name, {\"includeChildren\": include_children}] } response = requests.post(url, json=payload, headers=headers) return response A stab at a recursive call here 13:51 ok some simple stab at using this API then, to build #[[log-seq markdown hugo integration]] [[Hugo]] id:: 64875626-e55d-4613-9351-e6a5806e8912 14:27 ok, wrote some code in log_utils.py , and running,\nimport requests import time def build_markdown_from_page_blocks(blocks): print(\"DEBUG\", [x[\"level\"] for x in blocks]) time.sleep(1) stuff = [] for block in blocks: stuff.append({\"level\": block[\"level\"], \"content\": block[\"content\"]}) if block[\"children\"]: stuff.extend(build_markdown_from_page_blocks(block[\"children\"])) return stuff page = \"blogpost/2023-06-11-semantic-code-search-first-stab\" response = lu.get_page_blocks_tree(page) response.status_code blocks = response.json() len(blocks) # 4 stuff = lu.build_markdown_from_page_blocks(blocks) ok nice haha worked on first try as intended #moment/satisfaction üòÄ\nIn [57]: stuff = lu.build_markdown_from_page_blocks(blocks) DEBUG [1, 1, 1, 1] DEBUG [2, 2] DEBUG [3, 3, 3] DEBUG [2, 2, 2, 2, 2, 2, 2] DEBUG [3, 3] [{'level': 1, 'content': 'public:: true'}, {'level': 1, 'content': ''}, {'level': 1, 'content': '# Initial Learnings'}, {'level': 2, 'content': '## Learned about [[symmetric vs asymmetric semantic search]]'}, {'level': 3, 'content': 'This distinction refers to #[[sentence similarity task]] where the query is of the same size or asymmetrically, smaller size, such as a one or two word query.'}, {'level': 3, 'content': 'And wow that is exactly what. Iwas looking for !'}, {'level': 3, 'content': 'So apparently this includes the \"msmarco\" models.'}, {'level': 2, 'content': ''}, {'level': 1, 'content': '# Final test run'}, {'level': 2, 'content': 'Idea is to build a corpus with, hey why not, the code from the #sentence-transformers repo.'}, {'level': 2, 'content': 'Had a few test runs today, iterating on the approach, using queries from files other than the ones I built a corpus for , #moment/doh haha . Also weirdly the msmarco model documented as the v3 that should be used is MIA somehow, but the v2 seems fine. And \"msmarco-MiniLM-L-6-v3\" is fine too. \\n\\nBut here is the last run for today.'}, {'level': 2, 'content': '{{embed ((64864e08-de92-4127-9162-8b5b946b021b))}}'}, {'level': 2, 'content': '## And code for building that corpus'}, {'level': 3, 'content': '{{embed ((648728d8-5958-4df6-95d4-b81de6665974))}}'}, {'level': 3, 'content': ''}, {'level': 2, 'content': ''}, {'level': 2, 'content': ''}, {'level': 2, 'content': ''}] And then filling out the embeds 14:47 ok just need to fill the embeds with the block embed outputs then, id:: 648764a3-6ede-4550-82cf-5ce07e765ac0 14:56,\nimport re block = {\"content\": \"{{embed ((648728d8-5958-4df6-95d4-b81de6665974))}}\"} if match := re.match( r\"^{{embed \\(\\(([a-zA-Z0-9-]+)\\)\\)}}$\", block[\"content\"] ): print(\"yes\", match.groups()[0]) # yes 648728d8-5958-4df6-95d4-b81de6665974 hmm so for instance if we have the block below, which is at level 3,\n{'properties': {}, 'unordered': True, 'parent': {'id': 28919}, 'children': [], 'id': 29214, 'pathRefs': [{'id': 28906}, {'id': 29113}, {'id': 29220}], 'level': 3, 'uuid': '64875997-b4fd-4079-9a06-19b1606d5f33', 'content': '{{embed ((648728d8-5958-4df6-95d4-b81de6665974))}}', 'journal?': False, 'macros': [{'id': 29221}], 'page': {'id': 28906}, 'left': {'id': 28919}, 'format': 'markdown', 'refs': [{'id': 29113}, {'id': 29220}]} And we fetch the block ‚Äú648728d8-5958-4df6-95d4-b81de6665974‚Äù , collapsed:: true\nIn [59]: block_uuid = \"648728d8-5958-4df6-95d4-b81de6665974\" In [60]: response = lu.get_block(block_uuid) In [61]: response.json() Out[61]: {'properties': {'id': '648728d8-5958-4df6-95d4-b81de6665974'}, 'parent': {'id': 28846}, 'children': [{'properties': {}, 'parent': {'id': 29113}, 'children': [], 'id': 29219, 'pathRefs': [{'id': 28}, {'id': 1967}, {'id': 5812}, {'id': 27790}, {'id': 27795}, {'id': 28383}, {'id': 28504}, {'id': 28556}, {'id': 28906}, {'id': 28907}], 'level': 1, 'uuid': '64875a31-5142-4f50-a542-5d5c00021cb4', 'content': 'Put the following into a file `code_search.py`\\n```python\\nfrom pathlib import Path\\nfrom itertools import chain\\n\\n\\ndef build_texts_from_repository(repo_dir):\\n \"\"\"Return a dataset of the code\\n \"\"\"\\n dataset = []\\n file_types = []\\n for path in chain(\\n Path(repo_dir).glob(\"**/*.py\"),\\n Path(repo_dir).glob(\"**/*.md\"),\\n ):\\n assert path.is_file() and path.suffix\\n lines = path.read_text().splitlines()\\n \\n dataset.extend(\\n [{\"line_number\": i,\\n \"line\": line,\\n \"path\": str(path.relative_to(repo_dir))}\\n for i, line in enumerate(lines)\\n ]\\n )\\n return dataset\\n\\n```', 'page': {'journalDay': 20230611, 'name': 'jun 11th, 2023', 'originalName': 'Jun 11th, 2023', 'id': 28504}, 'left': {'id': 29113}, 'format': 'markdown'}, {'properties': {}, 'parent': {'id': 29113}, 'children': [], 'id': 29218, 'pathRefs': [{'id': 28}, {'id': 1967}, {'id': 5812}, {'id': 27790}, {'id': 27795}, {'id': 28383}, {'id': 28504}, {'id': 28556}, {'id': 28906}, {'id': 28907}], 'level': 1, 'uuid': '64875a2e-7b2a-47fb-891b-419cd3347643', 'content': '```python\\nimport os\\nimport code_search as cs\\nfrom pathlib import Path\\nrepos_dir = os.getenv(\"REPOS_DIR\")\\ntarget_dir = Path(repos_dir) / \"sentence-transformers\"\\ndataset = cs.build_texts_from_repository(target_dir)\\n\\n```\\ndouble checking , \\n```python\\n\\nIn [12]: dataset[:10]\\nOut[12]: \\n[{\\'line_number\\': 0,\\n \\'line\\': \\'from setuptools import setup, find_packages\\',\\n \\'path\\': \\'setup.py\\'},\\n {\\'line_number\\': 1, \\'line\\': \\'\\', \\'path\\': \\'setup.py\\'},\\n {\\'line_number\\': 2,\\n \\'line\\': \\'with open(\"README.md\", mode=\"r\", encoding=\"utf-8\") as readme_file:\\',\\n \\'path\\': \\'setup.py\\'},\\n {\\'line_number\\': 3,\\n \\'line\\': \\' readme = readme_file.read()\\',\\n \\'path\\': \\'setup.py\\'},\\n {\\'line_number\\': 4, \\'line\\': \\'\\', \\'path\\': \\'setup.py\\'},\\n {\\'line_number\\': 5, \\'line\\': \\'\\', \\'path\\': \\'setup.py\\'},\\n {\\'line_number\\': 6, \\'line\\': \\'\\', \\'path\\': \\'setup.py\\'},\\n {\\'line_number\\': 7, \\'line\\': \\'setup(\\', \\'path\\': \\'setup.py\\'},\\n {\\'line_number\\': 8,\\n \\'line\\': \\' name=\"sentence-transformers\",\\',\\n \\'path\\': \\'setup.py\\'},\\n {\\'line_number\\': 9, \\'line\\': \\' version=\"2.2.2\",\\', \\'path\\': \\'setup.py\\'}]\\n\\nIn [13]: set([Path(x[\"path\"]).suffix for x in dataset])\\nOut[13]: {\\'.md\\', \\'.py\\'}\\n```', 'page': {'journalDay': 20230611, 'name': 'jun 11th, 2023', 'originalName': 'Jun 11th, 2023', 'id': 28504}, 'left': {'id': 29219}, 'format': 'markdown'}], 'id': 29113, 'pathRefs': [{'id': 28}, {'id': 1967}, {'id': 5812}, {'id': 27790}, {'id': 27795}, {'id': 28383}, {'id': 28504}, {'id': 28556}, {'id': 28906}, {'id': 28907}], 'propertiesTextValues': {'id': '648728d8-5958-4df6-95d4-b81de6665974'}, 'uuid': '648728d8-5958-4df6-95d4-b81de6665974', 'content': 'ok cool, let me just focus on markdown and python\\nid:: 648728d8-5958-4df6-95d4-b81de6665974', 'page': {'journalDay': 20230611, 'name': 'jun 11th, 2023', 'originalName': 'Jun 11th, 2023', 'id': 28504}, 'left': {'id': 29215}, 'format': 'markdown', 'refs': [{'id': 29214}]} 15:12 hmm strangely it does not have its own level and its children start from level 1, so maybe this is meant to be incremental sort of. 15:26 ok added some kind of offset then\ndef build_markdown_from_page_blocks(blocks, level_offset=0): print(\"DEBUG\", [x[\"level\"] for x in blocks]) stuff = [] for block in blocks: # Replace embed if match := re.match( r\"^{{embed \\(\\(([a-zA-Z0-9-]+)\\)\\)}}$\", block[\"content\"] ): block_uuid = match.groups()[0] print(\"yes\", block_uuid) response = get_block(block_uuid) assert response.status_code == 200 new_block = response.json() new_block[\"level\"] = block[\"level\"] stuff.append({\"level\": new_block[\"level\"], \"content\": new_block[\"content\"]}) if new_block[\"children\"]: stuff.extend( build_markdown_from_page_blocks( new_block[\"children\"], level_offset=(level_offset + new_block[\"level\"]) )) else: stuff.append( {\"level\": block[\"level\"] + level_offset, \"content\": block[\"content\"]}) if block[\"children\"]: stuff.extend( build_markdown_from_page_blocks( block[\"children\"], level_offset=level_offset) ) return stuff And the markdown output 15:26 ok then now , to generate the markdown, id:: 64877179-6d5e-4a1a-88ef-7826edf78ee5 Did this in a super simple way,\ndef build_markdown(page_name, target_loc): response = get_page(page_name) assert response.status_code == 200 and response.json() response = get_page_blocks_tree(page_name) assert response.status_code == 200 and response.json() blocks = response.json() blog_date = blocks[0][\"properties\"][\"blogDate\"] stuff = build_markdown_from_page_blocks(blocks) page_title = page_name.split(\"/\")[1] # if match := re.match(r\"(\\d{4}-\\d{2}-\\d{2})-(.*)\", page_title): date_from_title, page_title = match.groups() print(\"page_title\", page_title) page_title = page_title.replace(\"-\", \" \") print(\"page_title\", page_title) text = [ \"---\", f\"date: {date_from_title}\", f\"title: {page_title}\", \"---\", ] + [x[\"content\"] for x in stuff] path = Path(target_loc) assert path.parent.is_dir() path.write_text(\"\\n\".join(text)) ... 15:50 ok lets try this,\ntarget_dir = \"content/post/\" # 2023-06-12-spinoza-vs-descartes.md page = \"blogpost/2023-06-11-semantic-code-search-first-stab\" filename = page.split(\"/\")[1] + \".md\" target_loc = str(Path(target_dir) / filename) print(\"target_loc\", target_loc) # 'content/post/2023-06-11-semantic-code-search-first-stab.md' lu.build_markdown(page, target_loc) So per above, the first page built ended up being this page And the second page was actually this one\nSome tips no hyphens in your API token Oddly enough I was getting\nOut[12]: {'statusCode': 401, 'error': 'Unauthorized', 'message': 'Access Denied!'} and then switched to a token without hyphens and it was fine.\nThe right REST endpoint Initially I was getting a 404 'Route POST:/ not found' when hitting\nurl = \"http://127.0.0.1:12315\" as opposed to\nurl = \"http://127.0.0.1:12315/api\" getPage returned no children Oddly enough, hitting https://plugins-doc.logseq.com/logseq/Editor/getPage on a valid page, even with setting includeChildren to true, I was getting a 200 but an empty response payload. However, I found using https://plugins-doc.logseq.com/logseq/Editor/getPageBlocksTree gave me all the child blocks for a page.\nMaybe that is the intended behavior, but I‚Äôm not sure.\nRetrieving a page with a literal slash worked but not with the ‚Äú%2F‚Äù 12:52 let me try getting a page too, id:: 64874d2d-6999-48bb-b19a-a6cba44c4f96\ndef get_page(name, include_children=False): token = os.getenv(\"LOGSEQ_TOKEN\") url = \"http://127.0.0.1:12315/api\" headers = {\"Content-Type\": \"application/json\", \"Authorization\": f\"Bearer {token}\"} payload = { \"method\": \"logseq.Editor.getPage\", \"args\": [name, {\"includeChildren\": include_children}] } response = requests.post(url, json=payload, headers=headers) return response response = get_page( \"blogpost%2F2023-06-11-semantic-code-search-first-stab\" ) response.status_code hmm weird saying it got a page but response.json() is null. Ok, trying by id now, and below, this is working now,\nresponse = get_page(28504) In [12]: response.json() Out[12]: {'updatedAt': 1686580509936, 'journalDay': 20230611, 'createdAt': 1686463272305, 'id': 28504, 'name': 'jun 11th, 2023', 'uuid': '648728d8-8c86-4afd-8bb2-4cd519ec4c76', 'journal?': True, 'originalName': 'Jun 11th, 2023', 'file': {'id': 28527}, 'format': 'markdown'} ok but then how to get a page by name then? 13:06 ok interesting, so I tried again but this time instead of the ‚Äú%2F‚Äù where the ‚Äú/‚Äù forward slash is, using the literal, and now worked ! collapsed:: true\nIn [13]: response = get_page( ...: \"blogpost/2023-06-11-semantic-code-search-first-stab\" ...: ) ...: response.status_code Out[13]: 200 In [14]: response.json() Out[14]: {'properties': {'public': True}, 'updatedAt': 1686526563885, 'createdAt': 1686526225155, 'id': 28906, 'propertiesTextValues': {'public': 'true'}, 'name': 'blogpost/2023-06-11-semantic-code-search-first-stab', 'uuid': '648728d8-d545-42ce-b487-986d6cac3d55', 'journal?': False, 'originalName': 'blogpost/2023-06-11-semantic-code-search-first-stab', 'file': {'id': 28909}, 'namespace': {'id': 28907}, 'format': 'markdown'} ok\n","wordCount":"1683","inLanguage":"en","datePublished":"2023-06-12T00:00:00Z","dateModified":"2023-06-12T21:05:34-04:00","author":{"@type":"Person","name":"Michal Piekarczyk"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://michal.piekarczyk.xyz/post/2023-06-12-logseq-publish-hugo-with-python/"},"publisher":{"@type":"Organization","name":"michal.piekarczyk.xyz","logo":{"@type":"ImageObject","url":"https://michal.piekarczyk.xyz/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://michal.piekarczyk.xyz/ accesskey=h title="michal.piekarczyk.xyz (Alt + H)">michal.piekarczyk.xyz</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://michal.piekarczyk.xyz/post/ title=posts><span>posts</span></a></li><li><a href=https://michal.piekarczyk.xyz/project/ title=projects><span>projects</span></a></li><li><a href=https://michal.piekarczyk.xyz/handy/ title=handy><span>handy</span></a></li><li><a href=https://michal.piekarczyk.xyz/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://michal.piekarczyk.xyz/about/ title=about><span>about</span></a></li><li><a href=https://world.hey.com/michal.piekarczyk title=frivolity><span>frivolity</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://michal.piekarczyk.xyz/>Home</a>&nbsp;¬ª&nbsp;<a href=https://michal.piekarczyk.xyz/post/>Posts</a></div><h1 class=post-title>logseq publish hugo with python</h1><div class=post-meta>&lt;span title='2023-06-12 00:00:00 +0000 UTC'>June 12, 2023&lt;/span>&amp;nbsp;¬∑&amp;nbsp;8 min&amp;nbsp;¬∑&amp;nbsp;1683 words&amp;nbsp;¬∑&amp;nbsp;Michal Piekarczyk</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#full-code-from-this-blog-post>Full code from this blog post</a><ul><li><a href=#and-usage-is-just-below>And usage is just below</a></li></ul></li></ul><ul><li><a href=#would-have-loved-to-help-w-logseq-schrodinger-but>Would have loved to help w/ logseq-schrodinger but</a></li><li><a href=#but-the-logseq-rest-api-looks-great>But the logseq REST API looks great!</a></li></ul><ul><li><a href=#using-getpageblockstree-gave-the-blocks-on-a-page>Using getPageBlocksTree gave the blocks on a page</a><ul><li><a href=#like-this>Like this</a></li><li><a href=#a-stab-at-a-recursive-call-here>A stab at a recursive call here</a></li><li><a href=#and-then-filling-out-the-embeds>And then filling out the embeds</a></li><li><a href=#and-the-markdown-output>And the markdown output</a></li></ul></li><li><a href=#some-tips>Some tips</a><ul><li><a href=#no-hyphens-in-your-api-token>no hyphens in your API token</a></li><li><a href=#the-right-rest-endpoint>The right REST endpoint</a></li><li><a href=#getpage-returned-no-children>getPage returned no children</a></li><li><a href=#retrieving-a-page-with-a-literal-slash-worked-but-not-with-the-2f>Retrieving a page with a literal slash worked but not with the &ldquo;%2F&rdquo;</a></li></ul></li></ul></nav></div></details></div><div class=post-content><p>public:: true
blog-date:: 2023-06-12</p><h1 id=briefly>briefly<a hidden class=anchor aria-hidden=true href=#briefly>#</a></h1><p>Inspired by the super popular #[[schrodinger logseq plugin]], I wrote up something in #python today, to publish to #Hugo like <a href=https://github.com/sawhney17/logseq-schrodinger>https://github.com/sawhney17/logseq-schrodinger</a> but also with support for block embeds.</p><p>In particular, I was also really inspired by [[Bas Grolleman]]&rsquo;s concept <a href=https://youtu.be/CPMuGn2d8po>here</a> around how to be able to use #interstitial-journaling and be able to nicely coalesce selected sources through their block embeds, into a target logseq concept they all refer to.</p><h2 id=full-code-from-this-blog-post>Full code from this blog post<a hidden class=anchor aria-hidden=true href=#full-code-from-this-blog-post>#</a></h2><p>By the way, this code is still just at the &ldquo;first stab&rdquo; / #proof-of-concept stage, but it is here,
<a href=https://github.com/namoopsoo/logseq_utils>https://github.com/namoopsoo/logseq_utils</a></p><h3 id=and-usage-is-just-below>And usage is just below<a hidden class=anchor aria-hidden=true href=#and-usage-is-just-below>#</a></h3><p>Say you have a page &ldquo;blogpost/2023-06-12-name-of-your-logseq-page&rdquo; , where you happen to use embeds like,</p><pre tabindex=0><code>{{embed ((64864e08-de92-4127-9162-8b5b946b021b))}}
</code></pre><p>then to create a markdown file like &ldquo;content/post/2023-06-12-name-of-your-logseq-page.md&rdquo; , locating it in &ldquo;content/post/&rdquo; say if that is your Hugo post location, then use,</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pathlib <span style=color:#f92672>import</span> Path
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> logseq_utils <span style=color:#66d9ef>as</span> lu
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>page <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;blogpost/2023-06-12-name-of-your-logseq-page&#34;</span>
</span></span><span style=display:flex><span>filename <span style=color:#f92672>=</span> page<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;/&#34;</span>)[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.md&#34;</span>
</span></span><span style=display:flex><span>target_dir <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;content/post/&#34;</span>
</span></span><span style=display:flex><span>target_loc <span style=color:#f92672>=</span> str(Path(target_dir) <span style=color:#f92672>/</span> filename)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;target_loc&#34;</span>, target_loc)
</span></span><span style=display:flex><span><span style=color:#75715e># target_loc content/post/2023-06-12-logseq-publish-hugo-with-python.md</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>lu<span style=color:#f92672>.</span>build_markdown(page, target_loc)
</span></span></code></pre></div><h1 id=the-logseq-rest-api>The logseq REST API<a hidden class=anchor aria-hidden=true href=#the-logseq-rest-api>#</a></h1><h2 id=would-have-loved-to-help-w-logseq-schrodinger-but>Would have loved to help w/ logseq-schrodinger but<a hidden class=anchor aria-hidden=true href=#would-have-loved-to-help-w-logseq-schrodinger-but>#</a></h2><p>Ideally I would love to attempt a pull request on <a href=https://github.com/sawhney17/logseq-schrodinger>https://github.com/sawhney17/logseq-schrodinger</a> , and I have left the block embed as a feature idea <a href=https://github.com/sawhney17/logseq-schrodinger/issues/35>here</a>, but my knowledge of the logseq <a href=https://github.com/logseq/logseq/blob/master/docs/develop-logseq.md>dev setup</a> , including Clojure Script and react is smaller than my desire to first get something working to help solve my immediate problem hah üòÖ.</p><h2 id=but-the-logseq-rest-api-looks-great>But the logseq REST API looks great!<a hidden class=anchor aria-hidden=true href=#but-the-logseq-rest-api-looks-great>#</a></h2><p>According to <a href=https://docs.logseq.com/#/page/local%20http%20server>https://docs.logseq.com/#/page/local%20http%20server</a> , and <a href=https://plugins-doc.logseq.com>https://plugins-doc.logseq.com</a> , looks like one just needs to add a local API token and then you are basically ready to interact with your logseq using &ldquo;127.0.0.1:12315&rdquo;</p><h1 id=iterating>Iterating<a hidden class=anchor aria-hidden=true href=#iterating>#</a></h1><h2 id=using-getpageblockstree-gave-the-blocks-on-a-page>Using getPageBlocksTree gave the blocks on a page<a hidden class=anchor aria-hidden=true href=#using-getpageblockstree-gave-the-blocks-on-a-page>#</a></h2><h3 id=like-this>Like this<a hidden class=anchor aria-hidden=true href=#like-this>#</a></h3><p>id:: 6487a8b5-ac96-4a45-aa2a-28bbc7002aa4</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_page_blocks_tree</span>(name, include_children<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>):
</span></span><span style=display:flex><span>    token <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#34;LOGSEQ_TOKEN&#34;</span>)
</span></span><span style=display:flex><span>    url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;http://127.0.0.1:12315/api&#34;</span>
</span></span><span style=display:flex><span>    headers <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;Content-Type&#34;</span>: <span style=color:#e6db74>&#34;application/json&#34;</span>,
</span></span><span style=display:flex><span>              <span style=color:#e6db74>&#34;Authorization&#34;</span>: <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Bearer </span><span style=color:#e6db74>{</span>token<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>}
</span></span><span style=display:flex><span>    payload <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;method&#34;</span>: <span style=color:#e6db74>&#34;logseq.Editor.getPageBlocksTree&#34;</span>,  
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;args&#34;</span>: [name, 
</span></span><span style=display:flex><span>               {<span style=color:#e6db74>&#34;includeChildren&#34;</span>: include_children}]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    response <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(url, json<span style=color:#f92672>=</span>payload, headers<span style=color:#f92672>=</span>headers)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> response
</span></span><span style=display:flex><span>  
</span></span></code></pre></div><h3 id=a-stab-at-a-recursive-call-here>A stab at a recursive call here<a hidden class=anchor aria-hidden=true href=#a-stab-at-a-recursive-call-here>#</a></h3><p>13:51 ok some simple stab at using this API then, to build #[[log-seq markdown hugo integration]] [[Hugo]]
id:: 64875626-e55d-4613-9351-e6a5806e8912
14:27 ok, wrote some code in <code>log_utils.py</code> , and running,</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>build_markdown_from_page_blocks</span>(blocks):
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;DEBUG&#34;</span>, [x[<span style=color:#e6db74>&#34;level&#34;</span>] <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> blocks])
</span></span><span style=display:flex><span>    time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    stuff <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> block <span style=color:#f92672>in</span> blocks:
</span></span><span style=display:flex><span>        stuff<span style=color:#f92672>.</span>append({<span style=color:#e6db74>&#34;level&#34;</span>: block[<span style=color:#e6db74>&#34;level&#34;</span>], <span style=color:#e6db74>&#34;content&#34;</span>: block[<span style=color:#e6db74>&#34;content&#34;</span>]})
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> block[<span style=color:#e6db74>&#34;children&#34;</span>]:
</span></span><span style=display:flex><span>            stuff<span style=color:#f92672>.</span>extend(build_markdown_from_page_blocks(block[<span style=color:#e6db74>&#34;children&#34;</span>]))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> stuff
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>page <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;blogpost/2023-06-11-semantic-code-search-first-stab&#34;</span>
</span></span><span style=display:flex><span>response <span style=color:#f92672>=</span> lu<span style=color:#f92672>.</span>get_page_blocks_tree(page)
</span></span><span style=display:flex><span>response<span style=color:#f92672>.</span>status_code
</span></span><span style=display:flex><span>blocks <span style=color:#f92672>=</span> response<span style=color:#f92672>.</span>json()
</span></span><span style=display:flex><span>len(blocks)  <span style=color:#75715e># 4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>stuff <span style=color:#f92672>=</span> lu<span style=color:#f92672>.</span>build_markdown_from_page_blocks(blocks)
</span></span></code></pre></div><p>ok nice haha worked on first try as intended #moment/satisfaction üòÄ</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>In <span style=color:#f92672>[</span>57<span style=color:#f92672>]</span>: stuff <span style=color:#f92672>=</span> lu.build_markdown_from_page_blocks<span style=color:#f92672>(</span>blocks<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>DEBUG <span style=color:#f92672>[</span>1, 1, 1, 1<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>DEBUG <span style=color:#f92672>[</span>2, 2<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>DEBUG <span style=color:#f92672>[</span>3, 3, 3<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>DEBUG <span style=color:#f92672>[</span>2, 2, 2, 2, 2, 2, 2<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>DEBUG <span style=color:#f92672>[</span>3, 3<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[{</span><span style=color:#e6db74>&#39;level&#39;</span>: 1, <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;public:: true&#39;</span><span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span> <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;level&#39;</span>: 1, <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span> <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;level&#39;</span>: 1, <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;# Initial Learnings&#39;</span><span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span> <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;level&#39;</span>: 2,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;## Learned about [[symmetric vs asymmetric semantic search]]&#39;</span><span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span> <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;level&#39;</span>: 3,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;This distinction refers to #[[sentence similarity task]] where the query is of the same size or asymmetrically, smaller size, such as a one or two word query.&#39;</span><span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span> <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;level&#39;</span>: 3, <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;And wow that is exactly what. Iwas looking for !&#39;</span><span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span> <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;level&#39;</span>: 3, <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;So apparently this includes the &#34;msmarco&#34; models.&#39;</span><span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span> <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;level&#39;</span>: 2, <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span> <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;level&#39;</span>: 1, <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;# Final test run&#39;</span><span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span> <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;level&#39;</span>: 2,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;Idea is to build a corpus with, hey why not, the code from the #sentence-transformers repo.&#39;</span><span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span> <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;level&#39;</span>: 2,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;Had a few test runs today, iterating on the approach, using queries from files other than the ones I built a corpus for , #moment/doh haha . Also weirdly the msmarco model documented as the v3 that should be used is MIA somehow, but the v2 seems fine. And &#34;msmarco-MiniLM-L-6-v3&#34; is fine too. \n\nBut here is the last run for today.&#39;</span><span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span> <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;level&#39;</span>: 2, <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;{{embed ((64864e08-de92-4127-9162-8b5b946b021b))}}&#39;</span><span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span> <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;level&#39;</span>: 2, <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;## And code for building that corpus&#39;</span><span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span> <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;level&#39;</span>: 3, <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;{{embed ((648728d8-5958-4df6-95d4-b81de6665974))}}&#39;</span><span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span> <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;level&#39;</span>: 3, <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span> <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;level&#39;</span>: 2, <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span> <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;level&#39;</span>: 2, <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span> <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;level&#39;</span>: 2, <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>}]</span>
</span></span></code></pre></div><h3 id=and-then-filling-out-the-embeds>And then filling out the embeds<a hidden class=anchor aria-hidden=true href=#and-then-filling-out-the-embeds>#</a></h3><p>14:47 ok just need to fill the embeds with the block embed outputs then,
id:: 648764a3-6ede-4550-82cf-5ce07e765ac0
14:56,</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> re
</span></span><span style=display:flex><span>block <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;content&#34;</span>: <span style=color:#e6db74>&#34;{{embed ((648728d8-5958-4df6-95d4-b81de6665974))}}&#34;</span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#66d9ef>match</span> <span style=color:#f92672>:=</span> re<span style=color:#f92672>.</span><span style=color:#66d9ef>match</span>(
</span></span><span style=display:flex><span>  <span style=color:#e6db74>r</span><span style=color:#e6db74>&#34;^{{embed \(\(([a-zA-Z0-9-]+)\)\)}}$&#34;</span>,
</span></span><span style=display:flex><span>  block[<span style=color:#e6db74>&#34;content&#34;</span>]
</span></span><span style=display:flex><span>):
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;yes&#34;</span>, <span style=color:#66d9ef>match</span><span style=color:#f92672>.</span>groups()[<span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># yes 648728d8-5958-4df6-95d4-b81de6665974</span>
</span></span></code></pre></div><p>hmm so for instance if we have the block below, which is at level 3,</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>{<span style=color:#e6db74>&#39;properties&#39;</span>: {},
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;unordered&#39;</span>: <span style=color:#66d9ef>True</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;parent&#39;</span>: {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28919</span>},
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;children&#39;</span>: [],
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>29214</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;pathRefs&#39;</span>: [{<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28906</span>}, {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>29113</span>}, {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>29220</span>}],
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;level&#39;</span>: <span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;uuid&#39;</span>: <span style=color:#e6db74>&#39;64875997-b4fd-4079-9a06-19b1606d5f33&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;{{embed ((648728d8-5958-4df6-95d4-b81de6665974))}}&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;journal?&#39;</span>: <span style=color:#66d9ef>False</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;macros&#39;</span>: [{<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>29221</span>}],
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;page&#39;</span>: {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28906</span>},
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;left&#39;</span>: {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28919</span>},
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;format&#39;</span>: <span style=color:#e6db74>&#39;markdown&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;refs&#39;</span>: [{<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>29113</span>}, {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>29220</span>}]}
</span></span></code></pre></div><p>And we fetch the block &ldquo;648728d8-5958-4df6-95d4-b81de6665974&rdquo; ,
collapsed:: true</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>In [<span style=color:#ae81ff>59</span>]: block_uuid <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;648728d8-5958-4df6-95d4-b81de6665974&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>60</span>]: response <span style=color:#f92672>=</span> lu<span style=color:#f92672>.</span>get_block(block_uuid)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>61</span>]: response<span style=color:#f92672>.</span>json()
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>61</span>]: 
</span></span><span style=display:flex><span>{<span style=color:#e6db74>&#39;properties&#39;</span>: {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#e6db74>&#39;648728d8-5958-4df6-95d4-b81de6665974&#39;</span>},
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;parent&#39;</span>: {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28846</span>},
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;children&#39;</span>: [{<span style=color:#e6db74>&#39;properties&#39;</span>: {},
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;parent&#39;</span>: {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>29113</span>},
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;children&#39;</span>: [],
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>29219</span>,
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;pathRefs&#39;</span>: [{<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>1967</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>5812</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>27790</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>27795</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28383</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28504</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28556</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28906</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28907</span>}],
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;level&#39;</span>: <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;uuid&#39;</span>: <span style=color:#e6db74>&#39;64875a31-5142-4f50-a542-5d5c00021cb4&#39;</span>,
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;Put the following into a file `code_search.py`</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>```python</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>from pathlib import Path</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>from itertools import chain</span><span style=color:#ae81ff>\n\n\n</span><span style=color:#e6db74>def build_texts_from_repository(repo_dir):</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>    &#34;&#34;&#34;Return a dataset of the code</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>    &#34;&#34;&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>    dataset = []</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>    file_types = []</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>    for path in chain(</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>        Path(repo_dir).glob(&#34;**/*.py&#34;),</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>        Path(repo_dir).glob(&#34;**/*.md&#34;),</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>    ):</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>        assert path.is_file() and path.suffix</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>        lines = path.read_text().splitlines()</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>        </span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>        dataset.extend(</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>            [{&#34;line_number&#34;: i,</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>               &#34;line&#34;: line,</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>               &#34;path&#34;: str(path.relative_to(repo_dir))}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>        for i, line in enumerate(lines)</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>         ]</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>        )</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>    return dataset</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>```&#39;</span>,
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;page&#39;</span>: {<span style=color:#e6db74>&#39;journalDay&#39;</span>: <span style=color:#ae81ff>20230611</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;name&#39;</span>: <span style=color:#e6db74>&#39;jun 11th, 2023&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;originalName&#39;</span>: <span style=color:#e6db74>&#39;Jun 11th, 2023&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28504</span>},
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;left&#39;</span>: {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>29113</span>},
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;format&#39;</span>: <span style=color:#e6db74>&#39;markdown&#39;</span>},
</span></span><span style=display:flex><span>  {<span style=color:#e6db74>&#39;properties&#39;</span>: {},
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;parent&#39;</span>: {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>29113</span>},
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;children&#39;</span>: [],
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>29218</span>,
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;pathRefs&#39;</span>: [{<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>1967</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>5812</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>27790</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>27795</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28383</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28504</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28556</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28906</span>},
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28907</span>}],
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;level&#39;</span>: <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;uuid&#39;</span>: <span style=color:#e6db74>&#39;64875a2e-7b2a-47fb-891b-419cd3347643&#39;</span>,
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;```python</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>import os</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>import code_search as cs</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>from pathlib import Path</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>repos_dir = os.getenv(&#34;REPOS_DIR&#34;)</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>target_dir = Path(repos_dir) / &#34;sentence-transformers&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>dataset = cs.build_texts_from_repository(target_dir)</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>```</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>double checking , </span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>```python</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>In [12]: dataset[:10]</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Out[12]: </span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>[{</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line_number</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: 0,</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>  </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>from setuptools import setup, find_packages</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>,</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>  </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>path</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>setup.py</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>},</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74> {</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line_number</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: 1, </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;\&#39;</span><span style=color:#e6db74>, </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>path</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>setup.py</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>},</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74> {</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line_number</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: 2,</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>  </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>with open(&#34;README.md&#34;, mode=&#34;r&#34;, encoding=&#34;utf-8&#34;) as readme_file:</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>,</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>  </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>path</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>setup.py</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>},</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74> {</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line_number</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: 3,</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>  </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>    readme = readme_file.read()</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>,</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>  </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>path</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>setup.py</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>},</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74> {</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line_number</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: 4, </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;\&#39;</span><span style=color:#e6db74>, </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>path</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>setup.py</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>},</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74> {</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line_number</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: 5, </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;\&#39;</span><span style=color:#e6db74>, </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>path</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>setup.py</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>},</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74> {</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line_number</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: 6, </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;\&#39;</span><span style=color:#e6db74>, </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>path</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>setup.py</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>},</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74> {</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line_number</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: 7, </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>setup(</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>, </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>path</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>setup.py</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>},</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74> {</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line_number</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: 8,</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>  </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>    name=&#34;sentence-transformers&#34;,</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>,</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>  </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>path</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>setup.py</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>},</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74> {</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line_number</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: 9, </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>line</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>    version=&#34;2.2.2&#34;,</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>, </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>path</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>: </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>setup.py</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>}]</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>In [13]: set([Path(x[&#34;path&#34;]).suffix for x in dataset])</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Out[13]: {</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>.md</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>, </span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>.py</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>```&#39;</span>,
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;page&#39;</span>: {<span style=color:#e6db74>&#39;journalDay&#39;</span>: <span style=color:#ae81ff>20230611</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;name&#39;</span>: <span style=color:#e6db74>&#39;jun 11th, 2023&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;originalName&#39;</span>: <span style=color:#e6db74>&#39;Jun 11th, 2023&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28504</span>},
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;left&#39;</span>: {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>29219</span>},
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#39;format&#39;</span>: <span style=color:#e6db74>&#39;markdown&#39;</span>}],
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>29113</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;pathRefs&#39;</span>: [{<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28</span>},
</span></span><span style=display:flex><span>  {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>1967</span>},
</span></span><span style=display:flex><span>  {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>5812</span>},
</span></span><span style=display:flex><span>  {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>27790</span>},
</span></span><span style=display:flex><span>  {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>27795</span>},
</span></span><span style=display:flex><span>  {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28383</span>},
</span></span><span style=display:flex><span>  {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28504</span>},
</span></span><span style=display:flex><span>  {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28556</span>},
</span></span><span style=display:flex><span>  {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28906</span>},
</span></span><span style=display:flex><span>  {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28907</span>}],
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;propertiesTextValues&#39;</span>: {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#e6db74>&#39;648728d8-5958-4df6-95d4-b81de6665974&#39;</span>},
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;uuid&#39;</span>: <span style=color:#e6db74>&#39;648728d8-5958-4df6-95d4-b81de6665974&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;content&#39;</span>: <span style=color:#e6db74>&#39;ok cool, let me just focus on markdown and python</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>id:: 648728d8-5958-4df6-95d4-b81de6665974&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;page&#39;</span>: {<span style=color:#e6db74>&#39;journalDay&#39;</span>: <span style=color:#ae81ff>20230611</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;name&#39;</span>: <span style=color:#e6db74>&#39;jun 11th, 2023&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;originalName&#39;</span>: <span style=color:#e6db74>&#39;Jun 11th, 2023&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28504</span>},
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;left&#39;</span>: {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>29215</span>},
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;format&#39;</span>: <span style=color:#e6db74>&#39;markdown&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;refs&#39;</span>: [{<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>29214</span>}]}
</span></span></code></pre></div><p>15:12 hmm strangely it does not have its own level and its children start from level 1, so maybe this is meant to be incremental sort of.
15:26 ok added some kind of offset then</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>build_markdown_from_page_blocks</span>(blocks, level_offset<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>):
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;DEBUG&#34;</span>, [x[<span style=color:#e6db74>&#34;level&#34;</span>] <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> blocks])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    stuff <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> block <span style=color:#f92672>in</span> blocks:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Replace embed</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>match</span> <span style=color:#f92672>:=</span> re<span style=color:#f92672>.</span><span style=color:#66d9ef>match</span>(
</span></span><span style=display:flex><span>            <span style=color:#e6db74>r</span><span style=color:#e6db74>&#34;^{{embed \(\(([a-zA-Z0-9-]+)\)\)}}$&#34;</span>,
</span></span><span style=display:flex><span>            block[<span style=color:#e6db74>&#34;content&#34;</span>]
</span></span><span style=display:flex><span>        ):
</span></span><span style=display:flex><span>            block_uuid <span style=color:#f92672>=</span> <span style=color:#66d9ef>match</span><span style=color:#f92672>.</span>groups()[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;yes&#34;</span>, block_uuid)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            response <span style=color:#f92672>=</span> get_block(block_uuid)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>assert</span> response<span style=color:#f92672>.</span>status_code <span style=color:#f92672>==</span> <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            new_block <span style=color:#f92672>=</span> response<span style=color:#f92672>.</span>json()
</span></span><span style=display:flex><span>            new_block[<span style=color:#e6db74>&#34;level&#34;</span>] <span style=color:#f92672>=</span> block[<span style=color:#e6db74>&#34;level&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            stuff<span style=color:#f92672>.</span>append({<span style=color:#e6db74>&#34;level&#34;</span>: new_block[<span style=color:#e6db74>&#34;level&#34;</span>], <span style=color:#e6db74>&#34;content&#34;</span>: new_block[<span style=color:#e6db74>&#34;content&#34;</span>]})
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> new_block[<span style=color:#e6db74>&#34;children&#34;</span>]:
</span></span><span style=display:flex><span>                stuff<span style=color:#f92672>.</span>extend(
</span></span><span style=display:flex><span>                    build_markdown_from_page_blocks(
</span></span><span style=display:flex><span>                        new_block[<span style=color:#e6db74>&#34;children&#34;</span>],
</span></span><span style=display:flex><span>                        level_offset<span style=color:#f92672>=</span>(level_offset <span style=color:#f92672>+</span> new_block[<span style=color:#e6db74>&#34;level&#34;</span>])
</span></span><span style=display:flex><span>                    ))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            stuff<span style=color:#f92672>.</span>append(
</span></span><span style=display:flex><span>                {<span style=color:#e6db74>&#34;level&#34;</span>: block[<span style=color:#e6db74>&#34;level&#34;</span>] <span style=color:#f92672>+</span> level_offset,
</span></span><span style=display:flex><span>                 <span style=color:#e6db74>&#34;content&#34;</span>: block[<span style=color:#e6db74>&#34;content&#34;</span>]})
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> block[<span style=color:#e6db74>&#34;children&#34;</span>]:
</span></span><span style=display:flex><span>                stuff<span style=color:#f92672>.</span>extend(
</span></span><span style=display:flex><span>                    build_markdown_from_page_blocks(
</span></span><span style=display:flex><span>                        block[<span style=color:#e6db74>&#34;children&#34;</span>], level_offset<span style=color:#f92672>=</span>level_offset)
</span></span><span style=display:flex><span>                )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> stuff
</span></span></code></pre></div><h3 id=and-the-markdown-output>And the markdown output<a hidden class=anchor aria-hidden=true href=#and-the-markdown-output>#</a></h3><p>15:26 ok then now , to generate the markdown,
id:: 64877179-6d5e-4a1a-88ef-7826edf78ee5
Did this in a super simple way,</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>build_markdown</span>(page_name, target_loc):
</span></span><span style=display:flex><span>    response <span style=color:#f92672>=</span> get_page(page_name)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> response<span style=color:#f92672>.</span>status_code <span style=color:#f92672>==</span> <span style=color:#ae81ff>200</span> <span style=color:#f92672>and</span> response<span style=color:#f92672>.</span>json()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    response <span style=color:#f92672>=</span> get_page_blocks_tree(page_name)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> response<span style=color:#f92672>.</span>status_code <span style=color:#f92672>==</span> <span style=color:#ae81ff>200</span> <span style=color:#f92672>and</span> response<span style=color:#f92672>.</span>json()
</span></span><span style=display:flex><span>    blocks <span style=color:#f92672>=</span> response<span style=color:#f92672>.</span>json()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    blog_date <span style=color:#f92672>=</span> blocks[<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#34;properties&#34;</span>][<span style=color:#e6db74>&#34;blogDate&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    stuff <span style=color:#f92672>=</span> build_markdown_from_page_blocks(blocks)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    page_title <span style=color:#f92672>=</span> page_name<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;/&#34;</span>)[<span style=color:#ae81ff>1</span>]  <span style=color:#75715e># </span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>match</span> <span style=color:#f92672>:=</span> re<span style=color:#f92672>.</span><span style=color:#66d9ef>match</span>(<span style=color:#e6db74>r</span><span style=color:#e6db74>&#34;(\d</span><span style=color:#e6db74>{4}</span><span style=color:#e6db74>-\d</span><span style=color:#e6db74>{2}</span><span style=color:#e6db74>-\d</span><span style=color:#e6db74>{2}</span><span style=color:#e6db74>)-(.*)&#34;</span>, page_title):
</span></span><span style=display:flex><span>        date_from_title, page_title <span style=color:#f92672>=</span> <span style=color:#66d9ef>match</span><span style=color:#f92672>.</span>groups()
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;page_title&#34;</span>, page_title)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    page_title <span style=color:#f92672>=</span> page_title<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;-&#34;</span>, <span style=color:#e6db74>&#34; &#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;page_title&#34;</span>, page_title)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    text <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;---&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;date: </span><span style=color:#e6db74>{</span>date_from_title<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;title: </span><span style=color:#e6db74>{</span>page_title<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;---&#34;</span>,
</span></span><span style=display:flex><span>    ] <span style=color:#f92672>+</span> [x[<span style=color:#e6db74>&#34;content&#34;</span>] <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> stuff]
</span></span><span style=display:flex><span>    path <span style=color:#f92672>=</span> Path(target_loc)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> path<span style=color:#f92672>.</span>parent<span style=color:#f92672>.</span>is_dir()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    path<span style=color:#f92672>.</span>write_text(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>.</span>join(text))
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span></code></pre></div><p>15:50 ok lets try this,</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>target_dir <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;content/post/&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2023-06-12-spinoza-vs-descartes.md</span>
</span></span><span style=display:flex><span>page <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;blogpost/2023-06-11-semantic-code-search-first-stab&#34;</span>
</span></span><span style=display:flex><span>filename <span style=color:#f92672>=</span> page<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;/&#34;</span>)[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.md&#34;</span>
</span></span><span style=display:flex><span>target_loc <span style=color:#f92672>=</span> str(Path(target_dir) <span style=color:#f92672>/</span> filename)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;target_loc&#34;</span>, target_loc)
</span></span><span style=display:flex><span><span style=color:#75715e># &#39;content/post/2023-06-11-semantic-code-search-first-stab.md&#39;</span>
</span></span><span style=display:flex><span>lu<span style=color:#f92672>.</span>build_markdown(page, target_loc)
</span></span></code></pre></div><p>So per above, the first page built ended up being <a href=/post/2023-06-11-semantic-code-search-first-stab/>this page</a>
And the second page was actually <a href=/post/2023-06-12-logseq-publish-hugo-with-python/>this one</a></p><h2 id=some-tips>Some tips<a hidden class=anchor aria-hidden=true href=#some-tips>#</a></h2><h3 id=no-hyphens-in-your-api-token>no hyphens in your API token<a hidden class=anchor aria-hidden=true href=#no-hyphens-in-your-api-token>#</a></h3><p>Oddly enough I was getting</p><pre tabindex=0><code>Out[12]: {&#39;statusCode&#39;: 401, &#39;error&#39;: &#39;Unauthorized&#39;, &#39;message&#39;: &#39;Access Denied!&#39;}
</code></pre><p>and then switched to a token without hyphens and it was fine.</p><h3 id=the-right-rest-endpoint>The right REST endpoint<a hidden class=anchor aria-hidden=true href=#the-right-rest-endpoint>#</a></h3><p>Initially I was getting a <code>404</code> <code>'Route POST:/ not found'</code> when hitting</p><pre tabindex=0><code>url = &#34;http://127.0.0.1:12315&#34;
</code></pre><p>as opposed to</p><pre tabindex=0><code>url = &#34;http://127.0.0.1:12315/api&#34;
</code></pre><h3 id=getpage-returned-no-children>getPage returned no children<a hidden class=anchor aria-hidden=true href=#getpage-returned-no-children>#</a></h3><p>Oddly enough, hitting <a href=https://plugins-doc.logseq.com/logseq/Editor/getPage>https://plugins-doc.logseq.com/logseq/Editor/getPage</a> on a valid page, even with setting <code>includeChildren</code> to <code>true</code>, I was getting a <code>200</code> but an empty response payload.
However, I found using <a href=https://plugins-doc.logseq.com/logseq/Editor/getPageBlocksTree>https://plugins-doc.logseq.com/logseq/Editor/getPageBlocksTree</a> gave me all the child blocks for a page.</p><p>Maybe that is the intended behavior, but I&rsquo;m not sure.</p><h3 id=retrieving-a-page-with-a-literal-slash-worked-but-not-with-the-2f>Retrieving a page with a literal slash worked but not with the &ldquo;%2F&rdquo;<a hidden class=anchor aria-hidden=true href=#retrieving-a-page-with-a-literal-slash-worked-but-not-with-the-2f>#</a></h3><p>12:52 let me try getting a page too,
id:: 64874d2d-6999-48bb-b19a-a6cba44c4f96</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_page</span>(name, include_children<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>):
</span></span><span style=display:flex><span>    token <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#34;LOGSEQ_TOKEN&#34;</span>)
</span></span><span style=display:flex><span>    url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;http://127.0.0.1:12315/api&#34;</span>
</span></span><span style=display:flex><span>    headers <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;Content-Type&#34;</span>: <span style=color:#e6db74>&#34;application/json&#34;</span>,
</span></span><span style=display:flex><span>              <span style=color:#e6db74>&#34;Authorization&#34;</span>: <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Bearer </span><span style=color:#e6db74>{</span>token<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>}
</span></span><span style=display:flex><span>    payload <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;method&#34;</span>: <span style=color:#e6db74>&#34;logseq.Editor.getPage&#34;</span>,  
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;args&#34;</span>: [name, 
</span></span><span style=display:flex><span>               {<span style=color:#e6db74>&#34;includeChildren&#34;</span>: include_children}]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    response <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(url, json<span style=color:#f92672>=</span>payload, headers<span style=color:#f92672>=</span>headers)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> response
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>response <span style=color:#f92672>=</span> get_page(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;blogpost</span><span style=color:#e6db74>%2F</span><span style=color:#e6db74>2023-06-11-semantic-code-search-first-stab&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>response<span style=color:#f92672>.</span>status_code
</span></span></code></pre></div><p>hmm weird saying it got a page but response.json() is null.
Ok, trying by id now, and below, this is working now,</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>response <span style=color:#f92672>=</span> get_page(<span style=color:#ae81ff>28504</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>12</span>]: response<span style=color:#f92672>.</span>json()
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>12</span>]: 
</span></span><span style=display:flex><span>{<span style=color:#e6db74>&#39;updatedAt&#39;</span>: <span style=color:#ae81ff>1686580509936</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;journalDay&#39;</span>: <span style=color:#ae81ff>20230611</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;createdAt&#39;</span>: <span style=color:#ae81ff>1686463272305</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28504</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;name&#39;</span>: <span style=color:#e6db74>&#39;jun 11th, 2023&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;uuid&#39;</span>: <span style=color:#e6db74>&#39;648728d8-8c86-4afd-8bb2-4cd519ec4c76&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;journal?&#39;</span>: <span style=color:#66d9ef>True</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;originalName&#39;</span>: <span style=color:#e6db74>&#39;Jun 11th, 2023&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;file&#39;</span>: {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28527</span>},
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;format&#39;</span>: <span style=color:#e6db74>&#39;markdown&#39;</span>}
</span></span></code></pre></div><p>ok but then how to get a page by name then?
13:06 ok interesting, so I tried again but this time instead of the &ldquo;%2F&rdquo; where the &ldquo;/&rdquo; forward slash is, using the literal, and now worked !
collapsed:: true</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>13</span>]: response <span style=color:#f92672>=</span> get_page(
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>:     <span style=color:#e6db74>&#34;blogpost/2023-06-11-semantic-code-search-first-stab&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>: )
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>: response<span style=color:#f92672>.</span>status_code
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>13</span>]: <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>In [<span style=color:#ae81ff>14</span>]: response<span style=color:#f92672>.</span>json()
</span></span><span style=display:flex><span>Out[<span style=color:#ae81ff>14</span>]: 
</span></span><span style=display:flex><span>{<span style=color:#e6db74>&#39;properties&#39;</span>: {<span style=color:#e6db74>&#39;public&#39;</span>: <span style=color:#66d9ef>True</span>},
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;updatedAt&#39;</span>: <span style=color:#ae81ff>1686526563885</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;createdAt&#39;</span>: <span style=color:#ae81ff>1686526225155</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28906</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;propertiesTextValues&#39;</span>: {<span style=color:#e6db74>&#39;public&#39;</span>: <span style=color:#e6db74>&#39;true&#39;</span>},
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;name&#39;</span>: <span style=color:#e6db74>&#39;blogpost/2023-06-11-semantic-code-search-first-stab&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;uuid&#39;</span>: <span style=color:#e6db74>&#39;648728d8-d545-42ce-b487-986d6cac3d55&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;journal?&#39;</span>: <span style=color:#66d9ef>False</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;originalName&#39;</span>: <span style=color:#e6db74>&#39;blogpost/2023-06-11-semantic-code-search-first-stab&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;file&#39;</span>: {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28909</span>},
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;namespace&#39;</span>: {<span style=color:#e6db74>&#39;id&#39;</span>: <span style=color:#ae81ff>28907</span>},
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;format&#39;</span>: <span style=color:#e6db74>&#39;markdown&#39;</span>}
</span></span></code></pre></div><p>ok</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://michal.piekarczyk.xyz/post/2023-06-13-semantic-code-search-part-2/><span class=title>¬´ Prev</span><br><span>semantic code search part 2</span>
</a><a class=next href=https://michal.piekarczyk.xyz/post/2023-06-11-semantic-code-search-first-stab/><span class=title>Next ¬ª</span><br><span>semantic code search first stab</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://michal.piekarczyk.xyz/>michal.piekarczyk.xyz</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>