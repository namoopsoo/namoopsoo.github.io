<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Minimizing Golang struct types while observing tyep safety | michal.piekarczyk.xyz</title>
<meta name=keywords content><meta name=description content="Asked chat gpt the following conundrum, if I&rsquo;m using Go struct types to model a data type, matching a table in my postgresql database say,
type Merchant struct { id int, created_at time.Time, name string, phone string, email string, } I have the following question, does it make sense that I ended up creating different types also for the HTTP request to create this merchant,
type CreateMerchantRequest struct { name string, phone string, email string, } since the id and created_at timestamps are populated automatically, and also another to update the merchant,"><meta name=author content="Michal Piekarczyk"><link rel=canonical href=https://michal.piekarczyk.xyz/post/2024-02-04-golang-http-struct-types-proliferation/><link crossorigin=anonymous href=/assets/css/stylesheet.dd867d536fb6202811c1ee15fa181ef8945826662b49d3016ac91365a2621d58.css integrity="sha256-3YZ9U2+2ICgRwe4V+hge+JRYJmYrSdMBaskTZaJiHVg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://michal.piekarczyk.xyz/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://michal.piekarczyk.xyz/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://michal.piekarczyk.xyz/favicon-32x32.png><link rel=apple-touch-icon href=https://michal.piekarczyk.xyz/apple-touch-icon.png><link rel=mask-icon href=https://michal.piekarczyk.xyz/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-74MK08REDT"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-74MK08REDT",{anonymize_ip:!1})}</script><meta property="og:title" content="Minimizing Golang struct types while observing tyep safety"><meta property="og:description" content="Asked chat gpt the following conundrum, if I&rsquo;m using Go struct types to model a data type, matching a table in my postgresql database say,
type Merchant struct { id int, created_at time.Time, name string, phone string, email string, } I have the following question, does it make sense that I ended up creating different types also for the HTTP request to create this merchant,
type CreateMerchantRequest struct { name string, phone string, email string, } since the id and created_at timestamps are populated automatically, and also another to update the merchant,"><meta property="og:type" content="article"><meta property="og:url" content="https://michal.piekarczyk.xyz/post/2024-02-04-golang-http-struct-types-proliferation/"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-02-04T00:00:00+00:00"><meta property="article:modified_time" content="2024-02-04T11:19:23-05:00"><meta property="og:site_name" content="michal.piekarczyk.xyz"><meta name=twitter:card content="summary"><meta name=twitter:title content="Minimizing Golang struct types while observing tyep safety"><meta name=twitter:description content="Asked chat gpt the following conundrum, if I&rsquo;m using Go struct types to model a data type, matching a table in my postgresql database say,
type Merchant struct { id int, created_at time.Time, name string, phone string, email string, } I have the following question, does it make sense that I ended up creating different types also for the HTTP request to create this merchant,
type CreateMerchantRequest struct { name string, phone string, email string, } since the id and created_at timestamps are populated automatically, and also another to update the merchant,"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://michal.piekarczyk.xyz/post/"},{"@type":"ListItem","position":2,"name":"Minimizing Golang struct types while observing tyep safety","item":"https://michal.piekarczyk.xyz/post/2024-02-04-golang-http-struct-types-proliferation/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Minimizing Golang struct types while observing tyep safety","name":"Minimizing Golang struct types while observing tyep safety","description":"Asked chat gpt the following conundrum, if I\u0026rsquo;m using Go struct types to model a data type, matching a table in my postgresql database say,\ntype Merchant struct { id int, created_at time.Time, name string, phone string, email string, } I have the following question, does it make sense that I ended up creating different types also for the HTTP request to create this merchant,\ntype CreateMerchantRequest struct { name string, phone string, email string, } since the id and created_at timestamps are populated automatically, and also another to update the merchant,","keywords":[],"articleBody":"Asked chat gpt the following conundrum, if I’m using Go struct types to model a data type, matching a table in my postgresql database say,\ntype Merchant struct { id int, created_at time.Time, name string, phone string, email string, } I have the following question, does it make sense that I ended up creating different types also for the HTTP request to create this merchant,\ntype CreateMerchantRequest struct { name string, phone string, email string, } since the id and created_at timestamps are populated automatically, and also another to update the merchant,\ntype UpdateMerchantRequest struct { id int, name string, phone string, email string, } since my request does need the id and any fields that need updating,\nyet now is the question, that what if an update only applies to one field, does that mean now we need yet another kind of type?\ntype UpdatePhoneMerchantRequest struct { id int, phone string, } ? Is this getting out of hand? Am I on the right track? What is a more “dont repeat yourself” pattern here ?\nGot a cool response, learned about omitempty ! Your approach to creating distinct Go struct types for different operations (like creating and updating a merchant) is quite common and reasonable in many application designs. It helps to clearly define what data is required for each operation, enhancing code readability and safety. However, as you’ve noticed, it can lead to a proliferation of types, especially for operations that only update a part of the model. Here are some strategies to manage this complexity:\nAnd here is the idea on using pointers for optional fields, So the below, code snippet haha also has the fields title-cased because I forgot to do that. And yea I will try this out but I think it means a partially filled json request can still be unmarshalled into the same dont-repeat-yourself type, UpdateMerchantRequest.\nCopy code type UpdateMerchantRequest struct { ID *int `json:\"id\"` Name *string `json:\"name,omitempty\"` Phone *string `json:\"phone,omitempty\"` Email *string `json:\"email,omitempty\"` } In this model, a field set to nil means it was not included in the update request and should not be changed. This approach minimizes the number of structs you need and allows for flexible updates.\n","wordCount":"368","inLanguage":"en","datePublished":"2024-02-04T00:00:00Z","dateModified":"2024-02-04T11:19:23-05:00","author":{"@type":"Person","name":"Michal Piekarczyk"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://michal.piekarczyk.xyz/post/2024-02-04-golang-http-struct-types-proliferation/"},"publisher":{"@type":"Organization","name":"michal.piekarczyk.xyz","logo":{"@type":"ImageObject","url":"https://michal.piekarczyk.xyz/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://michal.piekarczyk.xyz/ accesskey=h title="michal.piekarczyk.xyz (Alt + H)">michal.piekarczyk.xyz</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://michal.piekarczyk.xyz/post/ title=posts><span>posts</span></a></li><li><a href=https://michal.piekarczyk.xyz/project/ title=projects><span>projects</span></a></li><li><a href=https://michal.piekarczyk.xyz/handy/ title=handy><span>handy</span></a></li><li><a href=https://michal.piekarczyk.xyz/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://michal.piekarczyk.xyz/about/ title=about><span>about</span></a></li><li><a href=https://world.hey.com/michal.piekarczyk title=frivolity><span>frivolity</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://michal.piekarczyk.xyz/>Home</a>&nbsp;»&nbsp;<a href=https://michal.piekarczyk.xyz/post/>Posts</a></div><h1 class=post-title>Minimizing Golang struct types while observing tyep safety</h1><div class=post-meta>&lt;span title='2024-02-04 00:00:00 +0000 UTC'>February 4, 2024&lt;/span>&amp;nbsp;·&amp;nbsp;2 min&amp;nbsp;·&amp;nbsp;368 words&amp;nbsp;·&amp;nbsp;Michal Piekarczyk</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#asked-chat-gpt-the-following-conundrum>Asked chat gpt the following conundrum,</a></li><li><a href=#got-a-cool-response-learned-about-omitempty->Got a cool response, learned about <code>omitempty</code> !</a><ul><li><a href=#and-here-is-the-idea-on-using-pointers-for-optional-fields>And here is the idea on using pointers for optional fields,</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=asked-chat-gpt-the-following-conundrum>Asked chat gpt the following conundrum,<a hidden class=anchor aria-hidden=true href=#asked-chat-gpt-the-following-conundrum>#</a></h2><p>if I&rsquo;m using Go struct types to model a data type, matching a table in my postgresql database say,</p><pre tabindex=0><code>type Merchant struct {
    id int,
    created_at time.Time,
    name string,
    phone string,
    email string,
}
</code></pre><p>I have the following question, does it make sense that I ended up creating different types also for the HTTP request to create this merchant,</p><pre tabindex=0><code>type CreateMerchantRequest struct {
    name string,
    phone string,
    email string,
}
</code></pre><p>since the <code>id</code> and <code>created_at</code> timestamps are populated automatically,
and also another to update the merchant,</p><pre tabindex=0><code>type UpdateMerchantRequest struct {
    id int,
    name string,
    phone string,
    email string,
}
</code></pre><p>since my request does need the <code>id</code> and any fields that need updating,</p><p>yet now is the question, that what if an update only applies to one field, does that mean now we need yet another kind of type?</p><pre tabindex=0><code>type UpdatePhoneMerchantRequest struct {
    id int,
    phone string,
}
</code></pre><p>?
Is this getting out of hand? Am I on the right track? What is a more &ldquo;dont repeat yourself&rdquo; pattern here ?</p><h2 id=got-a-cool-response-learned-about-omitempty->Got a cool response, learned about <code>omitempty</code> !<a hidden class=anchor aria-hidden=true href=#got-a-cool-response-learned-about-omitempty->#</a></h2><blockquote><p>Your approach to creating distinct Go struct types for different operations (like creating and updating a merchant) is quite common and reasonable in many application designs. It helps to clearly define what data is required for each operation, enhancing code readability and safety. However, as you&rsquo;ve noticed, it can lead to a proliferation of types, especially for operations that only update a part of the model. Here are some strategies to manage this complexity:</p></blockquote><h3 id=and-here-is-the-idea-on-using-pointers-for-optional-fields>And here is the idea on using pointers for optional fields,<a hidden class=anchor aria-hidden=true href=#and-here-is-the-idea-on-using-pointers-for-optional-fields>#</a></h3><p>So the below, code snippet haha also has the fields title-cased because I forgot to do that. And yea I will try this out but I think it means a partially filled json request can still be unmarshalled into the same dont-repeat-yourself type, <code>UpdateMerchantRequest</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>Copy</span> <span style=color:#a6e22e>code</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>UpdateMerchantRequest</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ID</span>    <span style=color:#f92672>*</span><span style=color:#66d9ef>int</span>    <span style=color:#e6db74>`json:&#34;id&#34;`</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Name</span>  <span style=color:#f92672>*</span><span style=color:#66d9ef>string</span> <span style=color:#e6db74>`json:&#34;name,omitempty&#34;`</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Phone</span> <span style=color:#f92672>*</span><span style=color:#66d9ef>string</span> <span style=color:#e6db74>`json:&#34;phone,omitempty&#34;`</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Email</span> <span style=color:#f92672>*</span><span style=color:#66d9ef>string</span> <span style=color:#e6db74>`json:&#34;email,omitempty&#34;`</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><blockquote><p>In this model, a field set to nil means it was not included in the update request and should not be changed. This approach minimizes the number of structs you need and allows for flexible updates.</p></blockquote></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://michal.piekarczyk.xyz/post/2023-12-23-learn-golang-through-chat-gpt-conversation/><span class=title>Next »</span><br><span>Some of my notes through learning Golang by conversing with ChatGPT</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://michal.piekarczyk.xyz/>michal.piekarczyk.xyz</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>